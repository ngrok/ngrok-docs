---
title: Secure your endpoints with Microsoft Entra ID SSO (SAML)
sidebarTitle: Microsoft Entra ID (SAML)
description: Secure access to your ngrok endpoints with Microsoft Entra ID single sign-on (SSO) using SAML.
---

import Disclaimer from "/snippets/integrations/_endpoint-sso-disclaimer.mdx";

<Disclaimer />

<Tip>
**TL;DR**

To have ngrok enforce single sign-on (SSO) using SAML with Microsoft Entra ID:

1. [Create an ngrok Edge](#1-create-an-ngrok-edge)
2. [Create a Microsoft Entra ID application](#2-create-a-microsoft-entra-id-application)
3. [Update the ngrok Edge with the IdP metadata](#3-update-the-ngrok-edge-with-the-idp-metadata)
4. [Test your integration](#4-test-the-integration)
5. [Bonus: configure ngrok to enforce authorization based on Azure groups](#bonus-configure-ngrok-to-enforce-authorization-based-on-azure-groups)
</Tip>

This guide walks you through configuring Microsoft Entra ID as an Identity Provider for your ngrok Edge using single sign-on (SSO).
By integrating Microsoft Entra ID with ngrok, you can:

- Restrict access to ngrok tunnels to only users who authenticated via Microsoft Entra ID
- Configure Microsoft Entra ID and ngrok to enforce user and group authorization
- Use Microsoft Entra ID's dashboard to facilitate access to ngrok applications

## What you'll need

- An ngrok Enterprise account with an authtoken or admin access to configure edges with SAML.
- A Microsoft Azure account with access to a Microsoft Entra ID tenant.

## 1. Create an ngrok Edge 

- Go to the [ngrok dashboard](https://dashboard.ngrok.com).
- Click **Universal Gateway > Edges**.
- Create an Edge:
  - Click **New Edge**.
  - Click **HTTPS Edge**.
  - Click the **pencil icon** next to "no description".
  Enter `Edge With Microsoft Entra ID SSO` as the Edge name and click **Save**.
- Configure the SAML module for this Edge:
  - On the Routes section, click **SAML**.
  - Click **Begin setup**.
  - In the Identity Provider section, copy the following XML as a placeholder into the input box:

    ```xml
    <EntityDescriptor xmlns="urn:oasis:names:tc:SAML:2.0:metadata"></EntityDescriptor>
    ```

  - Click **Save**.
- Note that ngrok has now generated values for the fields in the Service Provider section.
You will need to configure Microsoft Entra ID with these values later.

## 2. Create a Microsoft Entra ID application 

- Go to your Microsoft Entra ID tenant in Azure.
- Create an enterprise application:
  - Starting from the sidebar, in the Manage section, click **Enterprise Applications > New application**.
  - Give your application a name (for example, `www` for a website client).
  Click **Create**.
- To assign users/groups for this application, in the Getting Started section, click **1. Assign users and groups > Add user/group**.
- Set up single sign-on with SAML:
  - In the Getting Started section, click the box titled **2. Set up single sign on > SAML**.
  - Configure SAML.
  In the Basic SAML Configuration box, click **Edit**.
  - Add Identifier (Entity ID) and Reply URL (Assertion Consumer Service URL) values using the previously generated ngrok Entity ID and ACS URL.
  - Click **Save**.
  - Download the Metadata XML.
  In the SAML Certificates box > Token signing certificate section, click **Download** for the Federation Metadata XML.

## 3. Update the ngrok Edge with the IdP metadata 

- Back in the ngrok dashboard for your Edge's SAML configuration, upload the XML file generated by Microsoft Entra ID.
- Click **Save**.

## 4. Test the integration 
<Note>
This step assumes you have an app running locally (for example, on `localhost:3000`) with the ngrok client installed.
</Note>

- Launch a tunnel connected to your configured Edge.
- On your Edge's page, in the Routes section, click **Start a tunnel**.
- Copy the tunnel command.
- Launch a terminal and paste the command, replacing `http://localhost:80` with your local web app address (for example, `http://localhost:3000`).
- Press **Enter** to launch the tunnel.
- Confirm that the tunnel is connected to your edge:
  - Return to the ngrok dashboard.
  - Close the **Start a tunnel** and the **Tunnel group** drawers.
  - Refresh the Edge page.
  - In the Routes section > Traffic section you will see the message _You have 1 tunnel online. Start additional tunnels to begin load balancing_.
- Copy the ngrok URL on the Endpoints section.
- Access your Edge application:
  - In your browser, launch an incognito window.
  - Access your ngrok tunnel via your copied URL.
  - You should be prompted to log in with your Microsoft credentials.
  - After logging in, you should be able to see the application.

## Bonus: Configure ngrok to enforce authorization based on Azure groups 

- In Azure, configure the SAML response to include group claims.
In the Attributes & Claims box, click **Edit**.
- Click **Add a group claim > Advanced options > Customize the name of the group claim**.
- Set the name of the group claim to `groups`.
This specific value is required for ngrok.
- Click **Save**.
- Go to your group page and copy the object ID (Microsoft Entra ID returns group object IDs in the group claim).
- Configure ngrok to enforce group authorization.
In ngrok on your Edge's page, in the Authorization section, update the groups input with your Azure group object ID (NOT group name) values.
- Access your Edge application:
  - In your browser, launch an incognito window.
  - Access your ngrok tunnel via your copied URL.
  - You should be prompted to log in with your Microsoft credentials.
  - Only users assigned to the authorized groups will have access to the application.
