---
title: Instagram Webhooks
sidebarTitle: Instagram
description: Develop and test Instagram webhooks from localhost.
---

import InspectingRequests from "/snippets/integrations/_inspecting-requests.mdx";
import ReplayingRequests from "/snippets/integrations/_replaying-requests.mdx";

This guide walks you through using ngrok to receive Instagram webhooks on your localhost app.

By integrating ngrok with Instagram, you can:

- Develop and test Instagram webhooks locally without deploying to a public environment or setting up HTTPS.
- Inspect and troubleshoot requests from Instagram in real time via the inspection UI and API.
- Modify and replay Instagram webhook requests with a single click instead of reproducing events manually in your Instagram account.
- Secure your app with Instagram webhook validation provided by ngrok.
  Invalid requests are blocked by ngrok before reaching your app.

## What you'll need

- An [ngrok account](https://ngrok.com/signup) and your [authtoken](https://dashboard.ngrok.com/get-started/your-authtoken).
- The [ngrok agent](https://ngrok.com/download) installed.
- [Node.js](https://nodejs.org/) installed (for the sample app, or use your own app).
- A Facebook page and a Facebook app linked to that page; connect your Instagram account to the page.

<Note>
  This integration requires an ngrok Pro or Enterprise license because Facebook validates your ngrok domain.
</Note>

## 1. Start your app

For this tutorial, you can use the [sample Node.js app on GitHub](https://github.com/ngrok/ngrok-webhook-nodejs-sample).

To install the sample, run the following in a terminal:

```bash
git clone https://github.com/ngrok/ngrok-webhook-nodejs-sample.git
cd ngrok-webhook-nodejs-sample
npm install
```

Then start the app:

```bash
npm run startFacebook
```

The app runs on port 3000 by default.

You can confirm it's running by visiting `http://localhost:3000`.
The app logs request headers and body in the terminal and shows a message in the browser.

## 2. Expose your app with ngrok

Once your app is running locally, you're ready to put it online securely using ngrok.

- Copy [your ngrok authtoken](https://dashboard.ngrok.com/get-started/your-authtoken) from the dashboard.

<Tip>
  The ngrok agent uses your authtoken to authenticate when you start a tunnel.
</Tip>

- In the dashboard, expand **Universal Gateway** and click **Domains**.

<Tip>
  If you don't have an ngrok Pro or Enterprise license, sign up by clicking **Update Subscription** and following the procedure.
</Tip>

- On the **Domains** page, click **+ Create Domain** or **+ New Domain**.
- In the **Domain** pane, enter a domain (for example, `myexample.ngrok.app`) and click **Continue**.

<Tip>
  Make sure your domain is available.
</Tip>

- Close the **Start a Tunnel** and **Domain** panes.
- Start ngrok with your domain:

  ```bash
  ngrok http 3000 --url myexample.ngrok.app
  ```

- Copy the URL ngrok displays.
  Your app is now exposed at that URL for use with Instagram.

## 3. Configure Instagram to send webhooks

Instagram can send webhook requests to your app when events occur in your account.
Connect your Facebook page to Instagram (in Facebook, go to your page, **Meta Business Suite**, **Inbox**, **Instagram Comments**, **Connect account**), then register the webhook:

- Sign in to [Meta for Developers](https://developers.facebook.com/).
- Click **My Apps** and your app.
- Click **Add Product** and **Set up** for **Webhooks**.
- On the **Webhooks** page, select **Instagram** and click **Subscribe to this object**.
- In the **Edit User subscription** popup, enter your ngrok URL with `/webhooks` at the end in **Callback URL** (for example, `https://myexample.ngrok.app/webhooks`).
- Enter `12345` in **Verify token**, set **Include values** to **Yes**, and click **Verify and save**.
- Confirm your localhost app receives the validation request and logs `WEBHOOK_VERIFIED` in the terminal.
- With **Instagram** selected, click **Subscribe** for the **comments** field.

<Tip>
  You can subscribe to more fields under **Instagram** and other objects; use the same URL.
</Tip>

- Click **Test** for **comments**, click **Send to My Server**, and confirm your localhost app receives the test request.
- Set **App Mode** to **Live** at the top of your app page.

### Run webhooks with Instagram and ngrok

Instagram sends different request body contents depending on the object and field.
With **comments** you can test by commenting on a post:

- Open your Instagram account, open a story, enter a comment, and post it.

Confirm your localhost app receives the message and logs both headers and body in the terminal.

<InspectingRequests />

<ReplayingRequests />

## Secure webhook requests

ngrok can verify that incoming requests are from your Instagram webhook so only that traffic reaches your app.

<Note>
  Webhook verification is limited to 500 validations per month on free accounts.
  If you need more, you can upgrade to Hobbyist or Pay-as-you-go.
  See [TPU Pricing](/pricing-limits/traffic-policy-unit-pricing/) for details.
</Note>

To add verification:

- In [Meta for Developers](https://developers.facebook.com/), go to **My Apps**, **Settings**, **Basic**.
- Click **Show** next to **App secret** and copy the value.
- Create a Traffic Policy file named `instagram_policy.yml`.
  Replace `{your app secret}` with the value you copied:

  ```yaml
  on_http_request:
    - name: "Instagram Webhooks"
      actions:
        - type: "webhook-validation"
          config:
            provider: facebook_graph_api
            secret: "{your app secret}"
  ```

- Restart ngrok with the policy file:

  ```bash
  ngrok http 3000 --traffic-policy-file instagram_policy.yml
  ```

- Trigger an Instagram event (for example, comment on a post) to send a request.

Your app should receive the request and log it in the terminal.
