import { Config, ConfigChildren, ConfigField } from "/snippets/ConfigTable.jsx";

<Config>
  <ConfigField title="actions.ngrok.ai_gateway.status" type="string">
    <p>
      Overall outcome of the action: <code>"success"</code> or <code>"error"</code>.
</p>
</ConfigField>
  <ConfigField title="actions.ngrok.ai_gateway.error" type="object">
    <p>
      Error details. Only present when <code>status</code> is <code>"error"</code>.
</p>
    <ConfigChildren>
      <ConfigField title="error.code" type="string">
        <p>
          Error code (e.g., <code>"ERR_NGROK_3807"</code>).
</p>
</ConfigField>
      <ConfigField title="error.message" type="string">
        <p>Error message describing the failure.</p>
</ConfigField>
</ConfigChildren>
</ConfigField>
  <ConfigField title="actions.ngrok.ai_gateway.client" type="object">
    <p>Information about the client request.</p>
    <ConfigChildren>
      <ConfigField title="client.method" type="string">
        <p>HTTP method from the client request.</p>
</ConfigField>
      <ConfigField title="client.path" type="string">
        <p>Request path from the client.</p>
</ConfigField>
      <ConfigField title="client.request_headers" type="object">
        <p>Client request headers (API key/auth headers trimmed to avoid leaking).</p>
</ConfigField>
      <ConfigField title="client.user_agent" type="string">
        <p>User-Agent header from the client.</p>
</ConfigField>
      <ConfigField title="client.model" type="string">
        <p>Client-requested model field.</p>
</ConfigField>
      <ConfigField title="client.models" type="array of strings">
        <p>Client-requested models field.</p>
</ConfigField>
      <ConfigField title="client.api_key_hash" type="string">
        <p>Trimmed client-supplied api key to avoid leaking while still being able to correlate it with the full key if you have it.</p>
</ConfigField>
      <ConfigField title="client.rejected_models" type="array of objects">
        <p>Models the client requested but were excluded.</p>
        <ConfigChildren>
          <ConfigField title="rejected_models[i].model" type="string">
            <p>Model the client requested but was excluded.</p>
</ConfigField>
          <ConfigField title="rejected_models[i].reason" type="string">
            <p>Explanation for why it was rejected.</p>
</ConfigField>
</ConfigChildren>
</ConfigField>
</ConfigChildren>
</ConfigField>
  <ConfigField title="actions.ngrok.ai_gateway.input_ngrok_tokens" type="integer">
    <p>Input token count calculated by ngrok (used for billing).</p>
</ConfigField>
  <ConfigField title="actions.ngrok.ai_gateway.output_ngrok_tokens" type="integer">
    <p>Output token count calculated by ngrok (used for billing).</p>
</ConfigField>
  <ConfigField title="actions.ngrok.ai_gateway.gateway_latency_ms" type="integer">
    <p>Time added by gateway logic in milliseconds. Excludes time the gateway spend waiting on the upstream provider(s) to respond.</p>
</ConfigField>
  <ConfigField title="actions.ngrok.ai_gateway.model_selection" type="array of objects">
    <p>Details about the model selection process.</p>
    <ConfigChildren>
      <ConfigField title="model_selection[i].strategy" type="string">
        <p>The resolved strategy expression.</p>
</ConfigField>
      <ConfigField title="model_selection[i].error" type="string">
        <p>Error if strategy evaluation failed.</p>
</ConfigField>
      <ConfigField title="model_selection[i].candidates_returned" type="array of strings">
        <p>Models returned by the strategy expression.</p>
</ConfigField>
      <ConfigField title="model_selection[i].candidates_after_allowed_filter" type="array of strings">
        <p>List after .disabled, only_allow_configured_* filters.</p>
</ConfigField>
      <ConfigField title="model_selection[i].candidates_after_client_filter" type="array of strings">
        <p>List after filtering by client-requested models.</p>
</ConfigField>
      <ConfigField title="model_selection[i].models_to_try" type="array of strings">
        <p>Final list of models to try.</p>
</ConfigField>
</ConfigChildren>
</ConfigField>
  <ConfigField title="actions.ngrok.ai_gateway.models_tried" type="array of objects">
    <p>Models attempted in chronological order.</p>
    <ConfigChildren>
      <ConfigField title="models_tried[i].model" type="string">
        <p>Model identifier.</p>
</ConfigField>
      <ConfigField title="models_tried[i].provider" type="string">
        <p>Provider Provider identifier for the model tried.</p>
</ConfigField>
      <ConfigField title="models_tried[i].author" type="string">
        <p>Author identifier for the model tried (may be empty).</p>
</ConfigField>
      <ConfigField title="models_tried[i].api_key_selection" type="array of objects">
        <p>Details about API key selection for this model.</p>
        <ConfigChildren>
          <ConfigField title="api_key_selection[i].strategy" type="string">
            <p>Strategy used for API key selection.</p>
</ConfigField>
          <ConfigField title="api_key_selection[i].error" type="string">
            <p>Error if strategy failed.</p>
</ConfigField>
          <ConfigField title="api_key_selection[i].keys_to_try" type="array of strings">
            <p>List of trimmed keys to try.</p>
</ConfigField>
</ConfigChildren>
</ConfigField>
      <ConfigField title="models_tried[i].requests_made" type="array of objects">
        <p>List of requests made for this model.</p>
        <ConfigChildren>
          <ConfigField title="requests_made[i].status" type="string">
            <p>
              Request outcome: <code>"success"</code> or <code>"error"</code>.
</p>
</ConfigField>
          <ConfigField title="requests_made[i].error" type="string">
            <p>Error message if request failed.</p>
</ConfigField>
          <ConfigField title="requests_made[i].upstream_input_tokens" type="integer">
            <p>Input token count reported by the upstream provider.</p>
</ConfigField>
          <ConfigField title="requests_made[i].upstream_output_tokens" type="integer">
            <p>Output token count reported by the upstream provider.</p>
</ConfigField>
          <ConfigField title="requests_made[i].request" type="object">
            <p>Details of the request made by the gateway</p>
            <ConfigChildren>
              <ConfigField title="request.url" type="string">
                <p>Request URL.</p>
</ConfigField>
              <ConfigField title="request.api_key" type="string">
                <p>Partially redacted API key for safe display and correlation with the full key.</p>
</ConfigField>
</ConfigChildren>
</ConfigField>
          <ConfigField title="requests_made[i].response" type="object">
            <p>Response details.</p>
            <ConfigChildren>
              <ConfigField title="response.status_code" type="integer">
                <p>HTTP status code.</p>
</ConfigField>
              <ConfigField title="response.headers" type="object">
                <p>Response headers.</p>
</ConfigField>
              <ConfigField title="response.body_on_error" type="string">
                <p>Only populated on failure, truncated to 1KB.</p>
</ConfigField>
</ConfigChildren>
</ConfigField>
          <ConfigField title="requests_made[i].upstream_latency" type="object">
            <p>Upstream latency measurements.</p>
            <ConfigChildren>
              <ConfigField title="upstream_latency.time_to_first_byte_ms" type="integer">
                <p>Milliseconds until first byte of response received.</p>
</ConfigField>
              <ConfigField title="upstream_latency.total_ms" type="integer">
                <p>Milliseconds until request fully completed.</p>
</ConfigField>
</ConfigChildren>
</ConfigField>
</ConfigChildren>
</ConfigField>
</ConfigChildren>
</ConfigField>
  <ConfigField title="actions.ngrok.ai_gateway.success" type="object">
    <p>
      Details of the successful model. Only present when <code>status</code> is <code>"success"</code>.
</p>
    <ConfigChildren>
      <ConfigField title="success.model_index" type="integer">
        <p>
          Index into the <code>models_tried</code> array for the successful model.
</p>
</ConfigField>
      <ConfigField title="success.request_index" type="integer">
        <p>
          Index into <code>requests_made</code> array for the successful request.
</p>
</ConfigField>
      <ConfigField title="success.model" type="string">
        <p>
          Model that successfully handled the request (e.g., <code>"gpt-4"</code>).
</p>
</ConfigField>
      <ConfigField title="success.provider" type="string">
        <p>Provider identifier for the successful model.</p>
</ConfigField>
      <ConfigField title="success.author" type="string">
        <p>Author identifier for the successful model. May be empty.</p>
</ConfigField>
</ConfigChildren>
</ConfigField>
</Config>
