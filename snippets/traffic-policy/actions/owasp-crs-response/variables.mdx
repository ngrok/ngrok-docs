import {
	Config,
	ConfigChildren,
	ConfigField,
	ConfigEnum,
	ConfigEnumOption,
} from "/snippets/ConfigTable.jsx";

<Config>
	<ConfigField title="actions.ngrok.owasp_crs_response.decision" type="string">
		<p>The action taken for this response.</p>
		<ConfigEnum label="Possible values">
			<ConfigEnumOption>
				`allow` - If the response was permitted.
			</ConfigEnumOption>
			<ConfigEnumOption>`deny` - If the response was denied.</ConfigEnumOption>
		</ConfigEnum>
	</ConfigField>
	<ConfigField
		title="actions.ngrok.owasp_crs_response.anomaly_score"
		type="int"
	>
		<p>
			The total anomaly score for the response. If it equals to or exceeds the
			set threshold, it will block the response.
		</p>
	</ConfigField>
	<ConfigField
		title="actions.ngrok.owasp_crs_response.anomaly_score_threshold"
		type="int"
	>
		<p>
			The total anomaly score threshold for the response. By default, it is set
			to 4.
		</p>
	</ConfigField>
	<ConfigField
		title="actions.ngrok.owasp_crs_response.matched_rules"
		type="array of objects"
	>
		<p>
			The list of all rules matched by this response that have a non-zero score.
		</p>
		<ConfigChildren>
			<ConfigField title="matched_rules[i].id" type="int">
				<p>The ID of the rule.</p>
			</ConfigField>
			<ConfigField title="matched_rules[i].message" type="string">
				<p>The text message describing the rule.</p>
			</ConfigField>
			<ConfigField title="matched_rules[i].severity" type="string">
				<p>
					The [severity](https://coraza.io/docs/seclang/actions/#severity) of
					the matched rule.
				</p>
			</ConfigField>
			<ConfigField title="matched_rules[i].data" type="string">
				<p>Any extra data about the rule and how it matched the response.</p>
			</ConfigField>
		</ConfigChildren>
	</ConfigField>
	<ConfigField
		title="actions.ngrok.owasp_crs_response.error.code"
		type="string"
	>
		<p>
			A machine-readable code describing an error that occurred during the
			action's execution.
		</p>
	</ConfigField>
	<ConfigField
		title="actions.ngrok.owasp_crs_response.error.message"
		type="string"
	>
		<p>
			A human-readable message providing details about an error that occurred
			during the action's execution.
		</p>
	</ConfigField>
</Config>
