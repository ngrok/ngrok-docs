### Restricting Access with IP Policies

The following [Traffic Policy](/traffic-policy)
configuration demonstrates how to restrict access using the `restrict-ips`
action with [IP Policies](/api-reference/ippolicies/list).

#### Example Traffic Policy Document

<CodeGroup>
```yaml policy.yml {4-10}
on_tcp_connect:
  - actions:
      - type: restrict-ips
        config:
          enforce: true
          ip_policies:
            - ipp_1yjqdrIBwgciY2I9zH2EelgBbJF
```

```json policy.json {5-13}
{
  "on_tcp_connect": [
    {
      "actions": [
        {
          "type": "restrict-ips",
          "config": {
            "enforce": true,
            "ip_policies": ["ipp_1yjqdrIBwgciY2I9zH2EelgBbJF"]
          }
        }
      ]
    }
  ]
}
```

</CodeGroup>

This configuration will ensure that the [IP Policies](/api-reference/ippolicies/list)
specified `ipp_1yjqdrIBwgciY2I9zH2EelgBbJF` are enforced against incoming
traffic.

#### Example Request

If the request comes from an allowed IP, the response will proceed as normal. If
the request comes from a denied IP, you will receive an HTTP `403` response:

```bash
$ telnet 5.tcp.ngrok.io 22984

Trying...
Connected to 5.tcp.ngrok.io.
Connection closed by foreign host.
```
