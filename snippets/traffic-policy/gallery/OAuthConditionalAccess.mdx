  <CodeGroup>
    ```json policy.json
    {
      "on_http_request": [
        {
          "name": "OAuth",
          "actions": [
            {
              "type": "oauth",
              "config": {
                "auth_id": "oauth",
                "provider": "google"
              }
            }
          ]
        },
        {
          "name": "good email",
          "expressions": [
            "actions.ngrok.oauth.identity.email.endsWith('@ngrok.com')"
          ],
          "actions": [
            {
              "type": "custom-response",
              "config": {
                "body": "Welcome ${actions.ngrok.oauth.identity.name}!",
                "status_code": 200
              }
            }
          ]
        },
        {
          "name": "bad email",
          "expressions": [
            "!actions.ngrok.oauth.identity.email.endsWith('@ngrok.com')"
          ],
          "actions": [
            {
              "type": "custom-response",
              "config": {
                "body": "Hey, no auth for you ${actions.ngrok.oauth.identity.name}!",
                "status_code": 400
              }
            }
          ]
        }
      ]
    }
    ```

    ```yaml policy.yml
    on_http_request:
      - name: OAuth
        actions:
          - type: oauth
            config:
              auth_id: oauth
              provider: google
      - name: good email
        expressions:
          - actions.ngrok.oauth.identity.email.endsWith('@ngrok.com')
        actions:
          - type: custom-response
            config:
              body: Welcome ${actions.ngrok.oauth.identity.name}!
              status_code: 200
      - name: bad email
        expressions:
          - '!actions.ngrok.oauth.identity.email.endsWith(''@ngrok.com'')'
        actions:
          - type: custom-response
            config:
              body: Hey, no auth for you ${actions.ngrok.oauth.identity.name}!
              status_code: 400
    ```

  </CodeGroup>
