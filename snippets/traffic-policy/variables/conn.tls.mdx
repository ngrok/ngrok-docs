## Connection TLS Variables

The following variables are available under the `conn.tls` namespace:

| Name | Type | Description | | ----------------------------------------------------- | -------- | -------------------------------------------------------------------------------------------------------------- | | [`conn.tls.cipher_suite`](#conntlscipher-suite) | `string` | The cipher suite selected during the TLS handshake. | | [`conn.tls.ja4_fingerprint`](#conntlsja4-fingerprint) | `string` | The JA4 fingerprint of the TLS handshake. | | [`conn.tls.negotiated_alpn`](#conntlsnegotiated-alpn) | `string` | TLS Application-Layer Protocol Negotiation (ALPN) Protocol ID of the protocol agreed upon in the TLS handshake | | [`conn.tls.session_resumed`](#conntlssession-resumed) | `bool` | True if the TLS session was resumed.
Currently always false | | [`conn.tls.sni`](#conntlssni) | `string` | The hostname included in the `ClientHello` message via the SNI extension. | | [`conn.tls.version`](#conntlsversion) | `string` | The version of the TLS protocol used between the client and the ngrok edge. |

### `conn.tls.cipher_suite`

The cipher suite selected during the TLS handshake.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.cipher_suite == 'TLS_AES_128_GCM_SHA256'"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.cipher_suite == 'TLS_AES_128_GCM_SHA256'"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.ja4_fingerprint`

The JA4 fingerprint of the TLS handshake.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.ja4_fingerprint == 't13d1717h2_5b57614c22b0_f0fc7018f8e8'"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.ja4_fingerprint == 't13d1717h2_5b57614c22b0_f0fc7018f8e8'"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.negotiated_alpn`

The TLS Application-Layer Protocol Negotiation (ALPN) Protocol ID of the protocol agreed upon in the TLS handshake.
Defaults to `""` if no ALPN was successfully negotiated.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.negotiated_alpn == 'h2'"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.negotiated_alpn == 'h2'"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.session_resumed`

True if the TLS session was resumed.
Currently always false as we do not yet support TLS session resumption.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.session_resumed == false"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.session_resumed == false"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.sni`

The hostname included in the `ClientHello` message via the SNI extension.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.sni == 'client.example.com'"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.sni == 'client.example.com'"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.version`

The version of the TLS protocol used between the client and the ngrok edge.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.version == '1.3'"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.version == '1.3'"
  ]
  }
  ```
</CodeGroup>

## Connection TLS Client Variables

The following variables are available under the `conn.tls.client` namespace:

| Name | Type | Description | | ----------------------------------------------------------------------------------------- | ------------- | ------------------------------------------------------------------------------------------------------------------- | | [`conn.tls.client.extensions`](#conntlsclientextensions) | `[]Extension` | Additional information added to the certificate. | | [`conn.tls.client.extensions[i].id`](#conntlsclientextensionsiid) | `string` | The identifier (OID) that specifies the type of extension. | | [`conn.tls.client.extensions[i].critical`](#conntlsclientextensionsicritical) | `bool` | True if the extension is critical. | | [`conn.tls.client.extensions[i].value`](#conntlsclientextensionsivalue) | `[]byte` | The data for the extension. | | [`conn.tls.client.issuer`](#conntlsclientissuer) | `string` | The issuing authority of the certificate as a string roughly following the RFC 2253 Distinguished Names syntax. | | [`conn.tls.client.issuer.common_name`](#conntlsclientissuercommon-name) | `string` | Common name of the issuing authority, usually the domain name. | | [`conn.tls.client.issuer.country`](#conntlsclientissuercountry) | `[]string` | Country names where the issuing authority is located. | | [`conn.tls.client.issuer.locality`](#conntlsclientissuerlocality) | `[]string` | Locality or city of the issuing authority. | | [`conn.tls.client.issuer.organization`](#conntlsclientissuerorganization) | `[]string` | Name of the organization that issued the certificate. | | [`conn.tls.client.issuer.organizational_unit`](#conntlsclientissuerorganizational-unit) | `[]string` | Division of the organization responsible for the certificate. | | [`conn.tls.client.issuer.postal_code`](#conntlsclientissuerpostal-code) | `[]string` | Postal code of the issuing authority. | | [`conn.tls.client.issuer.province`](#conntlsclientissuerprovince) | `[]string` | Province or state of the issuing authority. | | [`conn.tls.client.issuer.street_address`](#conntlsclientissuerstreet-address) | `[]string` | Street address of the issuing authority. | | [`conn.tls.client.pem`](#conntlsclientpem) | `string` | Full PEM-encoded client certificate of the TLS connection. | | [`conn.tls.client.san`](#conntlsclientsan) | `string` | Subject alternative names of the client certificate. | | [`conn.tls.client.san.dns_names`](#conntlsclientsandns-names) | `[]string` | DNS names in the subject alternative names. | | [`conn.tls.client.san.email_addresses`](#conntlsclientsanemail-addresses) | `[]string` | Email addresses in the subject alternative names. | | [`conn.tls.client.san.ip_addresses`](#conntlsclientsanip-addresses) | `[]string` | IP addresses in the subject alternative names. | | [`conn.tls.client.san.uris`](#conntlsclientsanuris) | `[]string` | URIs in the subject alternative names. | | [`conn.tls.client.serial_number`](#conntlsclientserial-number) | `string` | Unique identifier for the certificate. | | [`conn.tls.client.signature_algorithm`](#conntlsclientsignature-algorithm) | `string` | Algorithm used to sign the certificate. | | [`conn.tls.client.subject`](#conntlsclientsubject) | `string` | The entity to whom the certificate is issued as a string roughly following the RFC 2253 Distinguished Names syntax. | | [`conn.tls.client.subject.common_name`](#conntlsclientsubjectcommon-name) | `string` | Common name of the subject, usually the domain name. | | [`conn.tls.client.subject.country`](#conntlsclientsubjectcountry) | `[]string` | Country names where the subject of the certificate is located. | | [`conn.tls.client.subject.locality`](#conntlsclientsubjectlocality) | `[]string` | Locality or city where the subject is located. | | [`conn.tls.client.subject.organization`](#conntlsclientsubjectorganization) | `[]string` | Name of the organization to which the subject belongs. | | [`conn.tls.client.subject.organizational_unit`](#conntlsclientsubjectorganizational-unit) | `[]string` | Division of the organization to which the subject belongs. | | [`conn.tls.client.subject.postal_code`](#conntlsclientsubjectpostal-code) | `[]string` | Postal code where the subject is located. | | [`conn.tls.client.subject.province`](#conntlsclientsubjectprovince) | `[]string` | Province or state where the subject is located. | | [`conn.tls.client.subject.street_address`](#conntlsclientsubjectstreet-address) | `[]string` | Street address where the subject is located. | | [`conn.tls.client.validity.not_after`](#conntlsclientvaliditynot-after) | `timestamp` | Expiration date and time when the certificate is no longer valid. | | [`conn.tls.client.validity.not_before`](#conntlsclientvaliditynot-before) | `timestamp` | Start date and time when the certificate becomes valid. |

### `conn.tls.client.extensions`

Additional information added to the certificate.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "size(conn.tls.client.extensions) > 0"
  ```
  ```json policy.json
  {
  "expressions": [
    "size(conn.tls.client.extensions) > 0"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.extensions[i].id`

The identifier (OID) that specifies the type of extension.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.extensions[0].id == '2.5.29.15'"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.extensions[0].id == '2.5.29.15'"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.extensions[i].critical`

True if the extension is critical.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.extensions[0].critical"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.extensions[0].critical"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.extensions[i].value`

The data for the extension.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.extensions[0].value == b' '"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.extensions[0].value == b'\u0003\u0002\u0005 '"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.issuer`

The issuing authority of the certificate as a string roughly following the RFC 2253 Distinguished Names syntax.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.issuer == 'CN=E1,O=Let's Encrypt,C=US'"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.issuer == 'CN=E1,O=Let's Encrypt,C=US'"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.issuer.common_name`

Common name of the issuing authority, usually the domain name.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.issuer.common_name == 'exampleca.com'"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.issuer.common_name == 'exampleca.com'"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.issuer.country`

Country names where the issuing authority is located.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.issuer.country == ['US']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.issuer.country == ['US']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.issuer.locality`

Locality or city of the issuing authority.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.issuer.locality == ['Mountain View']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.issuer.locality == ['Mountain View']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.issuer.organization`

Name of the organization that issued the certificate.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.issuer.organization == ['Example CA']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.issuer.organization == ['Example CA']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.issuer.organizational_unit`

Division of the organization responsible for the certificate.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.issuer.organizational_unit == ['Certification Authority Division']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.issuer.organizational_unit == ['Certification Authority Division']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.issuer.postal_code`

Postal code of the issuing authority.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.issuer.postal_code == ['94043']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.issuer.postal_code == ['94043']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.issuer.province`

Province or state of the issuing authority.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.issuer.province == ['California']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.issuer.province == ['California']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.issuer.street_address`

Street address of the issuing authority.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.issuer.street_address == ['1234 Encryption Way']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.issuer.street_address == ['1234 Encryption Way']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.pem`

Full PEM-encoded client certificate of the TLS connection, with `\n` used for newlines.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.pem.starts_with('-----BEGIN CERTIFICATE-----')"
  - "conn.tls.client.pem.ends_with('-----END CERTIFICATE-----')"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.pem.starts_with('-----BEGIN CERTIFICATE-----')",
    "conn.tls.client.pem.ends_with('-----END CERTIFICATE-----')"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.san`

Subject alternative names of the client certificate.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.san == 'DNS:www.example.com, DNS:example.com, IP Address:192.168.1.1'"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.san == 'DNS:www.example.com, DNS:example.com, IP Address:192.168.1.1'"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.san.dns_names`

DNS names in the subject alternative names.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.san.dns_names == ['www.example.com', 'example.com']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.san.dns_names == ['www.example.com', 'example.com']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.san.email_addresses`

Email addresses in the subject alternative names.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.san.email_addresses == ['ngrok-email1@example.com', 'ngrok-email2@example.com']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.san.email_addresses == ['ngrok-email1@example.com', 'ngrok-email2@example.com']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.san.ip_addresses`

IP addresses in the subject alternative names.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.san.ip_addresses == ['192.168.1.1']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.san.ip_addresses == ['192.168.1.1']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.san.uris`

URIs in the subject alternative names.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.san.uris == ['https://example.com/example']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.san.uris == ['https://example.com/example']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.serial_number`

Unique identifier for the certificate.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.serial_number == 'b53017e79d4a5208b314a55d3574e0a8'"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.serial_number == 'b53017e79d4a5208b314a55d3574e0a8'"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.signature_algorithm`

Algorithm used to sign the certificate.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.signature_algorithm == 'SHA256-RSA'"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.signature_algorithm == 'SHA256-RSA'"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.subject`

The entity to whom the certificate is issued as a string roughly following the RFC 2253 Distinguished Names syntax.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.subject == 'CN=www.example.com'"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.subject == 'CN=www.example.com'"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.subject.common_name`

Common name of the subject, usually the domain name.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.subject.common_name == 'www.example.com'"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.subject.common_name == 'www.example.com'"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.subject.country`

Country names where the subject of the certificate is located.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.subject.country == ['US']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.subject.country == ['US']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.subject.locality`

Locality or city where the subject is located.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.subject.locality == ['Mountain View']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.subject.locality == ['Mountain View']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.subject.organization`

Name of the organization to which the subject belongs.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.subject.organization == ['Example Corp']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.subject.organization == ['Example Corp']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.subject.organizational_unit`

Division of the organization to which the subject belongs.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.subject.organizational_unit == ['Web Services']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.subject.organizational_unit == ['Web Services']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.subject.postal_code`

Postal code where the subject is located.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.subject.postal_code == ['94043']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.subject.postal_code == ['94043']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.subject.province`

Province or state where the subject is located.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.subject.province == ['California']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.subject.province == ['California']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.subject.street_address`

Street address where the subject is located.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.subject.street_address == ['1234 Secure Blvd']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.subject.street_address == ['1234 Secure Blvd']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.validity.not_after`

Expiration date and time when the certificate is no longer valid.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.validity.not_after == timestamp('2023-01-01T00:00:00Z')"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.validity.not_after == timestamp('2023-01-01T00:00:00Z')"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.client.validity.not_before`

Start date and time when the certificate becomes valid.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.client.validity.not_before == timestamp('2020-01-01T00:00:00Z')"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.client.validity.not_before == timestamp('2020-01-01T00:00:00Z')"
  ]
  }
  ```
</CodeGroup>

## Connection TLS Server Variables

The following variables are available under the `conn.tls.server` namespace:

| Name | Type | Description | | ----------------------------------------------------------------------------------------- | ------------- | ------------------------------------------------------------------------------------------------------------------- | | [`conn.tls.server.extensions`](#conntlsserverextensions) | `[]Extension` | Additional information added to the certificate. | | [`conn.tls.server.extensions[i].id`](#conntlsserverextensionsiid) | `string` | The identifier that specifies the type of extension. | | [`conn.tls.server.extensions[i].critical`](#conntlsserverextensionsicritical) | `bool` | True if the extension is critical. | | [`conn.tls.server.extensions[i].value`](#conntlsserverextensionsivalue) | `[]byte` | The data for the extension. | | [`conn.tls.server.issuer`](#conntlsserverissuer) | `string` | The issuing authority of the certificate as a string roughly following the RFC 2253 Distinguished Names syntax. | | [`conn.tls.server.issuer.common_name`](#conntlsserverissuercommon-name) | `string` | Common name of the issuing authority, usually the domain name. | | [`conn.tls.server.issuer.country`](#conntlsserverissuercountry) | `[]string` | Country names where the issuing authority is located. | | [`conn.tls.server.issuer.locality`](#conntlsserverissuerlocality) | `[]string` | Locality or city of the issuing authority. | | [`conn.tls.server.issuer.organization`](#conntlsserverissuerorganization) | `[]string` | Name of the organization that issued the certificate. | | [`conn.tls.server.issuer.organizational_unit`](#conntlsserverissuerorganizational-unit) | `[]string` | Division of the organization responsible for the certificate. | | [`conn.tls.server.issuer.postal_code`](#conntlsserverissuerpostal-code) | `[]string` | Postal code of the issuing authority. | | [`conn.tls.server.issuer.province`](#conntlsserverissuerprovince) | `[]string` | Province or state of the issuing authority. | | [`conn.tls.server.issuer.street_address`](#conntlsserverissuerstreet-address) | `[]string` | Street address of the issuing authority. | | [`conn.tls.server.san`](#conntlsserversan) | `string` | Subject alternative names of the ngrok server's leaf TLS certificate. | | [`conn.tls.server.san.dns_names`](#conntlsserversandns-names) | `[]string` | DNS names in the subject alternative names of the ngrok server's leaf TLS certificate. | | [`conn.tls.server.san.email_addresses`](#conntlsserversanemail-addresses) | `[]string` | Email addresses in the subject alternative names of the ngrok server's leaf TLS certificate. | | [`conn.tls.server.san.ip_addresses`](#conntlsserversanip-addresses) | `[]string` | IP addresses in the subject alternative names of the ngrok server's leaf TLS certificate. | | [`conn.tls.server.san.uris`](#conntlsserversanuris) | `[]string` | URIs in the subject alternative names of the ngrok server's leaf TLS certificate. | | [`conn.tls.server.serial_number`](#conntlsserverserial-number) | `string` | Unique identifier for the certificate. | | [`conn.tls.server.signature_algorithm`](#conntlsserversignature-algorithm) | `string` | Algorithm used to sign the certificate. | | [`conn.tls.server.subject`](#conntlsserversubject) | `string` | The entity to whom the certificate is issued as a string roughly following the RFC 2253 Distinguished Names syntax. | | [`conn.tls.server.subject.common_name`](#conntlsserversubjectcommon-name) | `string` | Common name of the subject, usually the domain name. | | [`conn.tls.server.subject.country`](#conntlsserversubjectcountry) | `[]string` | Country names where the subject of the certificate is located. | | [`conn.tls.server.subject.locality`](#conntlsserversubjectlocality) | `[]string` | Locality or city where the subject is located. | | [`conn.tls.server.subject.organization`](#conntlsserversubjectorganization) | `[]string` | Name of the organization to which the subject belongs. | | [`conn.tls.server.subject.organizational_unit`](#conntlsserversubjectorganizational-unit) | `[]string` | Division of the organization to which the subject belongs. | | [`conn.tls.server.subject.postal_code`](#conntlsserversubjectpostal-code) | `[]string` | Postal code where the subject is located. | | [`conn.tls.server.subject.province`](#conntlsserversubjectprovince) | `[]string` | Province or state where the subject is located. | | [`conn.tls.server.subject.street_address`](#conntlsserversubjectstreet-address) | `[]string` | Street address where the subject is located. | | [`conn.tls.server.validity.not_after`](#conntlsservervaliditynot-after) | `timestamp` | Expiration date and time when the certificate is no longer valid. | | [`conn.tls.server.validity.not_before`](#conntlsservervaliditynot-before) | `timestamp` | Start date and time when the certificate becomes valid. |

### `conn.tls.server.extensions`

Additional information added to the certificate.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "size(conn.tls.server.extensions) > 0"
  ```
  ```json policy.json
  {
  "expressions": [
    "size(conn.tls.server.extensions) > 0"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.extensions[i].id`

The identifier that specifies the type of extension.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.extensions[0].id == '2.5.29.15'"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.extensions[0].id == '2.5.29.15'"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.extensions[i].critical`

True if the extension is critical.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.extensions[0].critical"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.extensions[0].critical"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.extensions[i].value`

The data for the extension.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.extensions[0].value == b' '"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.extensions[0].value == b'\u0003\u0002\u0005 '"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.issuer`

The issuing authority of the certificate as a string roughly following the RFC 2253 Distinguished Names syntax.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.issuer == 'CN=E1,O=Let's Encrypt,C=US'"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.issuer == 'CN=E1,O=Let's Encrypt,C=US'"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.issuer.common_name`

Common name of the issuing authority, usually the domain name.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.issuer.common_name == 'exampleca.com'"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.issuer.common_name == 'exampleca.com'"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.issuer.country`

Country names where the issuing authority is located.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.issuer.country == ['US']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.issuer.country == ['US']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.issuer.locality`

Locality or city of the issuing authority.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.issuer.locality == ['Mountain View']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.issuer.locality == ['Mountain View']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.issuer.organization`

Name of the organization that issued the certificate.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.issuer.organization == ['Example CA']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.issuer.organization == ['Example CA']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.issuer.organizational_unit`

Division of the organization responsible for the certificate.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.issuer.organizational_unit == ['Certification Authority Division']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.issuer.organizational_unit == ['Certification Authority Division']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.issuer.postal_code`

Postal code of the issuing authority.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.issuer.postal_code == ['94043']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.issuer.postal_code == ['94043']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.issuer.province`

Province or state of the issuing authority.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.issuer.province == ['California']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.issuer.province == ['California']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.issuer.street_address`

Street address of the issuing authority.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.issuer.street_address == ['1234 Encryption Way']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.issuer.street_address == ['1234 Encryption Way']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.san`

Subject alternative names of the server certificate of the ngrok server's leaf TLS certificate.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.san == 'DNS:www.example.com, DNS:example.com, IP Address:192.168.1.1'"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.san == 'DNS:www.example.com, DNS:example.com, IP Address:192.168.1.1'"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.san.dns_names`

DNS names in the subject alternative names of the ngrok server's leaf TLS certificate.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.san.dns_names == ['ngrok-dns.com', 'ngrok-dns2.com']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.san.dns_names == ['ngrok-dns.com', 'ngrok-dns2.com']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.san.email_addresses`

Email addresses in the subject alternative names of the ngrok server's leaf TLS certificate.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.san.email_addresses == ['ngrok-email1@example.com', 'ngrok-email2@example.com']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.san.email_addresses == ['ngrok-email1@example.com', 'ngrok-email2@example.com']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.san.ip_addresses`

IP addresses in the subject alternative names of the ngrok server's leaf TLS certificate.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.san.ip_addresses == ['192.168.1.1']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.san.ip_addresses == ['192.168.1.1']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.san.uris`

URIs in the subject alternative names of the ngrok server's leaf TLS certificate.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.san.uris == ['https://example.com/example']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.san.uris == ['https://example.com/example']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.serial_number`

Unique identifier for the certificate.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.serial_number == 'b53017e79d4a5208b314a55d3574e0a8'"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.serial_number == 'b53017e79d4a5208b314a55d3574e0a8'"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.signature_algorithm`

Algorithm used to sign the certificate.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.signature_algorithm == 'SHA256-RSA'"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.signature_algorithm == 'SHA256-RSA'"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.subject`

The entity to whom the certificate is issued as a string roughly following the RFC 2253 Distinguished Names syntax.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.subject == 'CN=www.example.com'"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.subject == 'CN=www.example.com'"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.subject.common_name`

Common name of the subject, usually the domain name.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.subject.common_name == 'ngrok-server.example.com'"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.subject.common_name == 'ngrok-server.example.com'"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.subject.country`

Country names where the subject of the certificate is located.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.subject.country == ['US']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.subject.country == ['US']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.subject.locality`

Locality or city where the subject is located.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.subject.locality == ['Mountain View']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.subject.locality == ['Mountain View']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.subject.organization`

Name of the organization to which the subject belongs.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.subject.organization == ['Example Corp']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.subject.organization == ['Example Corp']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.subject.organizational_unit`

Division of the organization to which the subject belongs.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.subject.organizational_unit == ['Web Services']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.subject.organizational_unit == ['Web Services']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.subject.postal_code`

Postal code where the subject is located.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.subject.postal_code == ['94043']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.subject.postal_code == ['94043']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.subject.province`

Province or state where the subject is located.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.subject.province == ['California']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.subject.province == ['California']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.subject.street_address`

Street address where the subject is located.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.subject.street_address == ['1234 Secure Blvd']"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.subject.street_address == ['1234 Secure Blvd']"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.validity.not_after`

Expiration date and time when the certificate is no longer valid.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.validity.not_after > timestamp('2023-01-01T00:00:00Z')"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.validity.not_after > timestamp('2023-01-01T00:00:00Z')"
  ]
  }
  ```
</CodeGroup>

### `conn.tls.server.validity.not_before`

Start date and time when the certificate becomes valid.

<CodeGroup>
  ```yaml policy.yml
  expressions:
  - "conn.tls.server.validity.not_before < timestamp('2020-01-01T00:00:00Z')"
  ```
  ```json policy.json
  {
  "expressions": [
    "conn.tls.server.validity.not_before < timestamp('2020-01-01T00:00:00Z')"
  ]
  }
  ```
</CodeGroup>
