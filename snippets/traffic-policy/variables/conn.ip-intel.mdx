

IP Intelligence provides you with additional information about any IP address you see in ngrok. It includes Autonomous System information, Geolocation data, as well as information fetched from 3rd parties that list IP address for blocklists or allowlists.

See the full list of [IP Categories available here](#ip-categories).

These variables can be used in Traffic Policy expressions, or they can be used to enrich your traffic via dynamic injection into headers or responses.

## Client IP Intelligence

The following variables are available under the `conn.client_ip` namespace:

| Name                                                    | Type   | Description                                                                                                         |
| ------------------------------------------------------- | ------ | ------------------------------------------------------------------------------------------------------------------- |
| [`conn.client_ip.categories`](#connclient-ipcategories) | `list` | The list of categories that classify the `conn.client_ip`. Check out our [full list of categories](#ip-categories). |

### `conn.client_ip.categories`

The list of categories that classify the `conn.client_ip`. Check out our [full list of categories](#ip-categories).

<CodeGroup>
```yaml policy.yml
expressions:
  - "('proxy.anonymous.tor' in conn.client_ip.categories)"
```
```json policy.json
{
  "expressions": [
    "('proxy.anonymous.tor' in conn.client_ip.categories)"
  ]
}
```
</CodeGroup>

## Client IP Autonomous System

The following variables are available under the `conn.client_ip` namespace:

| Name                                                             | Type      | Description                                                                                        |
| ---------------------------------------------------------------- | --------- | -------------------------------------------------------------------------------------------------- |
| [`conn.client_ip.as.number`](#connclient-ipasnumber)             | `integer` | The [Autonomous System Number](https://www.arin.net/resources/guide/asn/) of the `conn.client_ip`. |
| [`conn.client_ip.as.organization`](#connclient-ipasorganization) | `string`  | The Autonomous System Organization name of the `conn.client_ip`.                                   |

### `conn.client_ip.as.number`

The [Autonomous System Number](https://www.arin.net/resources/guide/asn/) of the `conn.client_ip`.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.client_ip.as.number == 12345"
```
```json policy.json
{
  "expressions": [
    "conn.client_ip.as.number == 12345"
  ]
}
```
</CodeGroup>

### `conn.client_ip.as.organization`

The Autonomous System Organization name of the `conn.client_ip`.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.client_ip.as.organization == 'COMCAST-7922'"
```
```json policy.json
{
  "expressions": [
    "conn.client_ip.as.organization == 'COMCAST-7922'"
  ]
}
```
</CodeGroup>

## Client IP Geo Location

This is the location where the IP address is located, which may be different from where the IP address is registered. For more details, see the [MaxMind documentation](https://support.maxmind.com/hc/en-us/articles/4414762983195-Country-level-and-City-level-Geolocation).

| Name                                                                                | Type      | Description                                                                                                   |
| ----------------------------------------------------------------------------------- | --------- | ------------------------------------------------------------------------------------------------------------- |
| [`conn.client_ip.geo.location.city`](#connclient-ipgeolocationcity)                 | `string`  | The name of the city, in EN, where the `conn.client_ip` is likely to originate.                               |
| [`conn.client_ip.geo.location.continent`](#connclient-ipgeolocationcontinent)       | `string`  | The name of the continent, in EN, where the `conn.client_ip` is likely to originate.                          |
| [`conn.client_ip.geo.location.country`](#connclient-ipgeolocationcountry)           | `string`  | The name of the country, in EN, where the `conn.client_ip` is likely to originate.                            |
| [`conn.client_ip.geo.location.country_code`](#connclient-ipgeolocationcountry_code) | `string`  | The two-letter ISO country code where the `conn.client_ip` is likely to originate.                            |
| [`conn.client_ip.geo.location.is_eu`](#connclient-ipgeolocationis_eu)               | `boolean` | Determines if the `conn.client_ip` is located in the EU. Helpful for GDPR compliance.                         |
| [`conn.client_ip.geo.location.latitude`](#connclient-ipgeolocationlatitude)         | `string`  | The approximate latitude where the `conn.client_ip` is likely to originate.                                   |
| [`conn.client_ip.geo.location.longitude`](#connclient-ipgeolocationlongitude)       | `string`  | The approximate longitude where the `conn.client_ip` is likely to originate.                                  |
| [`conn.client_ip.geo.location.metro_code`](#connclient-ipgeolocationmetro_code)     | `string`  | The metro code where the `conn.client_ip` is likely to originate.                                             |
| [`conn.client_ip.geo.location.postal_code`](#connclient-ipgeolocationpostal_code)   | `string`  | The postal code where the `conn.client_ip` is likely to originate.                                            |
| [`conn.client_ip.geo.location.radius`](#connclient-ipgeolocationradius)             | `string`  | The radius in kilometers around the latitude and longitude where the `conn.client_ip` is likely to originate. |
| [`conn.client_ip.geo.location.subdivision`](#connclient-ipgeolocationsubdivision)   | `string`  | The name of the subdivision, in EN, where the `conn.client_ip` is likely to originate.                        |
| [`conn.client_ip.geo.location.timezone`](#connclient-ipgeolocationtimezone)         | `string`  | The name of the timezone where the `conn.client_ip` is likely to originate.                                   |

### `conn.client_ip.geo.location.city`

The name of the city, in EN, where the `conn.client_ip` is likely to originate.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.client_ip.geo.location.city == 'Strongsville'"
```
```json policy.json
{
  "expressions": [
    "conn.client_ip.geo.location.city == 'Strongsville'"
  ]
}
```
</CodeGroup>

### `conn.client_ip.geo.location.continent`

The name of the continent, in EN, where the `conn.client_ip` is likely to originate.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.client_ip.geo.location.continent == 'North America'"
```
```json policy.json
{
  "expressions": [
    "conn.client_ip.geo.location.continent == 'North America'"
  ]
}
```
</CodeGroup>

### `conn.client_ip.geo.location.country`

The name of the country, in EN, where the `conn.client_ip` is likely to originate.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.client_ip.geo.location.country == 'United States'"
```
```json policy.json
{
  "expressions": [
    "conn.client_ip.geo.location.country == 'United States'"
  ]
}
```
</CodeGroup>

### `conn.client_ip.geo.location.country_code`

The two-letter ISO country code where the `conn.client_ip` is likely to originate.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.client_ip.geo.location.country_code != 'US'"
```
```json policy.json
{
  "expressions": [
    "conn.client_ip.geo.location.country_code != 'US'"
  ]
}
```
</CodeGroup>

### `conn.client_ip.geo.location.is_eu`

Determines if the `conn.client_ip` is in the EU. Helpful for GDPR compliance.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.client_ip.geo.location.is_eu == true"
```
```json policy.json
{
  "expressions": [
    "conn.client_ip.geo.location.is_eu == true"
  ]
}
```
</CodeGroup>

### `conn.client_ip.geo.location.latitude`

The approximate latitude where the `conn.client_ip` is likely to originate.

<CodeGroup>
```yaml policy.yml
expressions:
  - "double(conn.client_ip.geo.location.latitude) >= 45.0"
```
```json policy.json
{
  "expressions": [
    "double(conn.client_ip.geo.location.latitude) >= 45.0"
  ]
}
```
</CodeGroup>

### `conn.client_ip.geo.location.longitude`

The approximate longitude where the `conn.client_ip` is likely to originate.

<CodeGroup>
```yaml policy.yml
expressions:
  - "double(conn.client_ip.geo.location.longitude) <= -93.0"
```
```json policy.json
{
  "expressions": [
    "double(conn.client_ip.geo.location.longitude) <= -93.0"
  ]
}
```
</CodeGroup>

### `conn.client_ip.geo.location.metro_code`

The metro code where the `conn.client_ip` is likely to originate.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.client_ip.geo.location.metro_code != ''"
```
```json policy.json
{
  "expressions": [
    "conn.client_ip.geo.location.metro_code != ''"
  ]
}
```
</CodeGroup>

### `conn.client_ip.geo.location.postal_code`

The postal code where the `conn.client_ip` is likely to originate.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.client_ip.geo.location.postal_code == '94324'"
```
```json policy.json
{
  "expressions": [
    "conn.client_ip.geo.location.postal_code == '94324'"
  ]
}
```
</CodeGroup>

### `conn.client_ip.geo.location.radius`

The radius in kilometers around the latitude and longitude where the `conn.client_ip` is likely to originate.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.client_ip.geo.location.radius <= '5'"
```
```json policy.json
{
  "expressions": [
    "conn.client_ip.geo.location.radius <= '5'"
  ]
}
```
</CodeGroup>

### `conn.client_ip.geo.location.subdivision`

The name of the subdivision, in EN, where the `conn.client_ip` is likely to originate.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.client_ip.geo.location.subdivision == 'California'"
```
```json policy.json
{
  "expressions": [
    "conn.client_ip.geo.location.subdivision == 'California'"
  ]
}
```
</CodeGroup>

### `conn.client_ip.geo.location.timezone`

The name of the timezone where the `conn.client_ip` is likely to originate.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.client_ip.geo.location.timezone == 'America/New_York'"
```
```json policy.json
{
  "expressions": [
    "conn.client_ip.geo.location.timezone == 'America/New_York'"
  ]
}
```
</CodeGroup>

## Client IP Registered Geo Location

This is the location where the IP address is registered, which may be different from where the IP address is located. For more details, see the [MaxMind documentation](https://support.maxmind.com/hc/en-us/articles/4414762983195-Country-level-and-City-level-Geolocation).

| Name                                                                                                      | Type      | Description                                                                              |
| --------------------------------------------------------------------------------------------------------- | --------- | ---------------------------------------------------------------------------------------- |
| [`conn.client_ip.geo.registered_location.city`](#connclient-ipgeoregistered-locationcity)                 | `string`  | The name of the city, in EN, where the `conn.client_ip` is registered.                   |
| [`conn.client_ip.geo.registered_location.continent`](#connclient-ipgeoregistered-locationcontinent)       | `string`  | The name of the continent, in EN, where the `conn.client_ip` is registered.              |
| [`conn.client_ip.geo.registered_location.country`](#connclient-ipgeoregistered-locationcountry)           | `string`  | The name of the country, in EN, where the `conn.client_ip` is registered.                |
| [`conn.client_ip.geo.registered_location.country_code`](#connclient-ipgeoregistered-locationcountry-code) | `string`  | The two-letter ISO country code where the `conn.client_ip` is registered.                |
| [`conn.client_ip.geo.registered_location.is_eu`](#connclient-ipgeoregistered-locationis-eu)               | `boolean` | Determines if the `conn.client_ip` is registered in the EU. Helpful for GDPR compliance. |
| [`conn.client_ip.geo.registered_location.metro_code`](#connclient-ipgeoregistered-locationmetro-code)     | `string`  | The metro code where the `conn.client_ip` is registered.                                 |
| [`conn.client_ip.geo.registered_location.subdivision`](#connclient-ipgeoregistered-locationsubdivision)   | `string`  | The name of the subdivision, in EN, where the `conn.client_ip` is registered.            |
| [`conn.client_ip.geo.registered_location.timezone`](#connclient-ipgeoregistered-locationtimezone)         | `string`  | The name of the timezone where the `conn.client_ip` is registered.                       |

### `conn.client_ip.geo.registered_location.city`

The name of the city, in EN, where the `conn.client_ip` is registered.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.client_ip.geo.registered_location.city == 'Strongsville'"
```
```json policy.json
{
  "expressions": [
    "conn.client_ip.geo.registered_location.city == 'Strongsville'"
  ]
}
```
</CodeGroup>

### `conn.client_ip.geo.registered_location.continent`

The name of the continent, in EN, where the `conn.client_ip` is registered.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.client_ip.geo.registered_location.continent == 'North America'"
```
```json policy.json
{
  "expressions": [
    "conn.client_ip.geo.registered_location.continent == 'North America'"
  ]
}
```
</CodeGroup>

### `conn.client_ip.geo.registered_location.country`

The name of the country, in EN, where the `conn.client_ip` is registered.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.client_ip.geo.registered_location.country == 'United States'"
```
```json policy.json
{
  "expressions": [
    "conn.client_ip.geo.registered_location.country == 'United States'"
  ]
}
```
</CodeGroup>

### `conn.client_ip.geo.registered_location.country_code`

The two-letter ISO country code where the `conn.client_ip` is registered.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.client_ip.geo.registered_location.country_code != 'US'"
```
```json policy.json
{
  "expressions": [
    "conn.client_ip.geo.registered_location.country_code != 'US'"
  ]
}
```
</CodeGroup>

### `conn.client_ip.geo.registered_location.is_eu`

Determines if the `conn.client_ip` is in the EU. Helpful for GDPR compliance.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.client_ip.geo.registered_location.is_eu == true"
```
```json policy.json
{
  "expressions": [
    "conn.client_ip.geo.registered_location.is_eu == true"
  ]
}
```
</CodeGroup>

### `conn.client_ip.geo.registered_location.subdivision`

The name of the subdivision, in EN, where the `conn.client_ip` is registered.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.client_ip.geo.registered_location.subdivision == 'California'"
```
```json policy.json
{
  "expressions": [
    "conn.client_ip.geo.registered_location.subdivision == 'California'"
  ]
}
```
</CodeGroup>

### `conn.client_ip.geo.registered_location.metro_code`

The metro code where the `conn.client_ip` is registered.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.client_ip.geo.registered_location.metro_code != ''"
```
```json policy.json
{
  "expressions": [
    "conn.client_ip.geo.registered_location.metro_code != ''"
  ]
}
```
</CodeGroup>

### `conn.client_ip.geo.registered_location.timezone`

The name of the timezone where the `conn.client_ip` is registered.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.client_ip.geo.registered_location.timezone == 'America/New_York'"
```
```json policy.json
{
  "expressions": [
    "conn.client_ip.geo.registered_location.timezone == 'America/New_York'"
  ]
}
```
</CodeGroup>

## Server IP Intelligence

The following variables are available under the `conn.server_ip` namespace:

| Name                                                    | Type   | Description                                                                                                         |
| ------------------------------------------------------- | ------ | ------------------------------------------------------------------------------------------------------------------- |
| [`conn.server_ip.categories`](#connserver-ipcategories) | `list` | The list of categories that classify the `conn.server_ip`. Check out our [full list of categories](#ip-categories). |

### `conn.server_ip.categories`

The list of categories that classify the `conn.server_ip`. Check out our [full list of categories](#ip-categories).

<CodeGroup>
```yaml policy.yml
expressions:
  - "('proxy.anonymous.tor' in conn.server_ip.categories)"
```
```json policy.json
{
  "expressions": [
    "('proxy.anonymous.tor' in conn.server_ip.categories)"
  ]
}
```
</CodeGroup>

## Server IP Autonomous System

| Name                                                             | Type      | Description                                                                                        |
| ---------------------------------------------------------------- | --------- | -------------------------------------------------------------------------------------------------- |
| [`conn.server_ip.as.number`](#connserver-ipasnumber)             | `integer` | The [Autonomous System Number](https://www.arin.net/resources/guide/asn/) of the `conn.server_ip`. |
| [`conn.server_ip.as.organization`](#connserver-ipasorganization) | `string`  | The Autonomous System Organization name of the `conn.server_ip`.                                   |

### `conn.server_ip.as.number`

The [Autonomous System Number](https://www.arin.net/resources/guide/asn/) of the `conn.server_ip`.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.server_ip.as.number == 12345"
```
```json policy.json
{
  "expressions": [
    "conn.server_ip.as.number == 12345"
  ]
}
```
</CodeGroup>

### `conn.server_ip.as.organization`

The Autonomous System Organization name of the `conn.server_ip`.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.server_ip.as.organization == 'COMCAST-7922'"
```
```json policy.json
{
  "expressions": [
    "conn.server_ip.as.organization == 'COMCAST-7922'"
  ]
}
```
</CodeGroup>

## Server IP Location Geo

This is the location where the server IP address is located, which may be different from where the IP address is registered. For more details, see the [MaxMind documentation](https://support.maxmind.com/hc/en-us/articles/4414762983195-Country-level-and-City-level-Geolocation).

| Name                                                                                | Type      | Description                                                                                                   |
| ----------------------------------------------------------------------------------- | --------- | ------------------------------------------------------------------------------------------------------------- |
| [`conn.server_ip.geo.location.city`](#connserver-ipgeolocationcity)                 | `string`  | The name of the city, in EN, where the `conn.server_ip` is likely to originate.                               |
| [`conn.server_ip.geo.location.continent`](#connserver-ipgeolocationcontinent)       | `string`  | The name of the continent, in EN, where the `conn.server_ip` is likely to originate.                          |
| [`conn.server_ip.geo.location.country`](#connserver-ipgeolocationcountry)           | `string`  | The name of the country, in EN, where the `conn.server_ip` is likely to originate.                            |
| [`conn.server_ip.geo.location.country_code`](#connserver-ipgeolocationcountry_code) | `string`  | The two-letter ISO country code where the `conn.server_ip` is likely to originate.                            |
| [`conn.server_ip.geo.location.is_eu`](#connserver-ipgeolocationis_eu)               | `boolean` | Determines if the `conn.server_ip` is located in the EU. Helpful for GDPR compliance.                         |
| [`conn.server_ip.geo.location.latitude`](#connserver-ipgeolocationlatitude)         | `string`  | The approximate latitude where the `conn.server_ip` is likely to originate.                                   |
| [`conn.server_ip.geo.location.longitude`](#connserver-ipgeolocationlongitude)       | `string`  | The approximate longitude where the `conn.server_ip` is likely to originate.                                  |
| [`conn.server_ip.geo.location.metro_code`](#connserver-ipgeolocationmetro_code)     | `string`  | The metro code where the `conn.server_ip` is likely to originate.                                             |
| [`conn.server_ip.geo.location.postal_code`](#connserver-ipgeolocationpostal_code)   | `string`  | The postal code where the `conn.server_ip` is likely to originate.                                            |
| [`conn.server_ip.geo.location.radius`](#connserver-ipgeolocationradius)             | `string`  | The radius in kilometers around the latitude and longitude where the `conn.server_ip` is likely to originate. |
| [`conn.server_ip.geo.location.subdivision`](#connserver-ipgeolocationsubdivision)   | `string`  | The name of the subdivision, in EN, where the `conn.server_ip` is likely to originate.                        |
| [`conn.server_ip.geo.location.timezone`](#connserver-ipgeolocationtimezone)         | `string`  | The name of the timezone where the `conn.server_ip` is likely to originate.                                   |

### `conn.server_ip.geo.location.city`

The name of the city, in EN, where the `conn.server_ip` is likely to originate.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.server_ip.geo.location.city == 'Strongsville'"
```
```json policy.json
{
  "expressions": [
    "conn.server_ip.geo.location.city == 'Strongsville'"
  ]
}
```
</CodeGroup>

### `conn.server_ip.geo.location.continent`

The name of the continent, in EN, where the `conn.server_ip` is likely to originate.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.server_ip.geo.location.continent == 'North America'"
```
```json policy.json
{
  "expressions": [
    "conn.server_ip.geo.location.continent == 'North America'"
  ]
}
```
</CodeGroup>

### `conn.server_ip.geo.location.country`

The name of the country, in EN, where the `conn.server_ip` is likely to originate.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.server_ip.geo.location.country == 'United States'"
```
```json policy.json
{
  "expressions": [
    "conn.server_ip.geo.location.country == 'United States'"
  ]
}
```
</CodeGroup>

### `conn.server_ip.geo.location.country_code`

The two-letter ISO country code where the `conn.server_ip` is likely to originate.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.server_ip.geo.location.country_code != 'US'"
```
```json policy.json
{
  "expressions": [
    "conn.server_ip.geo.location.country_code != 'US'"
  ]
}
```
</CodeGroup>

### `conn.server_ip.geo.location.is_eu`

Determines if the `conn.server_ip` location is in the EU. Helpful for GDPR compliance.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.server_ip.geo.location.is_eu == true"
```
```json policy.json
{
  "expressions": [
    "conn.server_ip.geo.location.is_eu == true"
  ]
}
```
</CodeGroup>

### `conn.server_ip.geo.location.latitude`

The approximate latitude where the `conn.server_ip` is likely to originate.

<CodeGroup>
```yaml policy.yml
expressions:
  - "double(conn.server_ip.geo.location.latitude) >= 45.0"
```
```json policy.json
{
  "expressions": [
    "double(conn.server_ip.geo.location.latitude) >= 45.0"
  ]
}
```
</CodeGroup>

### `conn.server_ip.geo.location.longitude`

The approximate longitude where the `conn.server_ip` is likely to originate.

<CodeGroup>
```yaml policy.yml
expressions:
  - "double(conn.server_ip.geo.location.longitude) <= -93.0"
```
```json policy.json
{
  "expressions": [
    "double(conn.server_ip.geo.location.longitude) <= -93.0"
  ]
}
```
</CodeGroup>

### `conn.server_ip.geo.location.metro_code`

The metro code where the `conn.server_ip` is likely to originate.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.server_ip.geo.location.metro_code != ''"
```
```json policy.json
{
  "expressions": [
    "conn.server_ip.geo.location.metro_code != ''"
  ]
}
```
</CodeGroup>

### `conn.server_ip.geo.location.postal_code`

The postal code where the `conn.server_ip` is likely to originate.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.server_ip.geo.location.postal_code == '94324'"
```
```json policy.json
{
  "expressions": [
    "conn.server_ip.geo.location.postal_code == '94324'"
  ]
}
```
</CodeGroup>

### `conn.server_ip.geo.location.radius`

The radius in kilometers around the latitude and longitude where the `conn.server_ip` is likely to originate.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.server_ip.geo.location.radius <= '5'"
```
```json policy.json
{
  "expressions": [
    "conn.server_ip.geo.location.radius <= '5'"
  ]
}
```
</CodeGroup>

### `conn.server_ip.geo.location.subdivision`

The name of the subdivision, in EN, where the `conn.server_ip` is likely to originate.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.server_ip.geo.location.subdivision == 'California'"
```
```json policy.json
{
  "expressions": [
    "conn.server_ip.geo.location.subdivision == 'California'"
  ]
}
```
</CodeGroup>

### `conn.server_ip.geo.location.timezone`

The name of the timezone where the `conn.server_ip` is likely to originate.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.server_ip.geo.location.timezone == 'America/New_York'"
```
```json policy.json
{
  "expressions": [
    "conn.server_ip.geo.location.timezone == 'America/New_York'"
  ]
}
```
</CodeGroup>

## Server IP Registered Location Geo

This is the location where the server IP address is registered, which may be different from where the IP address is located. For more details, see the [MaxMind documentation](https://support.maxmind.com/hc/en-us/articles/4414762983195-Country-level-and-City-level-Geolocation).

| Name                                                                                                      | Type      | Description                                                                              |
| --------------------------------------------------------------------------------------------------------- | --------- | ---------------------------------------------------------------------------------------- |
| [`conn.server_ip.geo.registered_location.city`](#connserver-ipgeoregistered_locationcity)                 | `string`  | The name of the city, in EN, where the `conn.server_ip` is registered.                   |
| [`conn.server_ip.geo.registered_location.continent`](#connserver-ipgeoregistered_locationcontinent)       | `string`  | The name of the continent, in EN, where the `conn.server_ip` is registered.              |
| [`conn.server_ip.geo.registered_location.country`](#connserver-ipgeoregistered_locationcountry)           | `string`  | The name of the country, in EN, where the `conn.server_ip` is registered.                |
| [`conn.server_ip.geo.registered_location.country_code`](#connserver-ipgeoregistered_locationcountry_code) | `string`  | The two-letter ISO country code where the `conn.server_ip` is registered.                |
| [`conn.server_ip.geo.registered_location.is_eu`](#connserver-ipgeoregistered_locationis_eu)               | `boolean` | Determines if the `conn.server_ip` is registered in the EU. Helpful for GDPR compliance. |
| [`conn.server_ip.geo.registered_location.metro_code`](#connserver-ipgeoregistered_locationmetro_code)     | `string`  | The metro code where the `conn.server_ip` is registered.                                 |
| [`conn.server_ip.geo.registered_location.subdivision`](#connserver-ipgeoregistered_locationsubdivision)   | `string`  | The name of the subdivision, in EN, where the `conn.server_ip` is registered.            |
| [`conn.server_ip.geo.registered_location.timezone`](#connserver-ipgeoregistered_locationtimezone)         | `string`  | The name of the timezone where the `conn.server_ip` is registered.                       |

### `conn.server_ip.geo.registered_location.city`

The name of the city, in EN, where the `conn.server_ip` is registered.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.server_ip.geo.registered_location.city == 'Strongsville'"
```
```json policy.json
{
  "expressions": [
    "conn.server_ip.geo.registered_location.city == 'Strongsville'"
  ]
}
```
</CodeGroup>

### `conn.server_ip.geo.registered_location.continent`

The name of the continent, in EN, where the `conn.server_ip` is registered.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.server_ip.geo.registered_location.continent == 'North America'"
```
```json policy.json
{
  "expressions": [
    "conn.server_ip.geo.registered_location.continent == 'North America'"
  ]
}
```
</CodeGroup>

### `conn.server_ip.geo.registered_location.country`

The name of the country, in EN, where the `conn.server_ip` is registered.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.server_ip.geo.registered_location.country == 'United States'"
```
```json policy.json
{
  "expressions": [
    "conn.server_ip.geo.registered_location.country == 'United States'"
  ]
}
```
</CodeGroup>

### `conn.server_ip.geo.registered_location.country_code`

The two-letter ISO country code where the `conn.server_ip` is registered.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.server_ip.geo.registered_location.country_code != 'US'"
```
```json policy.json
{
  "expressions": [
    "conn.server_ip.geo.registered_location.country_code != 'US'"
  ]
}
```
</CodeGroup>

### `conn.server_ip.geo.registered_location.is_eu`

Determines if the `conn.server_ip` is in the EU. Helpful for GDPR compliance.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.server_ip.geo.registered_location.is_eu == true"
```
```json policy.json
{
  "expressions": [
    "conn.server_ip.geo.registered_location.is_eu == true"
  ]
}
```
</CodeGroup>

### `conn.server_ip.geo.registered_location.subdivision`

The name of the subdivision, in EN, where the `conn.server_ip` is registered.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.server_ip.geo.registered_location.subdivision == 'California'"
```
```json policy.json
{
  "expressions": [
    "conn.server_ip.geo.registered_location.subdivision == 'California'"
  ]
}
```
</CodeGroup>

### `conn.server_ip.geo.registered_location.metro_code`

The metro code where the `conn.server_ip` is registered.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.server_ip.geo.registered_location.metro_code != ''"
```
```json policy.json
{
  "expressions": [
    "conn.server_ip.geo.registered_location.metro_code != ''"
  ]
}
```
</CodeGroup>

### `conn.server_ip.geo.registered_location.timezone`

The name of the timezone where the `conn.server_ip` is registered.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.server_ip.geo.registered_location.timezone == 'America/New_York'"
```
```json policy.json
{
  "expressions": [
    "conn.server_ip.geo.registered_location.timezone == 'America/New_York'"
  ]
}
```
</CodeGroup>
