## Connection Variables

The following variables are available under the `conn` namespace:

| Name | Type | Description | | ------------------------------------------ | ----------- | ----------------------------------------------------------------------------------------------------------------------------------------- | | [`conn.client_ip`](#connclient-ip) | `string` | Source IP of the connection to the ngrok endpoint. | | [`conn.client_port`](#connclient-port) | `int32` | Source port of the connection to the ngrok endpoint. | | [`conn.server_ip`](#connserver-ip) | `string` | The IP that this connection was established on. | | [`conn.server_port`](#connserver-port) | `int32` | The port that this connection was established on. | | [`conn.server_region`](#connserver-region) | `string` | The ngrok [PoP (Point of Presence)](/universal-gateway/points-of-presence/) that this connection was established on and serviced through. | | [`conn.ts.start`](#conntsstart) | `timestamp` | Timestamp when the connection to ngrok was started. |

### `conn.client_ip`

Source IP of the connection to the ngrok endpoint.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.client_ip in ['::1', '127.0.0.1']"
```
```json policy.json
{
  "expressions": [
    "conn.client_ip in ['::1', '127.0.0.1']"
  ]
}
```
</CodeGroup>

### `conn.client_port`

Source port of the connection to the ngrok endpoint.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.client_port == 80"
```
```json policy.json
{
  "expressions": [
    "conn.client_port == 80"
  ]
}
```
</CodeGroup>

### `conn.server_ip`

The IP that this connection was established on.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.server_ip == '192.168.1.1'"
```
```json policy.json
{
  "expressions": [
    "conn.server_ip == '192.168.1.1'"
  ]
}
```
</CodeGroup>

### `conn.server_port`

The port that this connection was established on.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.server_port == 80"
```
```json policy.json
{
  "expressions": [
    "conn.server_port == 80"
  ]
}
```
</CodeGroup>

### `conn.server_region`

The ngrok [PoP (Point of Presence)](/universal-gateway/points-of-presence/) that this connection was established on and serviced through.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.server_region == 'eu'"
```
```json policy.json
{
  "expressions": [
    "conn.server_region == 'eu'"
  ]
}
```
</CodeGroup>

### `conn.ts.start`

Timestamp when the connection to ngrok was started.

<CodeGroup>
```yaml policy.yml
expressions:
  - "conn.ts.start > timestamp('2023-12-31T00:00:00Z')"
```
```json policy.json
{
  "expressions": [
    "conn.ts.start > timestamp('2023-12-31T00:00:00Z')"
  ]
}
```
</CodeGroup>
