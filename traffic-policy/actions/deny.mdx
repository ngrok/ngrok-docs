---
title: Deny Action
sidebarTitle: Deny
description: The Deny action enables you to reject incoming requests on your endpoints before they make it to your upstream service.
---

import ActionVariablesDescription from "/snippets/traffic-policy/common/action-variables-description.mdx";

import { ConfigField } from "/snippets/ConfigTable.jsx";

The **Deny** Traffic Policy action enables you to reject incoming requests on
your endpoints before they make it to your upstream service.

## Configuration Reference

The [Traffic Policy](/traffic-policy/) configuration
reference for this action.

### Supported Phases

`on_tcp_connect`, `on_http_request`

### Type

`deny`

### Configuration Fields

<Tabs>
	<Tab title="on_tcp_connect" label="on_tcp_connect">
    <Note>This action does not have any configuration fields for TLS / TCP endpoints.</Note>
	</Tab>

    <Tab title="on_http_request" label="on_http_request">
    <ConfigField title="status_code" type="integer" defaultValue="403">
      The response status code to return back to the client when the request is denied.
    </ConfigField>
    </Tab>

</Tabs>

## Behavior

<Tabs>
  <Tab title="on_tcp_connect" label="on_tcp_connect">
    When this action is executed, the upstream server is never reached and a
    response is immediately returned and no further actions or rules in the policy
    configuration will be executed.
  </Tab>

  <Tab title="on_http_request" label="on_http_request">
    When this action is executed, the upstream server is never reached and a
    response is immediately returned and no further actions or rules in the policy
    configuration will be executed.

    ### Custom Content

    The deny traffic policy action will not send back a response body to the client.
    To send back a response body, use the [`custom-response`](/traffic-policy/actions/custom-response)
    action.

  </Tab>
</Tabs>

## Examples

<Tabs>
  <Tab title="on_tcp_connect" label="on_tcp_connect">
    ### Deny all traffic

    The following [Traffic Policy](/traffic-policy/)
    configuration will deny all inbound traffic on your endpoint.

    #### Example Traffic Policy Document

    <CodeGroup>
    ```yaml policy.yml
    on_tcp_connect:
      - actions:
          - type: deny
    ```

    ```json policy.json
    {
      "on_tcp_connect": [
        {
          "actions": [
            {
              "type": "deny"
            }
          ]
        }
      ]
    }
    ```
    </CodeGroup>

    #### Example Request

    ```bash
    $ telnet 5.tcp.ngrok.io 22984

    Trying...
    Connected to 5.tcp.ngrok.io.
    Connection closed by foreign host.
    ```

    In this example, we attempt to connect to `5.tcp.ngrok.io:22984` using the
    `telnet` command and ngrok immediately closes the connection.

  </Tab>

  <Tab title="on_http_request" label="on_http_request">
    ### Deny traffic with a 404 status code

    The following [Traffic Policy](/traffic-policy/)
    configuration will deny all inbound traffic with a `404` on your endpoint.

    #### Example Traffic Policy Document

    <CodeGroup>
    ```yaml policy.yml {3-10}
    on_http_request:
      - actions:
          - type: deny
            config:
              status_code: 404
    ```

    ```json policy.json {5-10}
    {
      "on_http_request": [
        {
          "actions": [
            {
              "type": "deny",
              "config": {
                "status_code": 404
              }
            }
          ]
        }
      ]
    }
    ```
    </CodeGroup>

    #### Example Request

    ```curl
    $ curl https://example.ngrok.app
    ```

    ```http
    HTTP/2 404 Not Found
    ```

    In this example, we attempt to connect to `example.ngrok.app` using the
    `curl` command and ngrok immediately closes the connection with a `404` status
    code.

  </Tab>
</Tabs>

## Action Result Variables

<ActionVariablesDescription />

<Note>This action does not set any variables after it has been executed.</Note>
