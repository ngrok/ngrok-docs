import ConfigExample from "../../src/components/ConfigExample.tsx";

export const type = "jwt-validation";
export const config = {
	issuer: {
		allow_list: [
			{
				value: "https://example.com/issuer",
			},
		],
	},
	audience: {
		allow_list: [
			{
				value: "urn:example:api",
			},
		],
	},
	http: {
		tokens: [
			{
				type: "access_token",
				method: "header",
				name: "Authorization",
				prefix: "Bearer ",
			},
			{
				type: "it+jwt",
				method: "body",
				name: "_id_token",
			},
		],
	},
	jws: {
		allowed_algorithms: ["RS256", "ES256"],
		keys: {
			sources: {
				additional_jkus: ["https://example.com/issuer/jku"],
			},
		},
	},
};

export const auth0_config = {
	issuer: {
		allow_list: [
			{
				value: "https://dev-tenet-id.us.auth0.com/",
			},
		],
	},
	audience: {
		allow_list: [
			{
				value: "https://dev-tenet-id.us.auth0.com/api/v2/",
			},
		],
	},
	http: {
		tokens: [
			{
				type: "jwt",
				method: "header",
				name: "Authorization",
				prefix: "Bearer ",
			},
		],
	},
	jws: {
		allowed_algorithms: ["RS256"],
		keys: {
			sources: {
				additional_jkus: [
					"https://dev-tenet-id.us.auth0.com/.well-known/jwks.json",
				],
			},
		},
	},
};

export const ExampleHTTP = () => (
	<ConfigExample config={{ actions: [{ type, config }] }} />
);

export const ExampleAuth0 = () => (
	<ConfigExample config={{ actions: [{ type, auth0_config }] }} />
);
