---
title: Domain
---

## Domain Custom Resource

### **apiVersion:** `ingress.k8s.ngrok.com/v1alpha1`

### **kind:** `Domain`

Domains define the hostnames that should be reserved for your ngrok endpoints.
They are automatically created by the controller based on the `Ingress`, `Gateway`, `CloudEndpoint` and `AgentEndpoint` custom resources you create.
Standard ngrok subdomains will automatically be created and reserved for you.
Custom domains will also be created and reserved, but will be up to you to configure the DNS records for them.
See the [custom domain](/k8s/guides/custom-domain) guide for more details.

If you delete all the `Ingress`/`Gateway`/`CloudEndpoint`/`AgentEndpoint` objects for a particular host, as a safety precaution, the Operator does _NOT_ delete the domains and thus does not unregister them.
This ensures you don't lose domains while modifying or recreating ingress objects.
You can still manually delete a domain CRD via `kubectl delete domain <name>` if you want to unregister it.

## Domain Structure and Types

The following outlines the high level structure and typings of a `Domain`

```yaml
apiVersion: ingress.k8s.ngrok.com/v1alpha1
kind: Domain
metadata:
  name: <string>
  namespace: <string>
spec:
  description: <string>       # optional, default: "Created by the ngrok-operator"
  metadata: <string>          # optional, default: "{"owned-by":"ngrok-operator"}"
  domain: <string>            # required
  region: <string>            # required
```

## Domain Fields

The following sections outline each field of the `Domain` custom resource, whether they are required, what their default values are (if applicable), and a description of their purpose/constraints.

### `spec`

`spec` defines the desired state of the `Domain`

**Type:** `Object`

**Required:** yes

**Default:** none

**Fields:**

| Field Name                             | Type            | Required | Default                           | Description                                                                    |
| -------------------------------------- | --------------- | -------- | --------------------------------- | ------------------------------------------------------------------------------ |
| [`spec.description`](#specdescription) | `string`        | no       | `"Created by the ngrok-operator"` | Human-readable description for this `Domain` to help identify/describe it      |
| [`spec.metadata`](#specmetadata)       | `string`        | no       | `"{"owned-by":"ngrok-operator"}"` | String of arbitrary data associated with the object in the ngrok API/Dashboard |
| [`spec.domain`](#specdomain)           | `string`        | yes      | none                              | The domain name to reserve                                                     |
| [`spec.region`](#specregion)           | `string` (enum) | no       | none                              | (Deprecated) The region in which to reserve the domain                         |

### `spec.description`

Human-readable description of this domain that can be used to help identify/describe it.

**Type:** `string`

**Required:** no

**Default:** `"Created by the ngrok-operator"`

### `spec.metadata`

String of arbitrary data associated with the object in the ngrok API/Dashboard.

**Type:** `string`

**Required:** no

**Default:** `"{"owned-by":"ngrok-operator"}"`

### `spec.domain`

The domain name to reserve. example: `example-domain.ngrok.io`

**Type:** `string`

**Required:** no

**Default:** none

### `spec.region`

The region in which to reserve domains

With the launch of the ngrok Global Network domains traffic is now handled globally.
Note that agents may still connect to specific regions.

**Warning:** `spec.region` is deprecated

**Type:** `string (enum)`

**Required:** no

**Default:** `"global"`

**Allowed Values:** `"au"`, `"eu"`, `"ap"`, `"us"`, `"jp"`, `"in"`, `"sa"`, `"global"`

## Example Domain

```yaml
apiVersion: ingress.k8s.ngrok.com/v1alpha1
kind: Domain
metadata:
  name: example-domain
  namespace: default
spec:
  description: Created by kubernetes-ingress-controller
  domain: example-domain.ngrok.io
  metadata: '{"owned-by":"kubernetes-gateway-api"}'
```


## Status

The `status` field contains the current state of the `Domain` as reported by the ngrok operator.

**Type:** `Object`

**Fields:**

| Field Name                                    | Type              | Description                                                                                                                              |
| --------------------------------------------- | ----------------- | ---------------------------------------------------------------------------------------------------------------------------------------- |
| [`status.id`](#statusid)                     | `string`          | ID is the unique identifier of the domain                                                                                                |
| [`status.domain`](#statusdomain)             | `string`          | Domain is the domain that was reserved                                                                                                   |
| [`status.region`](#statusregion)             | `string`          | Region is the region in which the domain was created                                                                                     |
| [`status.cnameTarget`](#statuscnametarget)   | `string`          | CNAMETarget is the CNAME target for the domain                                                                                           |
| ðŸš§ [`status.acmeChallengeCnameTarget`](#statusacmechallengecnametarget) | `string` | TODO: ACMEChallengeCNAMETarget is the CNAME target for ACME challenge (wildcards only)                                                         |
| ðŸš§ [`status.certificate`](#statuscertificate)   | `Object`          | TODO: Certificate contains information about the TLS certificate                                                                               |
| ðŸš§ [`status.certificateManagementPolicy`](#statuscertificatemanagementpolicy) | `Object` | TODO: CertificateManagementPolicy contains the certificate management configuration                                                             |
| ðŸš§ [`status.certificateManagementStatus`](#statuscertificatemanagementstatus) | `Object` | TODO: CertificateManagementStatus contains the certificate management status                                                                   |
| ðŸš§ [`status.conditions`](#statusconditions)     | `[]Object`        | TODO: Conditions represent the latest available observations of the domain's state                                                             |

### `status.id`

ID is the unique identifier of the domain.

**Type:** `string`

### `status.domain`

Domain is the domain that was reserved.

**Type:** `string`

### `status.region`

Region is the region in which the domain was created.

**Type:** `string`

### `status.cnameTarget`

CNAMETarget is the CNAME target for the domain.

**Type:** `string`

### ðŸš§ `status.acmeChallengeCnameTarget`

ðŸš§ **TODO:** ACMEChallengeCNAMETarget is the CNAME target for ACME challenge (wildcards only).

**Type:** `string`

### ðŸš§ `status.certificate`

ðŸš§ **TODO:** Certificate contains information about the TLS certificate.

**Type:** `Object`

**Fields:**

| Field Name                                              | Type     | Required | Default | Description                        |
| ------------------------------------------------------- | -------- | -------- | ------- | ---------------------------------- |
| [`status.certificate.id`](#statuscertificateid)        | `string` | yes      | none    | ID is the certificate ID           |

### `status.certificate.id`

ID is the certificate ID.

**Type:** `string`

### ðŸš§ `status.certificateManagementPolicy`

ðŸš§ **TODO:** CertificateManagementPolicy contains the certificate management configuration.

**Type:** `Object`

**Fields:**

| Field Name                                                              | Type     | Required | Default | Description                                                                 |
| ----------------------------------------------------------------------- | -------- | -------- | ------- | --------------------------------------------------------------------------- |
| [`status.certificateManagementPolicy.authority`](#statuscertificatemanagementpolicyauthority) | `string` | yes      | none    | Authority is the certificate authority (e.g., "letsencrypt")               |
| [`status.certificateManagementPolicy.privateKeyType`](#statuscertificatemanagementpolicyprivatekeytype) | `string` | yes      | none    | PrivateKeyType is the private key type (e.g., "ecdsa")                     |

### `status.certificateManagementPolicy.authority`

Authority is the certificate authority (e.g., "letsencrypt").

**Type:** `string`

### `status.certificateManagementPolicy.privateKeyType`

PrivateKeyType is the private key type (e.g., "ecdsa").

**Type:** `string`

### ðŸš§ `status.certificateManagementStatus`

ðŸš§ **TODO:** CertificateManagementStatus contains the certificate management status.

**Type:** `Object`

**Fields:**

| Field Name                                                                        | Type     | Required | Default | Description                                                                 |
| --------------------------------------------------------------------------------- | -------- | -------- | ------- | --------------------------------------------------------------------------- |
| [`status.certificateManagementStatus.provisioningJob`](#statuscertificatemanagementstatusprovisioningjob) | `Object` | no       | none    | ProvisioningJob contains information about the current provisioning job     |
| [`status.certificateManagementStatus.renewsAt`](#statuscertificatemanagementstatusrenewsat) | `string` | no       | none    | RenewsAt is when the certificate will be renewed                            |

### `status.certificateManagementStatus.provisioningJob`

ProvisioningJob contains information about the current provisioning job.

**Type:** `Object`

**Fields:**

| Field Name                                                                                    | Type     | Required | Default | Description                                                                 |
| --------------------------------------------------------------------------------------------- | -------- | -------- | ------- | --------------------------------------------------------------------------- |
| [`status.certificateManagementStatus.provisioningJob.errorCode`](#statuscertificatemanagementstatusprovisioningjoberrorcode) | `string` | no       | none    | ErrorCode contains the error code if the provisioning job failed            |
| [`status.certificateManagementStatus.provisioningJob.message`](#statuscertificatemanagementstatusprovisioningjobmessage) | `string` | no       | none    | Message contains additional information about the provisioning job status    |
| [`status.certificateManagementStatus.provisioningJob.retriesAt`](#statuscertificatemanagementstatusprovisioningjobretriesat) | `string` | no       | none    | RetriesAt indicates when the provisioning job will be retried               |
| [`status.certificateManagementStatus.provisioningJob.startedAt`](#statuscertificatemanagementstatusprovisioningjobstartedat) | `string` | no       | none    | StartedAt indicates when the provisioning job was started                   |

### `status.certificateManagementStatus.provisioningJob.errorCode`

ErrorCode contains the error code if the provisioning job failed.

**Type:** `string`

### `status.certificateManagementStatus.provisioningJob.message`

Message contains additional information about the provisioning job status.

**Type:** `string`

### `status.certificateManagementStatus.provisioningJob.retriesAt`

RetriesAt indicates when the provisioning job will be retried.

**Type:** `string`

### `status.certificateManagementStatus.provisioningJob.startedAt`

StartedAt indicates when the provisioning job was started.

**Type:** `string`

### `status.certificateManagementStatus.renewsAt`

RenewsAt is when the certificate will be renewed.

**Type:** `string`

### ðŸš§ `status.conditions`

ðŸš§ **TODO:** Conditions represent the latest available observations of the domain's state. The ngrok operator uses several condition types to track the domain lifecycle and provide detailed status information.

**Type:** `[]Object`

#### Condition Types

The ngrok operator sets the following condition types on Domain resources:

| Condition Type | Description |
| -------------- | ----------- |
| `Ready` | Overall domain readiness status |
| `DomainCreated` | Whether the domain was successfully reserved |
| `CertificateReady` | Whether the TLS certificate is provisioned and ready |
| `DNSConfigured` | Whether DNS records are properly configured |
| `Progressing` | Whether the domain is currently being provisioned |

#### Common Condition Reasons

| Reason | Description |
| ------ | ----------- |
| `DomainActive` | Domain is ready for use |
| `DomainCreated` | Domain was successfully reserved |
| `DomainInvalid` | Domain could not be reserved |
| `CertificateProvisioning` | Certificate is being provisioned |
| `CertificateReady` | Certificate is ready |
| `DNSError` | DNS configuration error |
| `ACMEChallengeRequired` | ACME challenge required for certificate |
| `NgrokManaged` | Domain is managed by ngrok (no custom configuration needed) |
| `ProvisioningError` | Error during provisioning process |
| `WaitingForCertificate` | Waiting for certificate to be provisioned |
| `DanglingDNSRecord` | DNS record points to wrong target |
| `ProtectedDomain` | Domain is protected and cannot be reserved |
| `DomainCreationFailed` | Domain creation failed |
| `Provisioning` | Domain is currently being provisioned |

## Status Examples

### Successful Domain

A domain that is fully provisioned and ready for use:

```yaml
status:
  id: rd_32tfTSf5Dcrb0gBev3UZdFUTghd
  domain: test-status-fields.ngrok.app
  cnameTarget: 5k3g9n6fdl1pxswyp.3kg7imcniwfgy1ozt.ngrok-cname.com
  conditions:
  - lastTransitionTime: "2025-09-22T15:17:32Z"
    message: Domain successfully reserved
    observedGeneration: 1
    reason: DomainCreated
    status: "True"
    type: DomainCreated
  - lastTransitionTime: "2025-09-22T15:17:32Z"
    message: Certificate managed by ngrok
    observedGeneration: 1
    reason: NgrokManaged
    status: "True"
    type: CertificateReady
  - lastTransitionTime: "2025-09-22T15:17:32Z"
    message: DNS managed by ngrok
    observedGeneration: 1
    reason: NgrokManaged
    status: "True"
    type: DNSConfigured
  - lastTransitionTime: "2025-09-22T15:17:32Z"
    message: Domain ready for use
    observedGeneration: 1
    reason: DomainActive
    status: "True"
    type: Ready
```

### Domain with DNS Configuration Issues

A custom domain that has DNS configuration problems:

```yaml
status:
  id: rd_32tfSAYyVlzSTmsdm3vMlXCbceI
  domain: test-bad-dns.alexbezek.me
  cnameTarget: 5k3g9n6fdl1pxswyp.3kg7imcniwfgy1ozt.ngrok-cname.com
  certificateManagementPolicy:
    authority: letsencrypt
    privateKeyType: ecdsa
  certificateManagementStatus:
    provisioningJob:
      errorCode: DNS_ERROR
      message: Reserved domain "test-bad-dns.alexbezek.me" CNAME DNS record is not pointing at 5k3g9n6fdl1pxswyp.3kg7imcniwfgy1ozt.ngrok-cname.com.
      retriesAt: "2025-09-22T15:17:59Z"
      startedAt: "2025-09-19T01:19:46Z"
  conditions:
  - lastTransitionTime: "2025-09-22T15:17:38Z"
    message: Domain successfully reserved
    observedGeneration: 1
    reason: DomainCreated
    status: "True"
    type: DomainCreated
  - lastTransitionTime: "2025-09-22T15:17:38Z"
    message: DNS_ERROR Reserved domain "test-bad-dns.alexbezek.me" CNAME DNS record is not pointing at 5k3g9n6fdl1pxswyp.3kg7imcniwfgy1ozt.ngrok-cname.com. Started at 2025-09-19T01:19:46Z Retries at 2025-09-22T15:17:59Z
    observedGeneration: 1
    reason: ProvisioningError
    status: "False"
    type: CertificateReady
  - lastTransitionTime: "2025-09-22T15:17:38Z"
    message: DNS_ERROR Reserved domain "test-bad-dns.alexbezek.me" CNAME DNS record is not pointing at 5k3g9n6fdl1pxswyp.3kg7imcniwfgy1ozt.ngrok-cname.com. Started at 2025-09-19T01:19:46Z Retries at 2025-09-22T15:17:59Z
    observedGeneration: 1
    reason: ProvisioningError
    status: "False"
    type: DNSConfigured
  - lastTransitionTime: "2025-09-22T15:17:38Z"
    message: DNS_ERROR Reserved domain "test-bad-dns.alexbezek.me" CNAME DNS record is not pointing at 5k3g9n6fdl1pxswyp.3kg7imcniwfgy1ozt.ngrok-cname.com. Started at 2025-09-19T01:19:46Z Retries at 2025-09-22T15:17:59Z
    observedGeneration: 1
    reason: ProvisioningError
    status: "False"
    type: Ready
  - lastTransitionTime: "2025-09-22T15:17:38Z"
    message: DNS_ERROR Reserved domain "test-bad-dns.alexbezek.me" CNAME DNS record is not pointing at 5k3g9n6fdl1pxswyp.3kg7imcniwfgy1ozt.ngrok-cname.com. Started at 2025-09-19T01:19:46Z Retries at 2025-09-22T15:17:59Z
    observedGeneration: 1
    reason: Provisioning
    status: "True"
    type: Progressing
```

### Domain Creation Failed

A domain that failed to be created (e.g., already reserved by another account):

```yaml
status:
  conditions:
  - lastTransitionTime: "2025-09-22T15:17:32Z"
    message: HTTP 400: This domain is already reserved for another account. Failed to reserve 'docs.ngrok.app'. [ERR_NGROK_414] Operation ID: op_333nNDGmAT2IIWUbIckWDGwPoci
    observedGeneration: 1
    reason: DomainCreationFailed
    status: "False"
    type: DomainCreated
  - lastTransitionTime: "2025-09-22T15:17:32Z"
    message: Domain creation failed
    observedGeneration: 1
    reason: DomainCreationFailed
    status: "False"
    type: CertificateReady
  - lastTransitionTime: "2025-09-22T15:17:32Z"
    message: Domain creation failed
    observedGeneration: 1
    reason: DomainCreationFailed
    status: "False"
    type: DNSConfigured
  - lastTransitionTime: "2025-09-22T15:17:32Z"
    message: HTTP 400: This domain is already reserved for another account. Failed to reserve 'docs.ngrok.app'. [ERR_NGROK_414] Operation ID: op_333nNDGmAT2IIWUbIckWDGwPoci
    observedGeneration: 1
    reason: DomainCreationFailed
    status: "False"
    type: Ready
```
