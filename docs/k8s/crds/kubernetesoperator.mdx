---
title: KubernetesOperator
---

## KubernetesOperator Custom Resource

### **apiVersion:** `ngrok.k8s.ngrok.com/v1alpha1`

### **kind:** `KubernetesOperator`

The `KubernetesOperator` custom resource handles synchronizing the state of your ngrok Kubernetes operator instance with the ngrok API.
A `KubernetesOperator` resource is created automatically when you install the ngrok operator with Helm and has configuration that matches your installation options
from Helm so that you can identify it in the ngrok cloud.

## KubernetesOperator Structure and Types

The following outlines the high level structure and typings of a `KubernetesOperator`

```yaml
apiVersion: ngrok.k8s.ngrok.com/v1alpha1
kind: KubernetesOperator
metadata:
  name: <string>
  namespace: <string>
spec:
  description: <string>           # optional, default: "Created by the ngrok-operator"
  metadata: <string>              # optional, default: "{"owned-by":"ngrok-operator"}"
  enabledFeatures: <[]string>     # optional
  region: <string>                # required, default: "global"
  deployment:                     # optional
    name: <string>                # required
    namespace: <string>           # required
    version: <string>             # required
  binding:                        # optional
    endpointSelectors: <[]string> # required
    ingressEndpoint: <string>     # optional
    tlsSecretName: <string>       # required, default: "default-tls"
```

## KubernetesOperator Fields

The following sections outline each field of the `KubernetesOperator` custom resource, whether they are required, what their default values are (if applicable), and a description of their purpose/constraints.

### `spec`

`spec` defines the desired state of the `KubernetesOperator`

**Type:** `Object`

**Required:** yes

**Default:** none

**Fields:**

| Field Name                                     | Type              | Required | Default                           | Description                                                                              |
| ---------------------------------------------- | ----------------- | -------- | --------------------------------- | ---------------------------------------------------------------------------------------- |
| [`spec.description`](#specdescription)         | `string`          | no       | `"Created by the ngrok-operator"` | Human-readable description for this `KubernetesOperator` to help identify/describe it    |
| [`spec.metadata`](#specmetadata)               | `string`          | no       | `"{"owned-by":"ngrok-operator"}"` | String of arbitrary data associated with the object in the ngrok API/Dashboard           |
| [`spec.enabledFeatures`](#specenabledfeatures) | `[]string` (enum) | no       | none                              | List of the features that are enabled for this instance of the ngrok Kubernetes operator |
| [`spec.region`](#specregion)                   | `string`          | yes      | `"global"`                        | The ngrok region in which the ingress for this operator is served                        |
| [`spec.deployment`](#specdeployment)           | `Object`          | no       | none                              | Deployment information for this instance of the ngrok Kubernetes Operator                |
| [`spec.binding`](#specbinding)                 | `Object`          | no       | none                              | Configuration of the binding feature for this instance of the ngrok Kubernetes Operator  |

### `spec.description`

Human-readable description of this object that can be used to help identify/describe it.

**Type:** `string`

**Required:** no

**Default:** `"Created by the ngrok-operator"`

### `spec.metadata`

String of arbitrary data associated with the object in the ngrok API/Dashboard.

**Type:** `string`

**Required:** no

**Default:** `"{"owned-by":"ngrok-operator"}"`

### `spec.enabledFeatures`

List of the features that are enabled for this instance of the ngrok Kubernetes operator

**Type:** `[]string`

**Required:** no

**Default:** none

**Allowed Values:** `"ingress"`, `"gateway"`, `"bindings"`

### `spec.region`

The ngrok region in which the ingress for this operator is served.

**Type:** `string (enum)`

**Required:** no

**Default:** `"global"`

**Allowed Values:** `"au"`, `"eu"`, `"ap"`, `"us"`, `"jp"`, `"in"`, `"sa"`, `"global"`

### `spec.deployment`

Deployment information for this instance of the ngrok Kubernetes Operator.

**Type:** `Object`

**Required:** no

**Default:** none

**Fields:**

| Field Name                                              | Type     | Required | Default | Description                                                                                    |
| ------------------------------------------------------- | -------- | -------- | ------- | ---------------------------------------------------------------------------------------------- |
| [`spec.deployment.name`](#specdeploymentname)           | `string` | yes      | none    | The name of the Kubernetes `Deployment` for this intance of the ngrok Kubernetes operator      |
| [`spec.deployment.namespace`](#specdeploymentnamespace) | `string` | yes      | none    | The namespace of the Kubernetes `Deployment` for this intance of the ngrok Kubernetes operator |
| [`spec.deployment.version`](#specdeploymentversion)     | `string` | yes      | none    | The version of the Kubernetes `Deployment` for this intance of the ngrok Kubernetes operator   |

### `spec.deployment.name`

The name of the Kubernetes `Deployment` for this intance of the ngrok Kubernetes operator

**Type:** `string`

**Required:** yes

**Default:** none

### `spec.deployment.namespace`

The namespace of the Kubernetes `Deployment` for this intance of the ngrok Kubernetes operator

**Type:** `string`

**Required:** yes

**Default:** none

### `spec.deployment.version`

The version of the Kubernetes `Deployment` for this intance of the ngrok Kubernetes operator

**Type:** `string`

**Required:** yes

**Default:** none

### `spec.binding`

Configuration of the binding feature for this intance of the ngrok Kubernetes Operator

**Type:** `Object`

**Required:** no

**Default:** none

**Fields:**

| Field Name                                                        | Type       | Required | Default | Description                                                                                                          |
| ----------------------------------------------------------------- | ---------- | -------- | ------- | -------------------------------------------------------------------------------------------------------------------- |
| [`spec.binding.endpointSelectors`](#specbindingendpointselectors) | `[]string` | yes      | none    | List of CEL expressions that determine which kubernetes-bound Endpoints will be created by the operator              |
| [`spec.binding.ingressEndpoint`](#specbindingingressendpoint)     | `string`   | no       | none    | The public ingress endpoint for this Kubernetes Operator                                                             |
| [`spec.binding.tlsSecretName`](#specbindingtlssecretname)         | `string`   | yes      | none    | The name of the Kubernetes Secret that contains the TLS private/public keys to use for the ngrok forwarding endpoint |

### `spec.binding.endpointSelectors`

List of cel expression that determine which kubernetes-bound Endpoints will be created by the operator

**Type:** `[]string`

**Required:** yes

**Default:** none

### `spec.binding.ingressEndpoint`

The public ingress endpoint for this Kubernetes Operator

**Type:** `string`

**Required:** no

**Default:** none

### `spec.binding.tlsSecretName`

The name of the Kubernetes Secret that contains the TLS private/public keys to use for the ngrok forwarding endpoint

**Type:** `string`

**Required:** yes

**Default:** `"default-tls"`

## Example KubernetesOperator

```yaml
apiVersion: ngrok.k8s.ngrok.com/v1alpha1
kind: KubernetesOperator
metadata:
  name: ngrok-operator
  namespace: ngrok-operator
spec:
  description: Created by ngrok-operator
  metadata: '{"owned-by":"ngrok-operator"}'
  binding:
    endpointSelectors:
    - "true"
    ingressEndpoint: kubernetes-binding-ingress.ngrok.io:443
    tlsSecretName: ngrok-operator-default-tls
  deployment:
    name: ngrok-operator
    namespace: ngrok-operator
    version: 0.15.0
  enabledFeatures:
  - ingress
  - gateway
  - bindings
  region: global
```

## Status

The `status` field contains the current state of the `KubernetesOperator` as reported by the ngrok operator.

**Type:** `Object`

**Fields:**

| Field Name                                                         | Type       | Description                                                                                                                             |
| ------------------------------------------------------------------ | ---------- | --------------------------------------------------------------------------------------------------------------------------------------- |
| [`status.id`](#statusid)                                           | `string`   | ID is the unique identifier for this Kubernetes Operator                                                                                |
| [`status.uri`](#statusuri)                                         | `string`   | URI is the URI for this Kubernetes Operator                                                                                             |
| [`status.registrationStatus`](#statusregistrationstatus)           | `string`   | RegistrationStatus is the status of the registration of this Kubernetes Operator with the ngrok API                                     |
| [`status.enabledFeatures`](#statusenabledfeatures)                 | `string`   | EnabledFeatures is the string representation of the features enabled for this Kubernetes Operator                                       |
| [`status.bindingsIngressEndpoint`](#statusbindingsingressendpoint) | `string`   | BindingsIngressEndpoint is the URL that the operator will use to talk to the ngrok edge when forwarding traffic for k8s-bound endpoints |
| [`status.registrationErrorCode`](#statusregistrationerrorcode)     | `string`   | RegistrationErrorCode is the returned ngrok error code                                                                                  |
| [`status.errorMessage`](#statuserrormessage)                       | `string`   | RegistrationErrorMessage is a free-form error message if the status is error                                                            |
| 🚧 [`status.conditions`](#statusconditions)                        | `[]Object` | TODO: Conditions describe the current conditions of the KubernetesOperator                                                              |

### `status.id`

ID is the unique identifier for this Kubernetes Operator.

**Type:** `string`

### `status.uri`

URI is the URI for this Kubernetes Operator.

**Type:** `string`

### `status.registrationStatus`

RegistrationStatus is the status of the registration of this Kubernetes Operator with the ngrok API.

**Type:** `string`

### `status.enabledFeatures`

EnabledFeatures is the string representation of the features enabled for this Kubernetes Operator.

**Type:** `string`

### `status.bindingsIngressEndpoint`

BindingsIngressEndpoint is the URL that the operator will use to talk to the ngrok edge when forwarding traffic for k8s-bound endpoints.

**Type:** `string`

### `status.registrationErrorCode`

RegistrationErrorCode is the returned ngrok error code.

**Type:** `string`

### `status.errorMessage`

RegistrationErrorMessage is a free-form error message if the status is error.

**Type:** `string`

### 🚧 `status.conditions`

🚧 **TODO:** Conditions describe the current conditions of the KubernetesOperator.

**Type:** `[]Object`

## Conditions

🚧 **TODO:** The ngrok operator will use several condition types to track the KubernetesOperator lifecycle and provide detailed status information.

**Type:** `[]Object`

### 🚧 Condition Types

The ngrok operator will set the following condition types on KubernetesOperator resources:

| Condition Type    | Description                                                        |
| ----------------- | ------------------------------------------------------------------ |
| `Ready`           | Overall operator readiness status                                  |
| `Registered`      | Whether the operator is successfully registered with the ngrok API |
| `FeaturesEnabled` | Whether the requested features are enabled                         |

### 🚧 Common Condition Reasons

| Reason                   | Description                                     |
| ------------------------ | ----------------------------------------------- |
| `OperatorActive`         | Operator is ready and registered                |
| `RegistrationSuccessful` | Operator successfully registered with ngrok API |
| `FeaturesEnabled`        | All requested features are enabled              |
| `RegistrationFailed`     | Failed to register with ngrok API               |
| `InvalidAPIKey`          | Invalid API key provided                        |
| `NetworkError`           | Network error during registration               |

## Status Examples

### Successful KubernetesOperator

A KubernetesOperator that is successfully registered with the ngrok API:

```yaml
status:
  bindingsIngressEndpoint: connect.ngrok-endpoints.com:443
  enabledFeatures: ingress
  id: k8sop_32ngBNbyUJuizmW7nougUjFIPRn
  registrationStatus: registered
  uri: https://api.ngrok.com/kubernetes_operators/k8sop_32ngBNbyUJuizmW7nougUjFIPRn
  conditions:
  - lastTransitionTime: "2025-09-22T15:17:38Z"
    message: Operator successfully registered with ngrok API
    observedGeneration: 1
    reason: RegistrationSuccessful
    status: "True"
    type: Registered
  - lastTransitionTime: "2025-09-22T15:17:38Z"
    message: All requested features are enabled
    observedGeneration: 1
    reason: FeaturesEnabled
    status: "True"
    type: FeaturesEnabled
  - lastTransitionTime: "2025-09-22T15:17:38Z"
    message: Operator is ready and active
    observedGeneration: 1
    reason: OperatorActive
    status: "True"
    type: Ready
```

### KubernetesOperator with Registration Error

A KubernetesOperator that failed to register with the ngrok API:

```yaml
status:
  registrationStatus: error
  registrationErrorCode: ERR_NGROK_401
  errorMessage: Invalid API key provided
  enabledFeatures: ""
  conditions:
  - lastTransitionTime: "2025-09-22T15:17:32Z"
    message: "Failed to register with ngrok API: Invalid API key provided"
    observedGeneration: 1
    reason: RegistrationFailed
    status: "False"
    type: Registered
  - lastTransitionTime: "2025-09-22T15:17:32Z"
    message: Features cannot be enabled due to registration failure
    observedGeneration: 1
    reason: RegistrationFailed
    status: "False"
    type: FeaturesEnabled
  - lastTransitionTime: "2025-09-22T15:17:32Z"
    message: Operator registration failed
    observedGeneration: 1
    reason: RegistrationFailed
    status: "False"
    type: Ready
```
