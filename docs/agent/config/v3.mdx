---
title: "ngrok Agent Configuration File Version 3"
---

import AgentConfigurations from "./_agent-configurations.mdx";

## Breaking Changes

The `agent:` key is now **required** in the v3 configuration file as a parent field, and [agent specific fields](/docs/agent/config/v3/#agent-configuration) are nested underneath.

```yaml
# example
agent:
  connect_url: connect.ngrok-agent.com:443
  authtoken: // your authtoken here
  # ...
```

_For a complete list of fields, checkout [agent configuration](/docs/agent/config/v3/#agent-configuration)._

## Full Example

Below is an example configuration file with all the options filled in.
To activate a specific option or endpoint, simply uncomment the relevant lines by removing the `#` at the beginning of the line.

```yaml
# ngrok Agent Configuration File v3
# https://ngrok.com/docs/agent/config/

# ######################################################################
# # Agent Configuration                                                #
# ######################################################################

# ----------------------------------------------------------------------
# | Version  (required)                                                |
# ----------------------------------------------------------------------

# Specifies the version of the config file to use. Valid options are 2 or 3.

version: 3

# ----------------------------------------------------------------------
# | Agent (authtoken, connect_url) (required)                          |
# ----------------------------------------------------------------------

# Specifies the authentication token (authtoken) and the url (connect_url) used to communicate to the
# ngrok service.
#
#  (1) You can get your default authtoken through the dashboard:
#      https://dashboard.ngrok.com/get-started/your-authtoken
#
#  (2) You can view and generate authtokens through the dashboard
#      https://dashboard.ngrok.com/tunnels/authtokens

agent:
  connect_url: connect.ngrok-agent.com:443
  authtoken: // your authtoken here

# ----------------------------------------------------------------------
# | API Key                                                            |
# ----------------------------------------------------------------------

# The ngrok API key used to connect to the ngrok API.
#
#  (!) This is only needed when using the ngrok api command and should
#      not be confused with the authtoken.
#
#  (1) You can obtain and manage your API Keys through the dashboard:
#      https://dashboard.ngrok.com/api-keys

# api_key: 24yRd5U3DestCQapJrrVHLOqiAC_7RviwRqpd3wc9dKLujQZN

# ----------------------------------------------------------------------
# | Connect Timeout                                                    |
# ----------------------------------------------------------------------

# How long to wait when establishing an agent session connection to the
# ngrok service.
#
# Accepts duration, the default is 10s

# connect_timeout: 10s

# ----------------------------------------------------------------------
# | Console UI                                                         |
# ----------------------------------------------------------------------

# Enable or disable the console UI in the terminal.
#
# Options:
#   true   - Enable the console UI.
#   false  - Disable the console UI, use structured log format.
#   iftty  - (Default) Enable UI only if standard out is a TTY.

# console_ui: iftty

# ----------------------------------------------------------------------
# | Console UI Color                                                   |
# ----------------------------------------------------------------------

# Sets the console UI background color in the terminal.
#
# To use a color other than black, set to `transparent` and adjust your
# terminal's background.

# console_ui_color: transparent

# ----------------------------------------------------------------------
# | CRL No Verify                                                      |
# ----------------------------------------------------------------------

# Skip Certificate Revocation List (CRL) verification if set to true.
#
# Accepts a boolean. Default is `false`.

# crl_noverify: false

# ----------------------------------------------------------------------
# | DNS Resolver IPs                                                   |
# ----------------------------------------------------------------------

# List of DNS servers for resolving tunnel session DNS.
#
# Defaults to using the local system DNS servers.

# dns_resolver_ips:
#   - 1.1.1.1
#   - 8.8.8.8

# ----------------------------------------------------------------------
# | Heartbeat Interval                                                 |
# ----------------------------------------------------------------------

# How often the ngrok agent should heartbeat to the ngrok servers defined
# as a duration.
#
# Accepts a duration (e.g., 10s, 1m). The default value is `10s`.

# heartbeat_interval: 10s

# ----------------------------------------------------------------------
# | Heartbeat Tolerance                                                |
# ----------------------------------------------------------------------

# This setting defines the maximum duration to wait for a heartbeat
# response from the server before reconnecting the agent tunnel session.
#
# Accepts a duration (e.g., 10s, 1m). The default value is `15s`.

# heartbeat_tolerance: 15s

# ----------------------------------------------------------------------
# | Inspect DB Size                                                    |
# ----------------------------------------------------------------------

# This is the upper limit in bytes on memory to allocate when saving
# requests over HTTP endpoints for inspection and reply.
#
# Accepts a numeric value. The default is `0`, equivalent to 50MB.
#
#   (!) To disable inspection for all endpoints, set the value to `-1`.

# inspect_db_size: 52428800 # 50MB

# ----------------------------------------------------------------------
# | Log Level                                                          |
# ----------------------------------------------------------------------

# Sets the log detail level. Higher verbosity with each level.
#
# Allowed values:
#    crit  - Critical issues.
#    warn  - Warnings.
#   error  - Errors.
#    info  - (Default) Informational messages.
#   debug  - Detailed debugging info.

# log_level: info

# ----------------------------------------------------------------------
# | Log Format                                                         |
# ----------------------------------------------------------------------

# Specifies the format of log records.
#
# Allowed values:
#   logfmt  - (Default) Human and machine-friendly key/value pairs.
#     json  - Newline-separated JSON objects.
#     term  - Colored format for TTY; otherwise, same as logfmt.

# log_format: json

# ----------------------------------------------------------------------
# | Log                                                                |
# ----------------------------------------------------------------------

# This is the destination where ngrok should write the logs.
#
# Allowed values:
#   stdout  - write to standard out
#   stderr  - write to standard error (default)
#    false  - disable logging
#   <path>  - write log records to file path on disk

# log: /var/log/ngrok.log

# ----------------------------------------------------------------------
# | Metadata                                                           |
# ----------------------------------------------------------------------

# Custom string included in the ngrok API response for endpoints.
#
# Maximum 4096 characters.

# metadata: '{"serial": "00012xa-33rUtz9", "comment": "For customer alan@example.com"}'

# ----------------------------------------------------------------------
# | Proxy URL                                                          |
# ----------------------------------------------------------------------

# URL of an HTTP or SOCKS5 proxy for endpoint connections.
#
#   (!) ngrok will also respect the `http_proxy`, `http_proxy_env`, and `socks5_proxy`
#       environment variables.

# proxy_url: socks5://localhost:9150

# ----------------------------------------------------------------------
# | Remote Management                                                  |
# ----------------------------------------------------------------------

# Allows remote management of the ngrok agent (stop, restart, update) via
# the ngrok API or Dashboard.
#
# Defaults to `true`.

# remote_management: false

# ----------------------------------------------------------------------
# | Root CAs                                                           |
# ----------------------------------------------------------------------

# Root certificate authorities used to validate TLS connections to the
# ngrok server.
#
# Allowed values:
#    trusted - Use only the trusted certificate root for ngrok.com.
#       host - Use the root certificates trusted by the host's OS (useful for MITM proxies with DPI).
#     <path> - Path to a PEM file with additional trusted certificate authorities.

# root_cas: trusted

# ----------------------------------------------------------------------
# | Server Address                                                     |
# ----------------------------------------------------------------------

# This is the URL of the ngrok server to connect to.
#
#   (!) You should only set this value if you are using a Custom Agent
#       Ingress URL.
#
# https://ngrok.com/docs/agent/ingress/#customize-agent-ingress-address

# server_addr: tunnel.us.ingress.example.com:443

# ----------------------------------------------------------------------
# | Update Channel                                                     |
# ----------------------------------------------------------------------

# Determines the stability of builds for updates.
#
#   (!) Use `stable` for any production deployments.
#
# Allowed values:
#     stable - (Default) Production-ready builds.
#   unstable - Nightly builds; may be unstable. Not for production.
#       beta - Beta builds; may be unstable. Not for production.

# update_channel: stable

# ----------------------------------------------------------------------
# | Update Check                                                       |
# ----------------------------------------------------------------------

# Controls whether the ngrok agent checks for updates.
#
# Defaults to true.

# update_check: false

# ----------------------------------------------------------------------
# | Web Address                                                        |
# ----------------------------------------------------------------------

# Network address to bind for the local agent web interface and API.
#
# https://ngrok.com/docs/agent/web-inspection-interface/
# https://ngrok.com/docs/agent/api/

# web_addr: localhost:4040

# ----------------------------------------------------------------------
# | Web Allow Hosts                                                    |
# ----------------------------------------------------------------------

# List of allowed Host headers for requests to the local agent web
# interface and API. The port is stripped from the Host header before
# matching.
#
# Allowed formats:
#           8.8.8.8  - Matches exact IP in Host header (e.g., 8.8.8.8).
#   1:2:3:4:5:6:7:8  - Matches exact IPv6 in Host header.
#        10.0.0.0/8  - Matches any IP within a CIDR range.
#       example.com  - Matches exact hostname.
#      .example.com  - Matches subdomains (e.g., sub.example.com).
#
# The default only allows localhost-like Hosts (localhost, 127.0.0.1,
# ::1, etc.).

# web_allow_hosts:
#   - 8.8.8.8
#   - example.com

# ######################################################################
# # Endpoints Configuration                                            #
# ######################################################################

# Define individual endpoints and their configurations.
#
# Each entry under 'endpoints' represents an endpoint that can be
# started using the 'ngrok start' command:
#   https://ngrok.com/docs/agent/cli/#ngrok-start
#
# To start all endpoints at once, use:
#   ngrok start --all
#
# List of common configuration fields:
#   https://ngrok.com/docs/agent/config/v3/#common-endpoint-configuration-properties
#
# List of HTTP configuration fields:
#   https://ngrok.com/docs/agent/config/v3/#http-configuration
#
# List of TCP configuration fields:
#   https://ngrok.com/docs/agent/config/v3/#tcp-configuration
#
# List of TLS endpoint configuration fields:
#   https://ngrok.com/docs/agent/config/v3/#tls-configuration

endpoints:

  # --------------------------------------------------------------------
  # | Basic Endpoint Example                                           |
  # --------------------------------------------------------------------

  # Endpoint configuration for a website protected by basic authentication
  # with a custom host header.
  #
  # Start with after uncommenting:
  #   ngrok start example-website

  # upstream protocol allows for nuanced protocol versions: http1, http2 (default http1)

  # - name: example-website
  #   metadata: foo123
  #   url: example-website.ngrok.app
  #   upstream:
  #     url: 8080
  #     protocol: http1

  # --------------------------------------------------------------------
  # | End-to-End TLS Endpoint                                          |
  # --------------------------------------------------------------------

  # Endpoint configuration for end-to-end TLS connections.
  #
  # Start with after uncommenting:
  #   ngrok start example-e2e-tls

  # - name: example-e2e-tls
  #   url: "tls://myapp.example.com"
  #   upstream:
  #     url: 9000

  # --------------------------------------------------------------------
  # | Endpoint with Traffic Policy                                     |
  # --------------------------------------------------------------------

  # Endpoint with a Traffic Policy.
  #
  # Start with after uncommenting:
  #   ngrok start example-traffic-policy
  #
  # More info:
  #   https://ngrok.com/docs/http/traffic-policy/
  #   https://ngrok.com/docs/tls/traffic-policy/
  #   https://ngrok.com/docs/tcp/traffic-policy/

  # - name: example-traffic-policy
  #   description: example traffic policy
  #   metadata: it's a traffic policy!
  #   url: myapp.ngrok.app
  #   traffic_policy:
  #     inbound:
  #        - actions:
  #          - type: custom-response
  #            config:
  #              status_code: 200
  #              content: hello, traffic policy!
  #              headers:
  #                content-type: text/plain
  #   upstream:
  #     url: 8080
  #     protocol: http1

  # --------------------------------------------------------------------
  # | SSH Access Endpoint                                              |
  # --------------------------------------------------------------------

  # Endpoint for SSH access.
  #
  # Start with:
  #   ngrok start example-ssh-access

  # - name: example-ssh-access
  #   url: "tcp://1.tcp.ngrok.io:12345"
  #   upstream:
  #     url: 22
  #     protocol: tcp
```

## Endpoint configurations

> **Looking for Tunnel configurations?**
>
> Tunnel configurations are still supported in the new `Version 3` configuration file format. However, they're being _deprecated_ in favor of endpoints, which provide a simpler and more powerful way of managing ingress. If you wish to see documentation on how to enable and configure tunnels, refer to the [Version 2 Tunnel Configuration](/docs/agent/config/v2#tunnel-configurations) section.

The most common use of the configuration file is to define endpoint
configurations. Defining endpoint configurations is useful because you may then
start pre-configured endpoints by name from your command line without remembering
all of the right arguments every time. You may also use this method to start as
many endpoints as you like from a single ngrok agent.

Endpoints are defined as mapping of name -> configuration under the `endpoints:`
property in your configuration file.

##### Define two endpoints named 'httpbin' and 'demo'

```yaml
endpoints:
  - name: httpbin
    url: https://alan-httpbin.ngrok.dev
  - name: demo
    url: https://demo.inconshreveable.com
```

##### Start the endpoint named 'httpbin'

```sh
ngrok start httpbin
```

Each endpoint you define is a map of configuration option names to values. The name of a configuration option is usually the same as its corresponding command line switch with hyphens.

_eg:_

- `--description` becomes `description:`
- `--url` becomes `url:`

All endpoints must define a specific `url:` that tells the agent where to send the traffic. Other properties are available and many are protocol-specific.

##### Start all endpoints defined in the configuration file

```sh
ngrok start --all
```

You can configure a single ngrok agent to start multiple endpoints to different services within a single agent session.

##### Common Endpoint Configuration Properties

|               |          |                                                                                                                                                                  |
| ------------- | -------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `url`         | required | forward traffic to this network address. This can be a _domain_ `example.ngrok.app`, an _origin_ `https://example.ngrok.app`, or a _scheme_ shorthand `https://` |
| `metadata`    | Optional | arbitrary user-defined metadata that will appear in the ngrok service API when listing endpoint sessions                                                         |
| `description` | Optional | arbitrary user-defined description about this endpoint that will appear in the ngrok service API when listing endpoint sessions                                  |

### HTTP Configuration

|                                                                                          |                                                                              |                                                                                                                                                                                                                                                                                                   |
| ---------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `circuit_breaker`                                                                        | Float                                                                        | Reject requests when 5XX responses exceed this ratio                                                                                                                                                                                                                                              |
| `compression`                                                                            | `true`, `false`                                                              | gzip compress HTTP responses from your web service                                                                                                                                                                                                                                                |
| `url`                                                                                    | Any valid domain or hostname that you have previously registered with ngrok. | The domain to request. If using a custom domain, this requires registering in the [ngrok dashboard](https://dashboard.ngrok.com/cloud-edge/domains) and setting a DNS CNAME value. When using wildcard domains you will need to surround the value with single quotes (domain: '\*.example.com'). |
| `inspect`                                                                                | `true`, `false`                                                              | enable/disable the http request inspection in the web and agent API (default: true)                                                                                                                                                                                                               |
| `ip_restriction.allow_cidrs`                                                             | Array of CIDRs                                                               | Rejects connections that do not match the given CIDRs                                                                                                                                                                                                                                             |
| `ip_restriction.deny_cidrs`                                                              | Array of CIDRs                                                               | Rejects connections that match the given CIDRs and allows all other CIDRs.                                                                                                                                                                                                                        |
| `mutual_tls_cas`                                                                         | Valid system path                                                            | The path to the TLS certificate authority to verify client certs in mutual TLS                                                                                                                                                                                                                    |
| `oauth.allow_domains`                                                                    | Array of Strings                                                             | Allow only OAuth2 users with these email domains                                                                                                                                                                                                                                                  |
| `oauth.allow_emails`                                                                     | Array of Strings                                                             | Allow only OAuth users with these emails                                                                                                                                                                                                                                                          |
| `oauth.oauth_scopes`                                                                     | Array of Strings                                                             | Request these OAuth2 scopes when a user authenticates                                                                                                                                                                                                                                             |
| `oauth.provider`                                                                         | String                                                                       | enforce authentication OAuth2 provider on the endpoint, e.g. 'google'. For a lit of available providers, see [OAuth2 providers](/http/oauth/#supported-providers).                                                                                                                                |
| [`policy.inbound.name`](/docs/http/traffic-policy/index.mdx)                             | String                                                                       | `policy` has been renamed to `traffic_policy` in agent version 3.14.0.                                                                                                                                                                                                                            |
| [`policy.inbound.expressions`](/docs/http/traffic-policy/expressions/index.mdx)          | Array of Strings                                                             | `policy` has been renamed to `traffic_policy` in agent version 3.14.0.                                                                                                                                                                                                                            |
| [`policy.inbound.actions.type`](/docs/http/traffic-policy/actions/index.mdx)             | String                                                                       | `policy` has been renamed to `traffic_policy` in agent version 3.14.0.                                                                                                                                                                                                                            |
| [`policy.inbound.actions.config`](/docs/http/traffic-policy/actions/index.mdx)           | custom                                                                       | `policy` has been renamed to `traffic_policy` in agent version 3.14.0.                                                                                                                                                                                                                            |
| [`policy.outbound.name`](/docs/http/traffic-policy/index.mdx)                            | String                                                                       | `policy` has been renamed to `traffic_policy` in agent version 3.14.0.                                                                                                                                                                                                                            |
| [`policy.outbound.expressions`](/docs/http/traffic-policy/expressions/index.mdx)         | Array of Strings                                                             | `policy` has been renamed to `traffic_policy` in agent version 3.14.0.                                                                                                                                                                                                                            |
| [`policy.outbound.actions.type`](/docs/http/traffic-policy/actions/index.mdx)            | String                                                                       | `policy` has been renamed to `traffic_policy` in agent version 3.14.0.                                                                                                                                                                                                                            |
| [`policy.outbound.actions.config`](/docs/http/traffic-policy/actions/index.mdx)          | custom                                                                       | `policy` has been renamed to `traffic_policy` in agent version 3.14.0.                                                                                                                                                                                                                            |
| `proto`                                                                                  | `http`                                                                       | The endpoint protocol name. This defines the type of endpoint you would like to start.                                                                                                                                                                                                            |
| `proxy_proto`                                                                            | String                                                                       | The version of [PROXY protocol](https://www.haproxy.org/download/1.8/doc/proxy-protocol.txt) to use with this endpoint, empty if not using. Example values are 1 or 2.                                                                                                                            |
| `request_header.add`                                                                     | Array of `key:value` Strings                                                 | The headers to add to the request in the key:value format.                                                                                                                                                                                                                                        |
| `request_header.remove`                                                                  | Array of Strings                                                             | The header keys to remove from the request.                                                                                                                                                                                                                                                       |
| `response_header.add`                                                                    | Array of Strings                                                             | The headers to add to the response in the key:value format.                                                                                                                                                                                                                                       |
| `response_header.remove`                                                                 | Array of Strings                                                             | The header keys to remove from the response.                                                                                                                                                                                                                                                      |
| [`traffic_policy.inbound.name`](/docs/http/traffic-policy/index.mdx)                     | String                                                                       | The name of an inbound rule that is part of a traffic policy                                                                                                                                                                                                                                      |
| [`traffic_policy.inbound.expressions`](/docs/http/traffic-policy/expressions/index.mdx)  | Array of Strings                                                             | Expressions written using [CEL](https://github.com/google/cel-spec) that filter traffic the inbound policy rule applies to                                                                                                                                                                        |
| [`traffic_policy.inbound.actions.type`](/docs/http/traffic-policy/actions/index.mdx)     | String                                                                       | The type of action that should be executed when this inbound policy rule is activated                                                                                                                                                                                                             |
| [`traffic_policy.inbound.actions.config`](/docs/http/traffic-policy/actions/index.mdx)   | custom                                                                       | The configuration required for the specific type of action specified                                                                                                                                                                                                                              |
| [`traffic_policy.outbound.name`](/docs/http/traffic-policy/index.mdx)                    | String                                                                       | The name of an outbound rule that is part of a traffic policy                                                                                                                                                                                                                                     |
| [`traffic_policy.outbound.expressions`](/docs/http/traffic-policy/expressions/index.mdx) | Array of Strings                                                             | Expressions written using [CEL](https://github.com/google/cel-spec) that filter traffic the outbound policy rule applies to                                                                                                                                                                       |
| [`traffic_policy.outbound.actions.type`](/docs/http/traffic-policy/actions/index.mdx)    | String                                                                       | The type of action that should be executed when this outbound policy rule is activated                                                                                                                                                                                                            |
| [`traffic_policy.outbound.actions.config`](/docs/http/traffic-policy/actions/index.mdx)  | custom                                                                       | The configuration required for the specific type of action specified                                                                                                                                                                                                                              |
| `user_agent_filter.allow`                                                                | Array of Strings                                                             | Allows User-Agents that match against these RE2 Regular Expressions                                                                                                                                                                                                                               |
| `user_agent_filter.deny`                                                                 | Array of Strings                                                             | Denies User-Agents that match against these RE2 Regular Expressions                                                                                                                                                                                                                               |
| `verify_webhook.provider`                                                                | String                                                                       | Verify webhooks are signed by this provider, e.g. 'slack'. For a full list of providers, see [Webhook Verification Providers](/http/webhook-verification/#supported-providers).                                                                                                                   |
| `verify_webhook.secret`                                                                  | String                                                                       | The secret used by provider to sign webhooks, if there is one                                                                                                                                                                                                                                     |
| `websocket_tcp_converter`                                                                | `true`, `false`                                                              | Convert ingress websocket connections to TCP upstream                                                                                                                                                                                                                                             |

### TCP Configuration

|                                                                                          |                                |                                                                                                                                                                                                                               |
| ---------------------------------------------------------------------------------------- | ------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `ip_restriction.allow_cidrs`                                                             | Array of CIDRs                 | Rejects connections that do not match the given CIDRs                                                                                                                                                                         |
| `ip_restriction.deny_cidrs`                                                              | Array of CIDRs                 | Rejects connections that match the given CIDRs and allows all other CIDRs.                                                                                                                                                    |
| [`policy.inbound.name`](/docs/http/traffic-policy/index.mdx)                             | String                         | `policy` has been renamed to `traffic_policy` in agent version 3.14.0.                                                                                                                                                        |
| [`policy.inbound.expressions`](/docs/http/traffic-policy/expressions/index.mdx)          | Array of Strings               | `policy` has been renamed to `traffic_policy` in agent version 3.14.0.                                                                                                                                                        |
| [`policy.inbound.actions.type`](/docs/http/traffic-policy/actions/index.mdx)             | String                         | `policy` has been renamed to `traffic_policy` in agent version 3.14.0.                                                                                                                                                        |
| [`policy.inbound.actions.config`](/docs/http/traffic-policy/actions/index.mdx)           | custom                         | `policy` has been renamed to `traffic_policy` in agent version 3.14.0.                                                                                                                                                        |
| [`policy.outbound.name`](/docs/http/traffic-policy/index.mdx)                            | String                         | `policy` has been renamed to `traffic_policy` in agent version 3.14.0.                                                                                                                                                        |
| [`policy.outbound.expressions`](/docs/http/traffic-policy/expressions/index.mdx)         | Array of Strings               | `policy` has been renamed to `traffic_policy` in agent version 3.14.0.                                                                                                                                                        |
| [`policy.outbound.actions.type`](/docs/http/traffic-policy/actions/index.mdx)            | String                         | `policy` has been renamed to `traffic_policy` in agent version 3.14.0.                                                                                                                                                        |
| [`policy.outbound.actions.config`](/docs/http/traffic-policy/actions/index.mdx)          | custom                         | `policy` has been renamed to `traffic_policy` in agent version 3.14.0.                                                                                                                                                        |
| `proto`                                                                                  | `tcp`                          | The endpoint protocol name. This defines the type of endpoint you would like to start.                                                                                                                                        |
| `proxy_proto`                                                                            | String                         | The version of [PROXY protocol](https://www.haproxy.org/download/1.8/doc/proxy-protocol.txt) to use with this endpoint, empty if not using. Example values are 1 or 2.                                                        |
| `url`                                                                                    | A valid TCP address from ngrok | bind the remote TCP address and port. These addresses can be reserved in the [ngrok dashboard](https://dashboard.ngrok.com/cloud-edge/tcp-addresses) to use across sessions. For example: `remote_addr: 2.tcp.ngrok.io:21746` |
| [`traffic_policy.inbound.name`](/docs/http/traffic-policy/index.mdx)                     | String                         | The name of an inbound rule that is part of a traffic policy                                                                                                                                                                  |
| [`traffic_policy.inbound.expressions`](/docs/http/traffic-policy/expressions/index.mdx)  | Array of Strings               | Expressions written using [CEL](https://github.com/google/cel-spec) that filter traffic the inbound policy rule applies to                                                                                                    |
| [`traffic_policy.inbound.actions.type`](/docs/http/traffic-policy/actions/index.mdx)     | String                         | The type of action that should be executed when this inbound policy rule is activated                                                                                                                                         |
| [`traffic_policy.inbound.actions.config`](/docs/http/traffic-policy/actions/index.mdx)   | custom                         | The configuration required for the specific type of action specified                                                                                                                                                          |
| [`traffic_policy.outbound.name`](/docs/http/traffic-policy/index.mdx)                    | String                         | The name of an outbound rule that is part of a traffic policy                                                                                                                                                                 |
| [`traffic_policy.outbound.expressions`](/docs/http/traffic-policy/expressions/index.mdx) | Array of Strings               | Expressions written using [CEL](https://github.com/google/cel-spec) that filter traffic the outbound policy rule applies to                                                                                                   |
| [`traffic_policy.outbound.actions.type`](/docs/http/traffic-policy/actions/index.mdx)    | String                         | The type of action that should be executed when this outbound policy rule is activated                                                                                                                                        |
| [`traffic_policy.outbound.actions.config`](/docs/http/traffic-policy/actions/index.mdx)  | custom                         | The configuration required for the specific type of action specified                                                                                                                                                          |

### TLS Configuration

|                                                                                          |                                                                              |                                                                                                                                                                                                                                                 |
| ---------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `mutual_tls_cas`                                                                         | Valid system path                                                            | The path to the TLS certificate authority to verify client certs for mutual TLS. You will also need to specify `key` and `crt` to enable mutual TLS.                                                                                            |
| `crt`                                                                                    | Valid system path                                                            | PEM TLS certificate at this path to terminate TLS traffic before forwarding locally. Requires `--key` to also be specified.                                                                                                                     |
| `url`                                                                                    | Any valid domain or hostname that you have previously registered with ngrok. | The domain to request. If using a custom domain, this requires registering in the ngrok Dashboard and setting a DNS CNAME value. When using wildcard domains you will need to surround the value with single quotes (domain: '\*.example.com'). |
| `ip_restriction.allow_cidrs`                                                             | Array of CIDRs                                                               | Rejects connections that do not match the given CIDRs                                                                                                                                                                                           |
| `ip_restriction.deny_cidrs`                                                              | Array of CIDRs                                                               | Rejects connections that match the given CIDRs and allows all other CIDRs.                                                                                                                                                                      |
| `key`                                                                                    | Valid system path                                                            | PEM TLS private key at this path to terminate TLS traffic before forwarding locally. Requires `--crt` to also be specified.                                                                                                                     |
| [`policy.inbound.name`](/docs/http/traffic-policy/index.mdx)                             | String                                                                       | `policy` has been renamed to `traffic_policy` in agent version 3.14.0.                                                                                                                                                                          |
| [`policy.inbound.expressions`](/docs/http/traffic-policy/expressions/index.mdx)          | Array of Strings                                                             | `policy` has been renamed to `traffic_policy` in agent version 3.14.0.                                                                                                                                                                          |
| [`policy.inbound.actions.type`](/docs/http/traffic-policy/actions/index.mdx)             | String                                                                       | `policy` has been renamed to `traffic_policy` in agent version 3.14.0.                                                                                                                                                                          |
| [`policy.inbound.actions.config`](/docs/http/traffic-policy/actions/index.mdx)           | custom                                                                       | `policy` has been renamed to `traffic_policy` in agent version 3.14.0.                                                                                                                                                                          |
| [`policy.outbound.name`](/docs/http/traffic-policy/index.mdx)                            | String                                                                       | `policy` has been renamed to `traffic_policy` in agent version 3.14.0.                                                                                                                                                                          |
| [`policy.outbound.expressions`](/docs/http/traffic-policy/expressions/index.mdx)         | Array of Strings                                                             | `policy` has been renamed to `traffic_policy` in agent version 3.14.0.                                                                                                                                                                          |
| [`policy.outbound.actions.type`](/docs/http/traffic-policy/actions/index.mdx)            | String                                                                       | `policy` has been renamed to `traffic_policy` in agent version 3.14.0.                                                                                                                                                                          |
| [`policy.outbound.actions.config`](/docs/http/traffic-policy/actions/index.mdx)          | custom                                                                       | `policy` has been renamed to `traffic_policy` in agent version 3.14.0.                                                                                                                                                                          |
| `proto`                                                                                  | `tls`                                                                        | The endpoint protocol name. This defines the type of endpoint you would like to start.                                                                                                                                                          |
| `proxy_proto`                                                                            | String                                                                       | The version of [PROXY protocol](https://www.haproxy.org/download/1.8/doc/proxy-protocol.txt) to use with this endpoint, empty if not using. Example values are 1 or 2.                                                                          |
| `terminate_at`                                                                           | `edge`, `agent`, or `upstream`                                               | Terminate at ngrok `edge`, `agent`, or `upstream`. Defaults to `upstream` unless `--crt` or `--key` are present, in which case `edge` is the default.                                                                                           |
| [`traffic_policy.inbound.name`](/docs/http/traffic-policy/index.mdx)                     | String                                                                       | The name of an inbound rule that is part of a traffic policy                                                                                                                                                                                    |
| [`traffic_policy.inbound.expressions`](/docs/http/traffic-policy/expressions/index.mdx)  | Array of Strings                                                             | Expressions written using [CEL](https://github.com/google/cel-spec) that filter traffic the inbound policy rule applies to                                                                                                                      |
| [`traffic_policy.inbound.actions.type`](/docs/http/traffic-policy/actions/index.mdx)     | String                                                                       | The type of action that should be executed when this inbound policy rule is activated                                                                                                                                                           |
| [`traffic_policy.inbound.actions.config`](/docs/http/traffic-policy/actions/index.mdx)   | custom                                                                       | The configuration required for the specific type of action specified                                                                                                                                                                            |
| [`traffic_policy.outbound.name`](/docs/http/traffic-policy/index.mdx)                    | String                                                                       | The name of an outbound rule that is part of a traffic policy                                                                                                                                                                                   |
| [`traffic_policy.outbound.expressions`](/docs/http/traffic-policy/expressions/index.mdx) | Array of Strings                                                             | Expressions written using [CEL](https://github.com/google/cel-spec) that filter traffic the outbound policy rule applies to                                                                                                                     |
| [`traffic_policy.outbound.actions.type`](/docs/http/traffic-policy/actions/index.mdx)    | String                                                                       | The type of action that should be executed when this outbound policy rule is activated                                                                                                                                                          |
| [`traffic_policy.outbound.actions.config`](/docs/http/traffic-policy/actions/index.mdx)  | custom                                                                       | The configuration required for the specific type of action specified                                                                                                                                                                            |

<AgentConfigurations />
