---
title: TLS Endpoints
---

import TabItem from "@theme/TabItem";
import Tabs from "@theme/Tabs";

import TlsLimits from "./_tls_limits.mdx";

import AtAgentAgentCliExample from "/examples/agent-cli/tls-terminate-at-agent.mdx";
import AtAgentAgentConfigExample from "/examples/agent-config/tls-terminate-at-agent.mdx";
import AtAgentGoSdkExample from "/examples/go-sdk/tls-terminate-at-agent.mdx";
import AtAgentJavascriptSdkExample from "/examples/javascript-sdk/tls-terminate-at-agent.mdx";
import AtAgentKubernetesExample from "/examples/k8s/tls-terminate-at-agent.mdx";
import AtAgentPythonSdkExample from "/examples/python-sdk/tls-terminate-at-agent.mdx";
import AtAgentRustSdkExample from "/examples/rust-sdk/tls-terminate-at-agent.mdx";
import AtAgentSshExample from "/examples/ssh/tls-terminate-at-agent.mdx";

import AtUpstreamAgentCliExample from "/examples/agent-cli/tls-terminate-at-upstream.mdx";
import AtUpstreamAgentConfigExample from "/examples/agent-config/tls-terminate-at-upstream.mdx";
import AtUpstreamGoSdkExample from "/examples/go-sdk/tls-terminate-at-upstream.mdx";
import AtUpstreamJavascriptSdkExample from "/examples/javascript-sdk/tls-terminate-at-upstream.mdx";
import AtUpstreamKubernetesExample from "/examples/k8s/tls-terminate-at-upstream.mdx";
import AtUpstreamPythonSdkExample from "/examples/python-sdk/tls-terminate-at-upstream.mdx";
import AtUpstreamRustSdkExample from "/examples/rust-sdk/tls-terminate-at-upstream.mdx";
import AtUpstreamSshExample from "/examples/ssh/tls-terminate-at-upstream.mdx";

import CustomDomainAgentCliExample from "/examples/agent-cli/tls-terminate-at-edge-custom-domain.mdx";
import CustomDomainAgentConfigExample from "/examples/agent-config/tls-terminate-at-edge-custom-domain.mdx";
import CustomDomainGoSdkExample from "/examples/go-sdk/tls-terminate-at-edge-custom-domain.mdx";
import CustomDomainJavascriptSdkExample from "/examples/javascript-sdk/tls-terminate-at-edge-custom-domain.mdx";
import CustomDomainKubernetesExample from "/examples/k8s/tls-terminate-at-edge-custom-domain.mdx";
import CustomDomainPythonSdkExample from "/examples/python-sdk/tls-terminate-at-edge-custom-domain.mdx";
import CustomDomainRustSdkExample from "/examples/rust-sdk/tls-terminate-at-edge-custom-domain.mdx";
import CustomDomainSshExample from "/examples/ssh/tls-terminate-at-edge-custom-domain.mdx";

import ReencryptUpstreamAgentCliExample from "/examples/agent-cli/tls-reencrypt-upstream.mdx";
import ReencryptUpstreamAgentConfigExample from "/examples/agent-config/tls-reencrypt-upstream.mdx";
import ReencryptUpstreamGoSdkExample from "/examples/go-sdk/tls-reencrypt-upstream.mdx";
import ReencryptUpstreamJavascriptSdkExample from "/examples/javascript-sdk/tls-reencrypt-upstream.mdx";
import ReencryptUpstreamKubernetesExample from "/examples/k8s/tls-reencrypt-upstream.mdx";
import ReencryptUpstreamPythonSdkExample from "/examples/python-sdk/tls-reencrypt-upstream.mdx";
import ReencryptUpstreamRustSdkExample from "/examples/rust-sdk/tls-reencrypt-upstream.mdx";
import ReencryptUpstreamSshExample from "/examples/ssh/tls-reencrypt-upstream.mdx";

import ProxyProtoAgentCliExample from "/examples/agent-cli/tls-proxyproto.mdx";
import ProxyProtoAgentConfigExample from "/examples/agent-config/tls-proxyproto.mdx";
import ProxyProtoGoSdkExample from "/examples/go-sdk/tls-proxyproto.mdx";
import ProxyProtoJavascriptSdkExample from "/examples/javascript-sdk/tls-proxyproto.mdx";
import ProxyProtoKubernetesExample from "/examples/k8s/tls-proxyproto.mdx";
import ProxyProtoPythonSdkExample from "/examples/python-sdk/tls-proxyproto.mdx";
import ProxyProtoRustSdkExample from "/examples/rust-sdk/tls-proxyproto.mdx";
import ProxyProtoSshExample from "/examples/ssh/tls-proxyproto.mdx";

# TLS Endpoints

## Overview

TLS endpoints enable you to deliver any network service that runs over a
TLS-based protocol. TLS endpoints make no assumptions about the wrapped
protocol being transported.

TLS endpoints inspect the [Server Name Indication (SNI)](#sni)
data on incoming TLS connections to route connections to the appropriate
endpoint.

Because the TLS protocol describes no application-level semantics, ngrok can
only offer a [limited set of traffic policy actions](/traffic-policy/actions/)
to handle TLS traffic.

If you are delivering an HTTPS application, prefer to create an [HTTP
Endpoint](/universal-gateway/http/).

## Quickstart

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<CustomDomainAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<CustomDomainAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<CustomDomainSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<CustomDomainGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<CustomDomainJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<CustomDomainPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<CustomDomainRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<CustomDomainKubernetesExample />
	</TabItem>
</Tabs>

## URLs

URLs are validated differently depending on their
[binding](/universal-gateway/bindings). Consult the
following documentation for details on valid URLs for TLS endpoints:

- [Public Endpoint URLs](/universal-gateway/public-endpoints/#https-tls)
- [Internal Endpoint URLs](/universal-gateway/internal-endpoints/#urls)
- [Kubernetes Endpoint URLs](/universal-gateway/kubernetes-endpoints/#urls)

There is no standard scheme for TLS URLs so ngrok renders them as `tls://`.

## Bindings

TLS endpoints support `public` and `internal` bindings. `kubernetes` binding is
not supported.

## Traffic Policy

Attach [Traffic Policy](/traffic-policy/) to endpoints to route, authenticate
and transform the traffic through your TLS endpoints.

### Authentication

When you create public TLS endpoints, you often want to secure them with
authentication. You can secure your TLS endpoints with the following [Traffic
Policy](/traffic-policy/) actions. There is a limited set of actions available
to authenticate TLS traffic because the TLS protocol is low-level.

- [IP Restriction](/traffic-policy/actions/restrict-ips/)
- [Mutual TLS](/traffic-policy/actions/terminate-tls/)

## TLS

### Termination

TLS Endpoints provide you with the flexibility to define where TLS termination
occurs. You may configure your endpoint to terminate TLS at the ngrok cloud
service or you can achieve [end-to-end
encryption](/universal-gateway/tls-termination/#end-to-end-encryption)
by terminating at the agent or your upstream service. When you use end-to-end
encryption, the ngrok cloud service can not see payload that transit through
your endpoints.

Consult the documentation on [TLS Termination
Locations](/universal-gateway/tls-termination/#termination-location) for
additional details.

#### Cloud Service

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<CustomDomainAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<CustomDomainAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<CustomDomainSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<CustomDomainGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<CustomDomainJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<CustomDomainPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<CustomDomainRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<CustomDomainKubernetesExample />
	</TabItem>
</Tabs>

<br />

#### Terminate at Agent

See [TLS Termination at the Agent for End-to-End Encryption](/universal-gateway/tls-termination#end-to-end-encryption) for additional details.

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<AtAgentAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<AtAgentAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<AtAgentSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<AtAgentGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<AtAgentJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<AtAgentPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<AtAgentRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<AtAgentKubernetesExample />
	</TabItem>
</Tabs>

<br />

#### Terminate at Upstream

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<AtUpstreamAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<AtUpstreamAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<AtUpstreamSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<AtUpstreamGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<AtUpstreamJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<AtUpstreamPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<AtUpstreamRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<AtUpstreamKubernetesExample />
	</TabItem>
</Tabs>

### Certificates

It is very common to encounter certificate errors when working with TLS
endpoints. When terminating TLS at ngrok's cloud service, ngrok will
automatically select, provision and manage certs for you. When performing
[end-to-end
encryption](/universal-gateway/tls-termination/#end-to-end-encryption)
by terminating at the agent or upstream service, you become responsible for
provisioning, managing and distributing certificates.

Consult the documentation on [TLS
Certificates](/universal-gateway/tls-certificates/how-does-ngrok-handle-tls/) for details about
certificate selection, provisioning and management.

## Agent Forwarding

### Re-encrypt to Upstream

If you terminate TLS at the ngrok cloud service or ngrok agent, you may want to
re-encrypt the connection from the agent to your upstream service. The ngrok
agent supports this behavior by using the non-standard `tls://` scheme syntax.

<Tabs groupId="connectivity" queryString="cty">
<TabItem value="agent-cli" label="Agent CLI" default>

```bash
ngrok tls tls://localhost:443 --terminate-at=edge
```

</TabItem>
<TabItem value="agent-config" label="Agent Config">
<ReencryptUpstreamAgentConfigExample />
</TabItem>
<TabItem value="ssh" label="SSH">
<ReencryptUpstreamSshExample />
</TabItem>
<TabItem value="go-sdk" label="Go">
<ReencryptUpstreamGoSdkExample />
</TabItem>
<TabItem value="javascript-sdk" label="Javascript">
<ReencryptUpstreamJavascriptSdkExample />
</TabItem>
<TabItem value="python-sdk" label="Python">
<ReencryptUpstreamPythonSdkExample />
</TabItem>
<TabItem value="rust-sdk" label="Rust">
<ReencryptUpstreamRustSdkExample />
</TabItem>
<TabItem value="k8s" label="Kubernetes Controller">
<ReencryptUpstreamKubernetesExample />
</TabItem>
</Tabs>

### PROXY Protocol

Add a [PROXY
protocol](https://www.haproxy.org/download/1.8/doc/proxy-protocol.txt) header
on connection to your upstream service. This sends connection information like
the original client IP address to your upstream service.

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<ProxyProtoAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<ProxyProtoAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<ProxyProtoSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<ProxyProtoGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<ProxyProtoJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<ProxyProtoPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<ProxyProtoRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<ProxyProtoKubernetesExample />
	</TabItem>
</Tabs>

## Compatible Clients

### SNI

TLS endpoints only work with modern TLS clients that populate the SNI
extension. See the documentation on [TLS
Termination](/universal-gateway/tls-termination/#sni) for additional
details on compatible clients.

### STARTTLS

Protocols that begin in plain text and upgrade to TLS via a mechanism like
STARTTLS in SMTP, IMAP, etc are not supported. If you need to support
connections which upgrade to TLS, use a [TCP
Endpoint](/universal-gateway/tcp/).

## Observability

### Traffic Inspector

[Traffic Inspector](/obs/traffic-inspection) does not support TLS endpoints.

### Log Export Events

You can export logs of traffic to TLS endpoints with [ngrok's events
system](/obs/). The following events are published for log exporting:

| Event                                                                    | When                                                         |
| ------------------------------------------------------------------------ | ------------------------------------------------------------ |
| [tcp_connection_closed.v0](/obs/events/reference/#tcp-connection-closed) | Published when a TCP connection to a TCP endpoint completes. |

## Limits & Timeouts

[Contact us](mailto:support@ngrok.com) if you need to configure limits and
timeouts on connections to TLS endpoints.

#### Connections

| Limit     | Name                | Notes                                                          |
| --------- | ------------------- | -------------------------------------------------------------- |
| 3 seconds | ClientHello Timeout | Time between connection establishment and ClientHello received |
| 5 minutes | Client Idle Timeout | Time since data was last transmitted by the upstream service   |
| 5 minutes | Server Idle Timeout | Time since data was last transmitted by the upstream service   |
| No limit  | Data transmitted    | Data transmitted by the client or upstream service             |

#### TLS

<TlsLimits />

## Errors

If a TLS handshake fails, an appropriate TLS abort code will be sent to the
client.

In all other cases, if an error is encountered while handling TLS connections
to your endpoints (e.g. no available backends or internal server error), the
connection will be closed. The TLS protocol and its implementations are not
sufficiently flexible enough to deliver additional rich error information when
failures are encountered.

Use the [observability](#observability) features to understand connection
handling errors.

## API

TLS Endpoints can be created programatically. Consult the documentation on
[Endpoint APIs](/api/resources/endpoints/).

## Pricing

TLS endpoints are available on Pay-as-you-go, Pro, and Enterprise plans. Consult the [Endpoints
Pricing](/universal-gateway/endpoints/#pricing) documentation for
billing details.

See [Domains pricing](/universal-gateway/domains/#pricing) for details on
pricing for custom domains, wildcard domains and more.

Zero-knowledge TLS is available on the Enterprise plan.
