---
title: HTTP/S Endpoints
---

import TabItem from "@theme/TabItem";
import Tabs from "@theme/Tabs";

import TlsLimits from "./_tls_limits.mdx";

import RandomAgentCliExample from "/examples/agent-cli/http-random.mdx";
import RandomAgentConfigExample from "/examples/agent-config/http-random.mdx";
import RandomGoSdkExample from "/examples/go-sdk/http-random.mdx";
import RandomJavascriptSdkExample from "/examples/javascript-sdk/http-random.mdx";
import RandomPythonSdkExample from "/examples/python-sdk/http-random.mdx";
import RandomRustSdkExample from "/examples/rust-sdk/http-random.mdx";
import RandomSshExample from "/examples/ssh/http-random.mdx";

import StaticDomainAgentCliExample from "/examples/agent-cli/http-static-domain.mdx";
import StaticDomainAgentConfigExample from "/examples/agent-config/http-static-domain.mdx";
import StaticDomainGoSdkExample from "/examples/go-sdk/http-static-domain.mdx";
import StaticDomainJavascriptSdkExample from "/examples/javascript-sdk/http-static-domain.mdx";
import StaticDomainKubernetesExample from "/examples/k8s/http-static-domain.mdx";
import StaticDomainPythonSdkExample from "/examples/python-sdk/http-static-domain.mdx";
import StaticDomainRustSdkExample from "/examples/rust-sdk/http-static-domain.mdx";
import StaticDomainSshExample from "/examples/ssh/http-static-domain.mdx";

import BrandedDomainAgentCliExample from "/examples/agent-cli/http-branded-domain.mdx";
import BrandedDomainAgentConfigExample from "/examples/agent-config/http-branded-domain.mdx";
import BrandedDomainGoSdkExample from "/examples/go-sdk/http-branded-domain.mdx";
import BrandedDomainJavascriptSdkExample from "/examples/javascript-sdk/http-branded-domain.mdx";
import BrandedDomainKubernetesExample from "/examples/k8s/http-branded-domain.mdx";
import BrandedDomainPythonSdkExample from "/examples/python-sdk/http-branded-domain.mdx";
import BrandedDomainRustSdkExample from "/examples/rust-sdk/http-branded-domain.mdx";
import BrandedDomainSshExample from "/examples/ssh/http-branded-domain.mdx";

import BasicAuthAgentCliExample from "/examples/agent-cli/http-basic-auth.mdx";
import BasicAuthAgentConfigExample from "/examples/agent-config/http-basic-auth.mdx";
import BasicAuthGoSdkExample from "/examples/go-sdk/http-basic-auth.mdx";
import BasicAuthJavascriptSdkExample from "/examples/javascript-sdk/http-basic-auth.mdx";
import BasicAuthKubernetesExample from "/examples/k8s/http-basic-auth.mdx";
import BasicAuthPythonSdkExample from "/examples/python-sdk/http-basic-auth.mdx";
import BasicAuthRustSdkExample from "/examples/rust-sdk/http-basic-auth.mdx";
import BasicAuthSshExample from "/examples/ssh/http-basic-auth.mdx";

import OAuthAgentCliExample from "/examples/agent-cli/http-oauth-authn.mdx";
import OAuthAgentConfigExample from "/examples/agent-config/http-oauth-authn.mdx";
import OAuthGoSdkExample from "/examples/go-sdk/http-oauth-authn.mdx";
import OAuthJavascriptSdkExample from "/examples/javascript-sdk/http-oauth-authn.mdx";
import OAuthKubernetesExample from "/examples/k8s/http-oauth-authn.mdx";
import OAuthPythonSdkExample from "/examples/python-sdk/http-oauth-authn.mdx";
import OAuthRustSdkExample from "/examples/rust-sdk/http-oauth-authn.mdx";
import OAuthSshExample from "/examples/ssh/http-oauth-authn.mdx";

import ForwardHttpsAgentCliExample from "/examples/agent-cli/http-forward-https.mdx";
import ForwardHttpsAgentConfigExample from "/examples/agent-config/http-forward-https.mdx";
import ForwardHttpsGoSdkExample from "/examples/go-sdk/http-forward-https.mdx";
import ForwardHttpsJavascriptSdkExample from "/examples/javascript-sdk/http-forward-https.mdx";
import ForwardHttpsKubernetesExample from "/examples/k8s/http-forward-https.mdx";
import ForwardHttpsPythonSdkExample from "/examples/python-sdk/http-forward-https.mdx";
import ForwardHttpsRustSdkExample from "/examples/rust-sdk/http-forward-https.mdx";
import ForwardHttpsSshExample from "/examples/ssh/http-forward-https.mdx";

import HostHeaderAgentCliExample from "/examples/agent-cli/http-rewrite-host-header.mdx";
import HostHeaderAgentConfigExample from "/examples/agent-config/http-rewrite-host-header.mdx";
import HostHeaderGoSdkExample from "/examples/go-sdk/http-rewrite-host-header.mdx";
import HostHeaderJavascriptSdkExample from "/examples/javascript-sdk/http-rewrite-host-header.mdx";
import HostHeaderKubernetesExample from "/examples/k8s/http-rewrite-host-header.mdx";
import HostHeaderPythonSdkExample from "/examples/python-sdk/http-rewrite-host-header.mdx";
import HostHeaderRustSdkExample from "/examples/rust-sdk/http-rewrite-host-header.mdx";
import HostHeaderSshExample from "/examples/ssh/http-rewrite-host-header.mdx";

import WildcardAgentCliExample from "/examples/agent-cli/http-wildcard-domain.mdx";
import WildcardAgentConfigExample from "/examples/agent-config/http-wildcard-domain.mdx";
import WildcardGoSdkExample from "/examples/go-sdk/http-wildcard-domain.mdx";
import WildcardJavascriptSdkExample from "/examples/javascript-sdk/http-wildcard-domain.mdx";
import WildcardKubernetesExample from "/examples/k8s/http-wildcard-domain.mdx";
import WildcardPythonSdkExample from "/examples/python-sdk/http-wildcard-domain.mdx";
import WildcardRustSdkExample from "/examples/rust-sdk/http-wildcard-domain.mdx";
import WildcardSshExample from "/examples/ssh/http-wildcard-domain.mdx";

import NonLocalAgentCliExample from "/examples/agent-cli/http-nonlocal.mdx";
import NonLocalAgentConfigExample from "/examples/agent-config/http-nonlocal.mdx";
import NonLocalGoSdkExample from "/examples/go-sdk/http-nonlocal.mdx";
import NonLocalJavascriptSdkExample from "/examples/javascript-sdk/http-nonlocal.mdx";
import NonLocalKubernetesExample from "/examples/k8s/http-nonlocal.mdx";
import NonLocalPythonSdkExample from "/examples/python-sdk/http-nonlocal.mdx";
import NonLocalRustSdkExample from "/examples/rust-sdk/http-nonlocal.mdx";
import NonLocalSshExample from "/examples/ssh/http-nonlocal.mdx";

import AbsPathFileserverAgentCliExample from "/examples/agent-cli/http-fileserver-abs-path.mdx";
import AbsPathFileserverAgentConfigExample from "/examples/agent-config/http-fileserver-abs-path.mdx";
import AbsPathFileserverGoSdkExample from "/examples/go-sdk/http-fileserver-abs-path.mdx";
import AbsPathFileserverJavascriptSdkExample from "/examples/javascript-sdk/http-fileserver-abs-path.mdx";
import AbsPathFileserverKubernetesExample from "/examples/k8s/http-fileserver-abs-path.mdx";
import AbsPathFileserverPythonSdkExample from "/examples/python-sdk/http-fileserver-abs-path.mdx";
import AbsPathFileserverRustSdkExample from "/examples/rust-sdk/http-fileserver-abs-path.mdx";
import AbsPathFileserverSshExample from "/examples/ssh/http-fileserver-abs-path.mdx";

import WorkingDirFileserverAgentCliExample from "/examples/agent-cli/http-fileserver-working-dir.mdx";
import WorkingDirFileserverAgentConfigExample from "/examples/agent-config/http-fileserver-working-dir.mdx";
import WorkingDirFileserverGoSdkExample from "/examples/go-sdk/http-fileserver-working-dir.mdx";
import WorkingDirFileserverJavascriptSdkExample from "/examples/javascript-sdk/http-fileserver-working-dir.mdx";
import WorkingDirFileserverKubernetesExample from "/examples/k8s/http-fileserver-working-dir.mdx";
import WorkingDirFileserverPythonSdkExample from "/examples/python-sdk/http-fileserver-working-dir.mdx";
import WorkingDirFileserverRustSdkExample from "/examples/rust-sdk/http-fileserver-working-dir.mdx";
import WorkingDirFileserverSshExample from "/examples/ssh/http-fileserver-working-dir.mdx";

import WindowsFileserverAgentCliExample from "/examples/agent-cli/http-fileserver-windows.mdx";
import WindowsFileserverAgentConfigExample from "/examples/agent-config/http-fileserver-windows.mdx";
import WindowsFileserverGoSdkExample from "/examples/go-sdk/http-fileserver-windows.mdx";
import WindowsFileserverJavascriptSdkExample from "/examples/javascript-sdk/http-fileserver-windows.mdx";
import WindowsFileserverKubernetesExample from "/examples/k8s/http-fileserver-windows.mdx";
import WindowsFileserverPythonSdkExample from "/examples/python-sdk/http-fileserver-windows.mdx";
import WindowsFileserverRustSdkExample from "/examples/rust-sdk/http-fileserver-windows.mdx";
import WindowsFileserverSshExample from "/examples/ssh/http-fileserver-windows.mdx";

HTTP/S endpoints enable you to serve web services like REST APIs, web
applications, websites and websocket servers. Serving a web application is as
simple as `ngrok http 80`.

Once your endpoint is running, check out:

- [Traffic Policy](/traffic-policy/) - Add routing, authentication and traffic transformation
- [Traffic Inspector](https://dashboard.ngrok.com/traffic-inspection/) - Real-time observability with request/response introspection
- [Endpoint Pooling](/universal-gateway/endpoint-pooling/) - Load balancing

## Quickstart

### Agent Endpoint

Agent Endpoints are the easiest way to get started with ngrok. An [agent
endpoint](/universal-gateway/cloud-endpoints/) is started by a
[Secure Tunnels](/agent/) agent. The endpoint lives for the lifetime of the
process and forwards traffic to a port or URL of your choosing.

Create the endpoint `https://example.ngrok.app` and forward its traffic to a
local port.

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<StaticDomainAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<StaticDomainAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<StaticDomainSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<StaticDomainGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<StaticDomainJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<StaticDomainPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<StaticDomainRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<StaticDomainKubernetesExample />
	</TabItem>
</Tabs>

<br />

### Cloud Endpoint

[Cloud endpoints](/universal-gateway/cloud-endpoints/) are created via the
ngrok Dashboard or [API](/api/). They are persistent and live until they are
deleted. [Traffic Policy](/traffic-policy/) controls how a cloud endpoint
handles traffic.

[Create an HTTPS cloud endpoint](https://dashboard.ngrok.com/endpoints/new)
which returns a `Hello world!` 200 OK response.

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-api" label="Agent CLI" default>

```sh title="Command line"
ngrok api endpoints create \
  --url https://example.ngrok.app \
  --traffic-policy "$(<traffic-policy.yml)"
```

```yaml title="traffic-policy.yml" mode=traffic-policy
on_http_request:
  - actions:
      - type: custom-response
        config:
          status_code: 200
          headers:
            content-type: text/plain
          content: "Hello world!"
```

    </TabItem>

</Tabs>

## URL

URLs are validated differently depending on their
[binding](/universal-gateway/bindings). Consult the
following documentation for details on valid URLs for TCP endpoints:

- [Public Endpoint URLs](/universal-gateway/public-endpoints/#urls)
- [Internal Endpoint URLs](/universal-gateway/internal-endpoints/#urls)
- [Kubernetes Endpoint URLs](/universal-gateway/kubernetes-endpoints/#urls)

#### Public

###### HTTP

- The hostname must be a domain with a valid [public suffix](https://publicsuffix.org/).
- The port must be `80`. If you do not specify a port, the default `80` will be used for you.

**Examples**

- `http://example.ngrok.app`
- `http://example.ngrok.app:80`
- `http://example.party`
- `http://example.ngrok.app:81` - invalid port: port number must be `80`, not `81`
- `http://example.doesnotexist` - invalid hostname: `.doesnotexist` is not a public suffix domain
- `http://example.internal` - invalid hostname: `.internal` is not a public suffix domain

###### HTTPS

- The hostname must be a domain with a valid [public suffix](https://publicsuffix.org/).
- The port must be `443`. If you do not specify a port, the default `443` will be used for you.

#### Internal

#### Kubernetes

##### Valid URLs

- https://example.ngrok.app
- https://example.ngrok.app:443
- https://example.party

##### Invalid URLs

- https://example.ngrok.app:8443
- https://example.nosuchtld
- https://example.internal

### Validation

When you create an agent endpoint, if you do not specify a complete URL,
following defaults are used to construct an endpoint URL. When you create a
cloud endpoint, you must always specify both a scheme and hostname.

| URL Part | Default                                                   |
| -------- | --------------------------------------------------------- |
| Scheme   | `https`                                                   |
| Hostname | randomly selected                                         |
| Port     | `443` if scheme is `https`<br /> `80` if scheme is `http` |

Consult the following table of examples of URL defaulting:

| Value                           | Endpoint URL                                             |
| ------------------------------- | -------------------------------------------------------- |
| `https://example.ngrok.app`     | `https://example.ngrok.app`                              |
| `http://example.ngrok.app`      | `http://example.ngrok.app`                               |
| `example.ngrok.app`             | `https://example.ngrok.app`                              |
| `app.example.com`               | `https://app.example.com`                                |
| `https://example.internal`      | `https://example.internal`                               |
| `https://example.internal:1234` | `https://example.internal:1234`                          |
| `http://example.internal`       | `http://example.internal`                                |
| `foo.internal`                  | `https://foo.internal`                                   |
| `{empty}`                       | `https://1eb2-181-80-12-3.ngrok.app` (randomly selected) |

If you would like to listen for both http and https traffic, create two endpoints.

#### Domains

When you create a public endpoint, it must match a
[Domain](/universal-gateway/domains) on your account. Domains help you set up
branded domains and manage TLS certificates. You may create endpoints with
wildcard domains as well.

Endpoints with randomly-assigned hostnames are an exception and won't match an
existing Domain object.

### Bring your own domain {#bring-your-own-domain}

If you want to bring your own domain, first [create a Domain record and set up
a DNS CNAME record](/universal-gateway/domains/#branded-domains). Then
create an endpoint on that domain by specifying a URL with a matching hostname.

For example, to create an HTTPS endpoint on `https://app.example.com`, [create
a Domain](https://dashboard.ngrok.com/domains) and follow the instructions to
set up a CNAME record. Then use the following example to start an endpoint on
your domain:

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<BrandedDomainAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<BrandedDomainAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<BrandedDomainSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<BrandedDomainGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<BrandedDomainJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<BrandedDomainPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<BrandedDomainRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<BrandedDomainKubernetesExample />
	</TabItem>
</Tabs>

### Wildcard endpoints

You can create an endpoint which will receive traffic for all of the subdomains
matching a given wildcard domain like `*.example.com`. You must create a
[wildcard domain](/universal-gateway/domains/#wildcard-domains) to create a
public wildcard endpoint.

For example, if you create the wildcard endpoint `https://*.example.com`, it
will receive traffic for `https://foo.example.com` and
`https://bar.example.com`.

- Connections to URLs which match an online wildcard endpoint will be routed to
  it. For example, if you have created a wildcard endpoint
  `https://*.example.com`, connections to `https://foo.bar.baz.example.com` will
  route to it.
- Connections are routed to the most specific online endpoint. For example, if
  the endpoints `https://*.example.com` and `https://app.example.com` are both
  online, a connection to `https://app.example.com` will not be routed to the
  wildcard endpoint.

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<WildcardAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<WildcardAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<WildcardSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<WildcardGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<WildcardJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<WildcardPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<WildcardRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<WildcardKubernetesExample />
	</TabItem>
</Tabs>

### Randomly assigned hostnames

If you run create a public endpoint without specifying a hostname, ngrok will
automatically assign a random one for you.by selecting a random subdomain of one of our [ngrok-managed
Domains](/universal-gateway/domains#ngrok-managed-domains) to your endpoint.
For example, the command `ngrok http 80` may create an endpoint like
`https://1eb2-181-80-12-3.ngrok.app`.

The following example create an HTTPS endpoint on a randomly assigned hostname
that forwards to port 8080.

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<RandomAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<RandomAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<RandomSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<RandomGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<RandomJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<RandomPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<RandomRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<StaticDomainKubernetesExample />
	</TabItem>
</Tabs>

## Traffic Policy

Attach [Traffic Policy](/traffic-policy/) to endpoints to route, authenticate and transform the traffic through the endpoint.

### Authentication

Public endpoints are accessible to the public internet unless you secure them
with authentication. That's desirable if you're hosting a public website but
most often you want to add authentication. You can secure your endpoints with
[Traffic Policy](/traffic-policy) with any of the following actions:

- [Basic Auth](/traffic-policy/actions/basic-auth)
- [OAuth](/traffic-policy/actions/oauth)
- [IP Restriction](/traffic-policy/actions/restrict-ips/)
- [Webhook Verification](/traffic-policy/actions/verify-webhook/)
- [JWT](/traffic-policy/actions/jwt-validation/)
- [Mutual TLS](/traffic-policy/actions/terminate-tls/)
- [OpenID Connect](/traffic-policy/actions/oidc/)
- [SAML](/traffic-policy/actions/saml/)

#### Basic Auth Example

Adds a username and password with the [Basic
Auth](/traffic-policy/actions/basic-auth) Traffic Policy action.

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<BasicAuthAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<BasicAuthAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<BasicAuthSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<BasicAuthGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<BasicAuthJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<BasicAuthPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<BasicAuthRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<BasicAuthKubernetesExample />
	</TabItem>
</Tabs>

<br />

#### Google OAuth Example

The following example enforces a browser-based OAuth redirect flow in front of
your endpoint using Google as the identity provider by using the
[OAuth](/traffic-policy/actions/oauth) Traffic Policy action.

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<OAuthAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<OAuthAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<OAuthSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<OAuthGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<OAuthJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<OAuthPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<OAuthRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<OAuthKubernetesExample />
	</TabItem>
</Tabs>

#### Rewriting the `host` header {#rewrite-host-header}

Some application servers expect the `host` header to match a specific value
when they receive requests and some use the `host` header to determine which of
many sites to display. ngrok can rewrite the `host` header of incoming requests
so that your application behaves correctly.

When you rewrite the `host` header, ngrok also rewrites the `location` header of
HTTP responses automatically to match the hostname of your Endpoint URL.

The following example rewrites the `host` header to the value `localhost` using
the [`add-headers`](/traffic-policy/actions/add-headers) Traffic Policy action.
Adding the `Host` header [is a special
case](/traffic-policy/actions/add-headers/#special-cases) that replaces the existing
`Host` header instead of appending a second value.

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<HostHeaderAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<HostHeaderAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<HostHeaderSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<HostHeaderGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<HostHeaderJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<HostHeaderPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<HostHeaderRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<HostHeaderKubernetesExample />
	</TabItem>
</Tabs>

## Agent Forwarding

The [ngrok agent](/agent/) and [Agent
SDKs](/agent-sdks/) forward traffic that your endpoints receive
to upstream services. You specify a URL or port number to instruct the ngrok
agent where and how to forward traffic.

### HTTPS forwarding

The scheme in your upstream URL is used to determine whether to forward HTTP or
HTTPS traffic to the upstream service. If you do not specify a scheme, the
default `http` scheme is chosen _unless_ you forward to port `443`, in which
case ngrok will use `https`. Consult the following table of examples.

| Upstream URL             | Normalized Value         |
| ------------------------ | ------------------------ |
| `http://localhost:1234`  | `http://localhost:1234`  |
| `https://localhost:1234` | `https://localhost:1234` |
| `localhost:1234`         | `http://localhost:1234`  |
| `1234`                   | `http://localhost:1234`  |
| `localhost:443`          | `https://localhost:443`  |
| `443`                    | `https://localhost:443`  |

ngrok assumes that the network you run the agent on is private and it does not
verify the TLS certificate presented by the upstream service. You may change
this behavior with the [flags `--upstream-tls-verify` and
`upstream-tls-verify-cas`](/agent/cli/#ngrok-http).

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<ForwardHttpsAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<ForwardHttpsAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<ForwardHttpsSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<ForwardHttpsGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<ForwardHttpsJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<ForwardHttpsPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<ForwardHttpsRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<ForwardHttpsKubernetesExample />
	</TabItem>
</Tabs>

### Non-local forwarding

Agents don't just forward to ports on your localhost. You can forward traffic
to any address or URL reachable from the agent. For example, if you want to
forward traffic to a HTTP server running on your network at `192.168.1.2:80`:

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<NonLocalAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<NonLocalAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<NonLocalSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<NonLocalGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<NonLocalJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<NonLocalPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<NonLocalRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<NonLocalKubernetesExample />
	</TabItem>
</Tabs>

### HTTP/2 forwarding

When agents forward to upstream http/2 services, connections use HTTP/1.1 by
default.

You can configure the agent, SDKs and Kubernetes Operator to instead use HTTP/2
when forwarding to your upstream service.

| Forwarder           | Option                            | Docs                                      |
| ------------------- | --------------------------------- | ----------------------------------------- |
| Agent               | `--upstream-protocol`             | [Agent CLI flags](/agent/cli/#ngrok-http) |
| Agent SDKs          | language-dependent                | [Agent SDKs](/agent-sdks)                 |
| Kubernetes Operator | `appProtocol` on the `Tunnel` CRD | [Kubernetes Operator](/k8s)               |

When http2 forwarding is enabled, all requests to your upstream service will be
transmitted over HTTP/2 Cleartext since TLS was already terminated at the ngrok
cloud service. We cannot use
[TLS-ALPN](https://httpwg.org/specs/rfc7540.html#TLS-ALPN) at this time. We
rely on [HTTP/2 with Prior
Knowledge](https://httpwg.org/specs/rfc7540.html#known-http) currently.

### Serving file directories

The ngrok agent supports the `file://` scheme in a forwarding URL. When you use
the `file://` scheme, the ngrok agent serves local file system directories by
using its own built-in file server, no separate server needed. It works just
like `python3 -m http.server` but it is built directly into the ngrok agent.

Paths in `file://` URLs must be specified as absolute paths.

#### Serve files in `/var/log`

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<AbsPathFileserverAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<AbsPathFileserverAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<AbsPathFileserverSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<AbsPathFileserverGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<AbsPathFileserverJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<AbsPathFileserverPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<AbsPathFileserverRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<AbsPathFileserverKubernetesExample />
	</TabItem>
</Tabs>

<br />

#### Serve files on Windows

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<WindowsFileserverAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<WindowsFileserverAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<WindowsFileserverSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<WindowsFileserverGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<WindowsFileserverJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<WindowsFileserverPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<WindowsFileserverRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<WindowsFileserverKubernetesExample />
	</TabItem>
</Tabs>

<br />

#### Serve files in your current working directory

<Tabs groupId="connectivity" queryString="cty">
	<TabItem value="agent-cli" label="Agent CLI" default>
		<WorkingDirFileserverAgentCliExample />
	</TabItem>
	<TabItem value="agent-config" label="Agent Config">
		<WorkingDirFileserverAgentConfigExample />
	</TabItem>
	<TabItem value="ssh" label="SSH">
		<WorkingDirFileserverSshExample />
	</TabItem>
	<TabItem value="go-sdk" label="Go">
		<WorkingDirFileserverGoSdkExample />
	</TabItem>
	<TabItem value="javascript-sdk" label="Javascript">
		<WorkingDirFileserverJavascriptSdkExample />
	</TabItem>
	<TabItem value="python-sdk" label="Python">
		<WorkingDirFileserverPythonSdkExample />
	</TabItem>
	<TabItem value="rust-sdk" label="Rust">
		<WorkingDirFileserverRustSdkExample />
	</TabItem>
	<TabItem value="k8s" label="Kubernetes Controller">
		<WorkingDirFileserverKubernetesExample />
	</TabItem>
</Tabs>

## Traffic Observability

### Traffic Inspector

[Traffic Inspector](/obs/traffic-inspection/) gives you a real-time view in the
ngrok dashboard of the HTTP traffic flowing through your HTTP/S endpoints. You
can choose whether Traffic Inspector captures only request metadata or full
request and response bodies.

### Log Export Events

You can export logs of traffic to HTTP/S endpoints with [ngrok's events
system](/obs/). The following events are published for log exporting:

| Event                                                                    | When                                                              |
| ------------------------------------------------------------------------ | ----------------------------------------------------------------- |
| [http_request_complete.v0](/obs/events/reference/#http-request-complete) | Published when an HTTP request to an HTTP/S endpoints completes.  |
| [tcp_connection_closed.v0](/obs/events/reference/#tcp-connection-closed) | Published when a TCP connection to an HTTP/S endpoints completes. |

## Advanced

HTTP/S endpoints are standards-compliant HTTP reverse proxies.

### Versions

- HTTP/S endpoints support HTTP/1.1.
- HTTPS endpoints support HTTP/1.1 and HTTP/2.
- HTTP/1.0, HTTP/3 and QUIC are **not** supported.

### HTTP/2

HTTPS endpoints will automatically use HTTP/2 for all connections if the client
supports it. Client support is determined via standard ALPN negotiation.

HTTP/2 is used between the client and your endpoint even even if your upstream
service does not support HTTP/2.

The section on [HTTP/2 agent forwarding](#http2-forwarding) has details on how to
configure the use of HTTP/2 when sending traffic to an upstream service.

### Websockets

Websocket connections are supported out-of-the-box. No configuration is required.

### Hop by hop headers

ngrok does not forward any [hop-by-hop
headers](https://datatracker.ietf.org/doc/html/rfc2616#section-13.5.1) to the
upstream service. As an exception, `Connection: upgrade` headers are forwarded
to support [websockets](#websockets).

For information on headers added automatically by ngrok, see
[Upstream Headers](#upstream-headers).

### Persistent connections

When a connection is made to HTTP/S ngrok endpoints with HTTP/1.1, ngrok may
choose to use persistent connections (aka HTTP keep-alive) to improve the
performance of future requests from the same client if the client supports it.

This behavior is not guaranteed and it is not configurable.

See [RFC 7230](https://datatracker.ietf.org/doc/html/rfc7230#section-6.3) for
additional details.

### Well Known URIs

#### `/.well-known/acme-challenge`

ngrok takes over handling of this path of any HTTP endpoint matching a
[Domain](/universal-gateway/domains) with automated certificate management
enabled. You may disable this behavior by uploading your own certificate on the
matching Domain.

## TLS

ngrok automatically handles TLS (SSL) certificate management and termination for you.
There is nothing to setup, configure or manage.

TLS connections to `https` endpoints are terminated at ngrok's cloud service.
If you wish to terminate TLS traffic at the ngrok agent or in your upstream
application, use a [TLS Endpoint](/universal-gateway/tls) instead.

Consult the following documentation for additional details on how ngrok handles
TLS termination and certificiate management:

- [TLS Certificates](/universal-gateway/tls-certificates)
- [TLS Termination](/universal-gateway/tls-termination)

## Upstream Headers

ngrok adds headers to each HTTP request with information about the original
client IP, request scheme and request `host` header value.

| Header              | Description                                                                                                                                 |
| ------------------- | ------------------------------------------------------------------------------------------------------------------------------------------- |
| `x-forwarded-for`   | The IP address of the client who initiated the request. If this header exists on the original request, ngrok will append a new value.       |
| `x-forwarded-proto` | The scheme of the original request, either `http` or `https`. If this header exists on the original request, ngrok will append a new value. |
| `x-forwarded-host`  | The header from the client's request if it existed, otherwise is set to the request's `Host` header value.                                  |

Because ngrok appends values to `x-forwarded-for` and `x-forwarded-proto`, be
sure to use the last value of the header in your application code to read the
values injected by ngrok.

You may remove these headers with the [Remove
Headers](/traffic-policy/actions/remove-headers/) Traffic Policy action.

## Limits & Timeouts

[Contact us](mailto:support@ngrok.com) if you need to configure limits and
timeouts on connections to HTTP endpoints.

#### Connection

| Limit     | Name                | Notes                                                        |
| --------- | ------------------- | ------------------------------------------------------------ |
| 5 minutes | Client Idle Timeout | Time since data was last transmitted by the upstream service |
| 5 minutes | Server Idle Timeout | Time since data was last transmitted by the upstream service |
| No limit  | Data transmitted    | Data transmitted by the client or upstream service           |

#### TLS

<TlsLimits />

#### HTTP

| Limit      | Name               | Notes                                         |
| ---------- | ------------------ | --------------------------------------------- |
| No timeout | Round Trip Timeout | Time for the entire HTTP request and response |

#### HTTP Request

| Limit      | Name                   | Notes                                                |
| ---------- | ---------------------- | ---------------------------------------------------- |
| 1 MB       | Request Header Size    | Includes method, URI and headers                     |
| 1 MB       | Request URI Length     | Limited by the size of the request header            |
| No timeout | Request Timeout        | Time to read the entire HTTP request from the client |
| No timeout | Request Header Timeout | Time to read the HTTP request header from the client |
| No limit   | Request Body Size      |                                                      |

#### HTTP Response

| Limit      | Name                    | Notes                                                 |
| ---------- | ----------------------- | ----------------------------------------------------- |
| 1 MB       | Response Header Size    | Includes method, URI and headers                      |
| No timeout | Response Timeout        | Time to read the entire HTTP response from the server |
| No timeout | Response Header Timeout | Time to read the HTTP response header from the server |
| No limit   | Response Body Size      |                                                       |

## Errors

If ngrok fails to handle an HTTP request it will set the `ngrok-error-code`
header in the HTTP response with a [unique ngrok Error Code](/errors/)
describing the failure.

ngrok guarantees that the upstream service may never set the `ngrok-error-code`
HTTP response header so you know reliably that it was set by ngrok.

ngrok may return an error under the following conditions:

- Your upstream service timed out or rejected the connection
- Your upstream service returned a response that was not valid HTTP
- A [Traffic Policy](/traffic-policy) action rejected the request.
- [Traffic Policy](/traffic-policy) execution encountered a runtime error.
- ngrok encountered an internal error

## API

HTTP/S Endpoints can be created programatically. Consult the documentation on
[Endpoint APIs](/api/resources/endpoints/).

## Pricing

HTTP/S endpoints are available on all plans. Consult the [Endpoints
Pricing](/universal-gateway/endpoints/#pricing) documentation for
billing details.

See [Domains pricing](/universal-gateway/domains/#pricing) for details on
pricing for custom domains, wildcard domains and more.
