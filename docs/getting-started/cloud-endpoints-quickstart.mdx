---
title: Cloud Endpoints Quickstart
sidebar_label: Cloud Endpoints
description: Set up your first ngrok Cloud Endpoint to start managing traffic to your services.
---

import { LangSwitcher } from "/src/components/LangSwitcher";
import TabItem from "@theme/TabItem";
import Tabs from "@theme/Tabs";


Cloud Endpoints provide an additional layer of traffic management above Agent Endpoints and can be used to extend their functionality in several key ways.
Unlike agent endpoints which are ephemeral and run locally, cloud endpoints are persistent and run in the ngrok cloud—as such, they exist indefinitely until deleted.

Using a Traffic Policy, a cloud endpoint can route traffic to multiple other endpoints based on criteria such as path, header, or IP.
A common use case for this pattern is to create a public cloud endpoint that routes traffic to one or more internal agent endpoints.

This guide walks you through how to create cloud endpoints in two ways: first, through the ngrok dashboard, and second, using the Agent CLI to interact with the ngrok API.

:::note 
This doc assumes you've already completed the [Agent CLI Quickstart](/getting-started/)—if not, we highly recommend starting there before continuing here.
:::

## What you'll need

- An [ngrok account](https://dashboard.ngrok.com/signup).
- Your [ngrok auth token](https://dashboard.ngrok.com/get-started/your-authtoken).
- An [ngrok API key](https://dashboard.ngrok.com/api-keys).

## Part one: your first cloud endpoint

### 1. Reserve your domain

Public cloud endpoints (which are what you'll create in this guide) require a reserved domain.

To reserve a domain, navigate to the dashboard, visit [the **Domains** section](https://dashboard.ngrok.com/domains), and select **+ New Domain**.
You can choose a free static domain, or you can use a custom domain you already own.
We'll come back to this in later steps.

### 2. Install the ngrok Agent CLI

If this is your first time using ngrok, run the command that corresponds to your operating system to install the Agent CLI:

<Tabs groupId="os" queryString="os">
<TabItem value="macos" label="Mac OS" default>

```bash
brew install ngrok
```

</TabItem>
<TabItem value="linux" label="Debian Linux">

```bash
curl -sSL https://ngrok-agent.s3.amazonaws.com/ngrok.asc \
  | sudo tee /etc/apt/trusted.gpg.d/ngrok.asc >/dev/null \
  && echo "deb https://ngrok-agent.s3.amazonaws.com buster main" \
  | sudo tee /etc/apt/sources.list.d/ngrok.list \
  && sudo apt update \
  && sudo apt install ngrok
```

</TabItem>
<TabItem value="windows" label="Windows">

```bash
choco install ngrok
```

Run this in an administrator command prompt.

</TabItem>
</Tabs>

Or [follow the direct installation guide](https://download.ngrok.com?tab=download) if you can't use one of the options above.

To test that it's been installed correctly, run the following command in your terminal and confirm that ngrok prints its help text.

```bash
ngrok help
```

### 3. Connect your account

Connect your agent to your ngrok account by providing your auth token as shown below—replace `$YOUR_TOKEN` with the string given to you [in the dashboard](https://dashboard.ngrok.com/get-started/your-authtoken).

```bash
ngrok config add-authtoken $YOUR_TOKEN
```

### 4. Create your cloud endpoint in the dashboard

1. In the menu on the left side, [navigate to Universal Gateway > Endpoints](https://dashboard.ngrok.com/endpoints).
1. Select the **+ New** button, then select **Cloud Endpoint** in the modal that appears.
1. Select a **[binding](/universal-gateway/bindings)**. For this example, you can choose **public**.
1. Enter the URL you want to use for your endpoint. For example, for a public Cloud Endpoint that serves traffic over HTTPS you might use `https://my-app.ngrok.dev`.
1. Select **Create Cloud Endpoint**.

After completing these steps, you'll be taken to a page where you can manage your Cloud Endpoint's [Traffic Policy](/traffic-policy/). Visit the URL you specified to ensure that it's online. You should see a default landing page that says "This is your new Cloud Endpoint!"

### 5. Start your app or service

Start up the app or service you'd like to put online.

If you don't have an app to work with, you can create a minimal app in your language of choice using the following code to set up a basic HTTP server at port `8080`.

<LangSwitcher>

```javascript title="service.js"
const http = require('http');

const server = http.createServer((req, res) => {
    res.writeHead(200, { 'Content-Type': 'text/html' });
    const html = `
    <html>
    <head><title>Test Page</title></head>
    <body><h1>Hello from Node.js HTTP Server!</h1></body>
    </html>
    `;
    res.end(html);
});

const port = 8080;
server.listen(port, () => {
    console.log(`Serving custom HTML at http://localhost:${port}`);
});
```

```go title="service.go"
package main

import (
	"fmt"
	"net/http"
)

func handler(w http.ResponseWriter, r *http.Request) {
	fmt.Fprintf(w, "Hello from Go HTTP Server!")
}

func main() {
	http.HandleFunc("/", handler)

	fmt.Println("Starting server at http://localhost:8080")
	err := http.ListenAndServe(":8080", nil)
	if err != nil {
		fmt.Println("Server failed:", err)
	}
}
```

```python title="service.py"
from http.server import BaseHTTPRequestHandler, HTTPServer

class MyHandler(BaseHTTPRequestHandler):
    def do_GET(self):
        self.send_response(200)
        self.send_header("Content-type", "text/html")
        self.end_headers()
        html = b"""
        <html>
        <head><title>Test Page</title></head>
        <body><h1>Hello from Python HTTP Server!</h1></body>
        </html>
        """
        self.wfile.write(html)

def run(server_class=HTTPServer, handler_class=MyHandler, port=8080):
    server_address = ('', port)
    httpd = server_class(server_address, handler_class)
    print(f"Serving custom HTML at http://localhost:{port}")
    httpd.serve_forever()

if __name__ == "__main__":
    run()
```

</LangSwitcher>

Navigate to the directory where this file is located and start the server.

### 6. Put your app online

Start the ngrok agent by running the following command (replace `8080` if your app is running on a different port).
The `--url` flag connects your agent endpoint to your cloud endpoint—the default URL is `https://default.internal`, but if you changed this in the traffic policy in step 4 then you should use that URL here instead.

```bash
ngrok http 8080 --url https://default.internal
```

### 7. Test your endpoint 

Visit your reserved domain URL to see the app running on your local device.

## Part two: creating cloud endpoints via the ngrok API

Now that you're familiar with the key concepts necessary to work with cloud endpoints, try creating another one using the Agent CLI, which provides access to the ngrok API.

Keep your local app and agent endpoint from part one running.
If you only have one reserved domain to work with, delete the cloud endpoint you created in the dashboard before continuing so you can reuse it in the steps below.

### 1. Create your traffic policy

Create a `policy.yml` on your local machine and add the code snippet below. 
This policy states that incoming HTTP requests should be forwarded to your internal agent endpoint at `https://default.internal`; if that endpoint's not reachable, then it falls back on a custom response to indicate that the app is offline.

```yaml title="policy.yml"
on_http_request:
  - actions:
      - type: "forward-internal"
        config:
          url: "https://default.internal"
         on_error: continue
      - type: custom-response
        config:
          status_code: 200
          headers:
            content-type: text/html
          body: |
             <b>Agent offline!</b>
             <p>Run <code>ngrok http 80 --url https://default.internal</code> to put your application online!</p>

```

### 2. Create your cloud endpoint

Create your cloud endpoint by running the following command—replace `$YOUR_API_KEY` and `$YOUR_DOMAIN` with their respective values:

```bash
ngrok api endpoints create \
 --api-key $YOUR_API_KEY \
 --description "Cloud endpoint for my API" \
 --type cloud \
 --bindings public \
 --url `$YOUR_DOMAIN` \
 --traffic-policy-file policy.yml
```

This command contains all of the configuration steps you worked through in the dashboard.

### 3. Test your endpoint

Your endpoint should be successfully online. 
Verify this by visiting the URL you assigned to it. You should see the content available at the [Internal Endpoint](/universal-gateway/internal-endpoints) you're forwarding traffic to.

If your Internal Endpoint is down, you should see the custom response you configured in your policy, which in thise case reads `Agent offline!`.

## What's next?

- If you need to interact with ngrok agent endpoints programmatically, we recommend using one of our Agent SDKs which are available for [JavaScript (Node.js)](/getting-started/javascript/), [Go](/getting-started/go/), [Python](/getting-started/python/), and [Rust](/getting-started/rust/).
- If your use case calls for a centrally managed, always-on endpoint that isn't tied to the ephemeral lifetime of an agent endpoint, you should proceed to [getting started with Cloud Endpoints](/universal-gateway/cloud-endpoints/quickstart/).
- This quickstart only barely scratches the surface of what's possible with a traffic policy—check out the [Actions overview](/traffic-policy/actions/) to see what else you can do.
- Visit the [Agent CLI command reference](/agent/cli/) for a complete list of available commands.

## Next Steps

- Check out [the guide on load balancing with Cloud Endpoints](/guides/other-guides/forwarding-and-load-balancing-with-cloud-endpoints) to learn how to distribute traffic across multiple internal endpoints.
- See [the Cloud Endpoints overview](/universal-gateway/cloud-endpoints/) to learn about use cases, how they compare to Agent Endpoints, and more.
