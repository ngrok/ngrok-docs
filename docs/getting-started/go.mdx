---
sidebar_label: Go
title: ngrok-go Quickstart
pagination_next: universal-gateway/http
---

import TabItem from "@theme/TabItem";
import Tabs from "@theme/Tabs";
import ConfigExample from "/src/components/ConfigExample.tsx";
import SecureYourApp from "./_secure-your-app.mdx"

[ngrok-go](https://github.com/ngrok/ngrok-go/) is an open-source, idiomatic package that gives you the functionality of the [ngrok agent](/agent) in a Go library. You can use it to embed secure ingress directly into your Go applications.

This quickstart will use the [Agent SDK](/agent-sdks/) for [ngrok-go](https://github.com/ngrok/ngrok-go) to put a Go app on the internet and secure it so that only you can access it.

:::tip
You may want to open the [ngrok-go package documentation on pkg.go.dev](https://pkg.go.dev/golang.ngrok.com/ngrok) as you work through this guide.
:::

## Why you should use ngrok-go

With ngrok-go, you can serve Go applications on the internet in a single line of code without configuring low-level network primitives like IPs, certificates, load balancers and even ports. Applications using ngrok-go listen on ngrokâ€™s global
network and your app gets the same `net.Listener` interface it would get if it had listened on a local port. This makes it incredibly simple to drop ngrok-go into any existing Go code.

:::tip
For working with [the ngrok API](https://ngrok.com/docs/api/), check out the [ngrok Go API Client Library](https://github.com/ngrok/ngrok-api-go).
:::

## What you'll need

1. Ensure [Go is installed](https://go.dev/doc/install) on your machine. You can check this by running `go version` in your terminal.
1. [Set up your ngrok account and install the ngrok agent](/getting-started/).
1. Copy [your ngrok authtoken](https://dashboard.ngrok.com/get-started/your-authtoken) from the dashboard.

## 1. Install ngrok-go

Create a new Go module and install ngrok-go.

```bash
mkdir ngrok-go-quickstart
cd ngrok-go-quickstart
go mod init ngrok-go-quickstart
go get golang.ngrok.com/ngrok/v2
```

## 2. Create your app

The following example starts a Go web server that receives traffic from an endpoint on ngrok's cloud service. It uses a randomly-assigned URL. The URL provided when running this example will be accessible by anyone with an internet connection.

In the `ngrok-go-quickstart` directory, create the following `main.go` file:

```go 
package main

import (
	"context"
	"fmt"
	"log"
	"net/http"

	"golang.ngrok.com/ngrok/v2"
)

func main() {
	if err := run(context.Background()); err != nil {
		log.Fatal(err)
	}
}

func run(ctx context.Context) error {
	// ngrok.Listen uses ngrok.DefaultAgent which uses the NGROK_AUTHTOKEN
	// environment variable for auth
	ln, err := ngrok.Listen(ctx)
	if err != nil {
		return err
	}

	log.Println("Endpoint online", ln.URL())

	// Serve HTTP traffic on the ngrok endpoint
	return http.Serve(ln, http.HandlerFunc(handler))
}

func handler(w http.ResponseWriter, r *http.Request) {
	fmt.Fprintln(w, "Hello from ngrok-go!")
}
```

## 3. Run the example

1. If you haven't yet, [copy your authtoken from the ngrok dashboard](https://dashboard.ngrok.com/get-started/your-authtoken).
1. Run your application with your authtoken in the environment:

```bash
NGROK_AUTHTOKEN="<TOKEN>" go run main.go
```

Your Go application should be live on the internet, with a URL that anyone on the internet can access.

Your app's randomly-assigned URL will be available in the terminal. When you visit the URL, you should see "Hello from ngrok-go!" in your browser. Try sending it to a friend.

## Other features

Once you've completed the quickstart, you can explore other features of ngrok with ngrok-go, such as the following examples.

### Always use the same domain

If you want to keep the same URL each time you run your app:

1. [Create a static
domain in the dashboard](https://dashboard.ngrok.com/domains).
1. Update your `ngrok.Listen` function call to use it. Be sure to restart your app so your changes take effect.

```go showLineNumbers
	listener, err := ngrok.Listen(ctx,
		config.HTTPEndpoint(
			// highlight-start
			config.WithDomain("jumpy-red-mollusk.ngrok-free.app"),
			// highlight-end
		),
		ngrok.WithAuthtokenFromEnv(),
	)
```

### Secure your app

You may not want everyone to be able to access your application. ngrok can
quickly add authentication to your app with a few lines of code.

The following example only grants access to users whose email address is `alan@example.com`.

<SecureYourApp >

You can also add authentication directly in your code.

The following example:
1. Requires visitors to authenticate with Google before they access your application. You can [choose other providers](/traffic-policy/actions/oauth/#supported-providers).
1. Only allows `alan@example.com` access to the application
1. Prints the authenticated user's email address from a request header. [See what headers are populated by the OAuth Module.](/universal-gateway/http/#upstream-headers)

```go
package main

import (
	"context"
	"fmt"
	"log"
	"net/http"

	"golang.ngrok.com/ngrok"
	"golang.ngrok.com/ngrok/config"
)

func main() {
	if err := run(context.Background()); err != nil {
		log.Fatal(err)
	}
}

func example(ctx context.Context) error {
	listener, err := ngrok.Listen(ctx,
		config.HTTPEndpoint(
			// highlight-start
			config.WithOAuth("google",
				config.WithAllowOAuthEmail("alan@example.com"),
			),
			// highlight-end
		),
		ngrok.WithAuthtokenFromEnv(),
	)
	if err != nil {
		return err
	}

	log.Println("App URL", listener.URL())
	return http.Serve(listener, http.HandlerFunc(handler))
}

func handler(w http.ResponseWriter, r *http.Request) {
	fmt.Fprintln(w,
		"<h1>Hello from ngrok-go, %s.</h1>",
		// highlight-start
		r.Header.Values("ngrok-auth-oauth-email"),
		// highlight-end
	)
}
```

</SecureYourApp>

Run your app again and visit the URL it prints in the terminal.

Anyone accessing your app will be prompted to log in with Google and only your
account will be allowed to access it. Keep in mind that when you restarted
ngrok, your app's URL changed, so make sure to visit the new one.

Here's the full result:

![ngrok go in action](/img/howto/ngrok-go/ngrok-go-small.gif)

## Next Steps

- Read the [ngrok-go package documentation on
  pkg.go.dev](https://pkg.go.dev/golang.ngrok.com/ngrok)
- Star the [ngrok-go GitHub repo](https://github.com/ngrok/ngrok-go) and follow
  it for updates.
- Browse [Go examples of HTTP Endpoints](/universal-gateway/http/?cty=go-sdk) of other ways ngrok can augment your application.
- Bring your own [custom domain to ngrok](/universal-gateway/http/#bring-your-own-domain)
- Create connectivity for non-HTTP protocols such as SSH, RDP, or game servers using [TCP Endpoints](/universal-gateway/tcp/?cty=go-sdk)
