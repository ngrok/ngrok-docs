import ConfigExample from "/src/components/ConfigExample.tsx";

# TCP Variables

## Connection Variables

The following variables are available under the `conn` namespace:

| Name                                   | Type      | Description                                                |
| -------------------------------------- | --------- | ---------------------------------------------------------- |
| [`conn.bytes_in`](#connbytes_in)       | int64     | The number of bytes entering the endpoint from the client. |
| [`conn.bytes_out`](#connbytes_out)     | int64     | The number of bytes leaving an endpoint to the client.     |
| [`conn.client_ip`](#connclient_ip)     | string    | Source IP of the connection to the ngrok endpoint.         |
| [`conn.client_port`](#connclient_port) | int32     | Source port of the connection to the ngrok endpoint.       |
| [`conn.server_ip`](#connserver_ip)     | string    | The IP that this connection was established on.            |
| [`conn.server_port`](#connserver_port) | int32     | The port that this connection was established on.          |
| [`conn.ts.end`](#conntsend)            | timestamp | Timestamp when the connection to ngrok was closed.         |
| [`conn.ts.start`](#conntsstart)        | timestamp | Timestamp when the connection to ngrok was started.        |

### `conn.bytes_in`

The number of bytes entering the endpoint from the client.

<ConfigExample
	config={{
		expressions: ["conn.bytes_in > 1000"],
	}}
/>

### `conn.bytes_out`

The number of bytes leaving an endpoint to the client.

<ConfigExample
	config={{
		expressions: ["conn.bytes_out > 1000"],
	}}
/>

### `conn.client_ip`

Source IP of the connection to the ngrok endpoint.

<ConfigExample
	config={{ expressions: ["conn.client_ip in ['::1', '127.0.0.1']"] }}
/>

### `conn.client_port`

Source port of the connection to the ngrok endpoint.

<ConfigExample config={{ expressions: ["conn.client_port == 80"] }} />

### `conn.ts.end`

Timestamp when the connection to ngrok was closed.

<ConfigExample
	config={{
		expressions: ["conn.ts.end > timestamp('2024-01-01')"],
	}}
/>

### `conn.server_ip`

The IP that this connection was established on.

<ConfigExample
	config={{
		expressions: ["conn.server_ip == '192.168.1.1'"],
	}}
/>

### `conn.server_port`

The port that this connection was established on.

<ConfigExample
	config={{
		expressions: ["conn.server_port == 80"],
	}}
/>

### `conn.ts.start`

Timestamp when the connection to ngrok was started.

<ConfigExample
	config={{
		expressions: ["conn.ts.start > timestamp('2023-12-31')"],
	}}
/>

## Connection Geo Variables

The following variables are available under the `conn.geo` namespace:

| Name                                            | Type   | Description                                                                                                   |
| ----------------------------------------------- | ------ | ------------------------------------------------------------------------------------------------------------- |
| [`conn.geo.city`](#conngeocity)                 | string | The name of the city, in EN, where the `conn.client_ip` is likely to originate.                               |
| [`conn.geo.country`](#conngeocountry)           | string | The name of the country, in EN, where the `conn.client_ip` is likely to originate.                            |
| [`conn.geo.country_code`](#conngeocountry_code) | string | The two-letter ISO country code where the `conn.client_ip` is likely to originate.                            |
| [`conn.geo.latitude`](#conngeolatitude)         | string | The approximate latitude where the `conn.client_ip` is likely to originate.                                   |
| [`conn.geo.longitude`](#conngeolongitude)       | string | The approximate longitude where the `conn.client_ip` is likely to originate.                                  |
| [`conn.geo.radius`](#conngeoradius)             | string | The radius in kilometers around the latitude and longitude where the `conn.client_ip` is likely to originate. |
| [`conn.geo.subdivision`](#conngeo_subdivision)  | string | The name of the subdivision, in EN, where the `conn.client_ip` is likely to originate.                        |

### `conn.geo.city`

The name of the city, in EN, where the `conn.client_ip` is likely to originate.

<ConfigExample
	config={{
		expressions: ["conn.geo.city == 'Strongsville'"],
	}}
/>

### `conn.geo.country`

The name of the country, in EN, where the `conn.client_ip` is likely to originate.

<ConfigExample
	config={{
		expressions: ["conn.geo.country == 'United States'"],
	}}
/>

### `conn.geo.country_code`

The two-letter ISO country code where the `conn.client_ip` is likely to originate.

<ConfigExample
	config={{
		expressions: ["conn.geo.country_code != 'US'"],
	}}
/>

### `conn.geo.latitude`

The approximate latitude where the `conn.client_ip` is likely to originate.

<ConfigExample
	config={{
		expressions: ["double(conn.geo.latitude) >= 45.0"],
	}}
/>

### `conn.geo.longitude`

The approximate longitude where the `conn.client_ip` is likely to originate.

<ConfigExample
	config={{
		expressions: ["double(conn.geo.longitude) <= -93.0"],
	}}
/>

### `conn.geo.radius`

The radius in kilometers around the latitude and longitude where the `conn.client_ip` is likely to originate.

<ConfigExample
	config={{
		expressions: ["conn.geo.radius <= '5'"],
	}}
/>

### `conn.geo.subdivision`

The name of the subdivision, in EN, where the `conn.client_ip` is likely to originate.

<ConfigExample
	config={{
		expressions: ["conn.geo.subdivision == 'California'"],
	}}
/>

## Time variables

The following variables are available under the `time` namespace:

| Name                   | Type   | Description                             |
| ---------------------- | ------ | --------------------------------------- |
| [`time.now`](#timenow) | string | The current UTC time in RFC3339 format. |

### `time.now`

The current UTC time in RFC3339 format.

<ConfigExample
	config={{
		expressions: ["conn.ts.end < timestamp(time.now)"],
	}}
/>
